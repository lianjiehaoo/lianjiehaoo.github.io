<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å”å…ˆæ˜deåšå®¢</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-07-21T10:04:33.147Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>TXM</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç”±View.post()æ–¹æ³•å¼•å‘çš„æƒ³è±¡</title>
    <link href="http://yoursite.com/2018/07/21/%E7%94%B1View-post-%E6%96%B9%E6%B3%95%E5%BC%95%E5%8F%91%E7%9A%84%E6%83%B3%E8%B1%A1/"/>
    <id>http://yoursite.com/2018/07/21/ç”±View-post-æ–¹æ³•å¼•å‘çš„æƒ³è±¡/</id>
    <published>2018-07-21T09:57:19.000Z</published>
    <updated>2018-07-21T10:04:33.147Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚é¢˜ï¼Œç¬”è€…åœ¨æƒ³è¿™ä¸ªæ ‡é¢˜çš„æ—¶å€™æ€è€ƒäº†å¾ˆä¹…ï¼Œä¸çŸ¥é“åº”è¯¥å–ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ ‡é¢˜æ‰èƒ½æ¶µç›–å…¨æœ¬ç¯‡è¦æ¶‰åŠçš„å†…å®¹ã€‚ç»å°½è„‘å­ï¼Œæœ€ç»ˆç¡®å®šèµ·è¿™ä¸ªä¸ç—›ä¸ç—’çš„æ ‡é¢˜ã€‚åŸå› æ˜¯ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹‹å‰çš„ä¸€ç³»åˆ—ç›¸å…³ç–‘æƒ‘å°±æ˜¯ä»View.post()å¼€å§‹çš„ã€‚<a id="more"></a><br>æœ¬ç¯‡è¦æ¢ç©¶è¿™ä¹ˆå‡ ä¸ªé—®é¢˜ï¼š<br>1ã€éƒ½çŸ¥é“éé™æ€å†…éƒ¨ç±»å’ŒåŒ¿åç±»ä¼šå¼•å‘å†…å­˜æ³„éœ²ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹ŸçŸ¥é“å¦‚ä½•å–é¿å…è¿™ä¸ªé—®é¢˜çš„å‘ç”Ÿï¼Œä½†æ˜¯æ€æ ·åšå¾—æ›´åŠ å®Œç¾å‘¢ï¼Ÿ<br>2ã€View.Post()ä¸­çš„runæ–¹æ³•å’ŒHandler.post()æ–¹æ³•ä¸­çš„runæ–¹æ³•è¿è¡Œçº¿ç¨‹æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ<br>3ã€View.Post()ä¸­çš„runæ–¹æ³•åœ¨æ•´ä¸ªActivityçš„ç”Ÿå‘½å‘¨æœŸçš„é‡Œå¤„åœ¨å“ªä¸ªä½ç½®å‘¢ï¼Ÿ<br>å¥½ï¼Œä»¥ä¸Šä¸‰ä¸ªé—®é¢˜å°±æ˜¯æˆ‘è¦æ€»ç»“çš„é‡ç‚¹äº†ã€‚æ³¨æ„ï¼Œä¸‹é¢å¯¹postæ–¹æ³•å°†åšçš„æ€»ç»“ï¼Œå¯¹äºpostDelayåŒæ ·é€‚ç”¨ã€‚</p><h2 id="é—®é¢˜ä¸€çš„æƒ…å†µ"><a href="#é—®é¢˜ä¸€çš„æƒ…å†µ" class="headerlink" title="é—®é¢˜ä¸€çš„æƒ…å†µ"></a>é—®é¢˜ä¸€çš„æƒ…å†µ</h2><p>è¿™ä¸ªé—®é¢˜å‰é¢è¯´è¿‡æˆ‘ä»¬çŸ¥é“å¦‚ä½•å»é¿å…å®ƒçš„å‘ç”Ÿï¼Œé¿å…çš„æ–¹æ³•å¯å‚è€ƒ<a href="https://www.androiddesignpatterns.com/2013/01/inner-class-handler-memory-leak.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚ä½†æ˜¯ï¼Œå¯¹äºçœŸæ­£çš„ç”Ÿäº§ç¯å¢ƒï¼Œè¿™äº›è¿˜æ˜¯ä¸å¤Ÿçš„ã€‚æ‰€å¼•æ–‡ç« ä¸­æ‰€æè™½ç„¶é¿å…äº† Activity æ³„æ¼ï¼Œä¸è¿‡ Looper çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æ˜¯å¯èƒ½ä¼šæœ‰å¾…å¤„ç†çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ Activity çš„ Destroy æ—¶æˆ–è€… Stop æ—¶åº”è¯¥ç§»é™¤æ¶ˆæ¯é˜Ÿåˆ—MessageQueue ä¸­çš„æ¶ˆæ¯ã€‚ä¸‹é¢å‡ ä¸ªæ–¹æ³•éƒ½å¯ä»¥ç§»é™¤ Messageï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public final void removeCallbacks(Runnable r);</span><br><span class="line"></span><br><span class="line">public final void removeCallbacks(Runnable r, Object token);</span><br><span class="line"></span><br><span class="line">public final void removeCallbacksAndMessages(Object token);</span><br><span class="line"></span><br><span class="line">public final void removeMessages(int what);</span><br><span class="line"></span><br><span class="line">public final void removeMessages(int what, Object object);</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šè®¨è®ºçš„å†…å®¹è™½æœªæåŠView.post()ç³»åˆ—ï¼Œä½†æ˜¯å¯¹äºView.post()ç³»åˆ—åŒæ ·å­˜åœ¨å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼é¿å…ï¼Œä½†æ˜¯ä¹‹åæˆ‘ä»¬ä¾ç„¶è¦è®°ä½removeCallbacks()å™¢ã€‚</p><h2 id="é—®é¢˜äºŒçš„æƒ…å†µ"><a href="#é—®é¢˜äºŒçš„æƒ…å†µ" class="headerlink" title="é—®é¢˜äºŒçš„æƒ…å†µ"></a>é—®é¢˜äºŒçš„æƒ…å†µ</h2><p>è¯·å…è®¸æˆ‘ç›´æ¥ä»<a href="https://stackoverflow.com/questions/41728973/what-is-the-difference-between-view-postdelayed-and-handler-postdelayed-on-t" target="_blank" rel="noopener">Stack Overflow</a>ç²˜è¿‡æ¥å§(åˆ«æ‰“æˆ‘ğŸ˜œ)<br>According to the documentation of Handler.postDelayed(Runnable r, long delayMillis):</p><blockquote><p>Causes the Runnable r to be added to the message queue, to be run after the specified amount of time elapses. The runnable will be run on the thread to which this handler is attached.</p></blockquote><p>On the other hand View.postDelayed(Runnable action, long delayMillis):</p><blockquote><p>Causes the Runnable to be added to the message queue, to be run after the specified amount of time elapses. The runnable will be run on the user interface thread.</p></blockquote><h2 id="é—®é¢˜ä¸‰çš„æƒ…å†µ"><a href="#é—®é¢˜ä¸‰çš„æƒ…å†µ" class="headerlink" title="é—®é¢˜ä¸‰çš„æƒ…å†µ"></a>é—®é¢˜ä¸‰çš„æƒ…å†µ</h2><p>æ¢ç©¶è¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯ä¸ºäº†ä»¥ååœ¨post(new Runnable(){â€¦â€¦})çš„runæ–¹æ³•ä¸­å†™é€»è¾‘æ—¶ï¼Œå¯ä»¥æ¸…æ™°çš„çŸ¥é“å®ƒåœ¨Activityçš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰€å¤„çš„ä½ç½®ï¼ˆè¿™æ˜¯å¾ˆå¿…è¦çš„ï¼Œæ¯”å¦‚AnimationDrawableçš„start()æ–¹æ³•åªèƒ½åœ¨onStart()ä¸­æˆ–è€…ä¹‹åæ‰§è¡Œæ‰æœ‰æ•ˆï¼‰ã€‚ä¸ºäº†éªŒè¯ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šä»£ç å§ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">super.onCreate(savedInstanceState);</span><br><span class="line">setContentView(R.layout.activity_main);</span><br><span class="line">tvContent=findViewById(R.id.tvContent);</span><br><span class="line">tvContent.post(new Runnable() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void run() &#123;</span><br><span class="line">Log.d(TAG, &quot;run: &quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onStart() &#123;</span><br><span class="line">super.onStart();</span><br><span class="line">Log.d(TAG, &quot;onStart: &quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onStop() &#123;</span><br><span class="line">super.onStop();</span><br><span class="line">Log.d(TAG, &quot;onStop: &quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onPause() &#123;</span><br><span class="line">super.onPause();</span><br><span class="line">Log.d(TAG, &quot;onPause: &quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onResume() &#123;</span><br><span class="line">super.onResume();</span><br><span class="line">Log.d(TAG, &quot;onResume: &quot;);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected void onDestroy() &#123;</span><br><span class="line">super.onDestroy();</span><br><span class="line">Log.d(TAG, &quot;onDestroy: &quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»£ç å¾ˆç®€å•ï¼Œè¿™é‡Œä¸å¤šè§£é‡Šäº†ï¼Œç›´æ¥çœ‹è¿è¡Œç»“æœå§ï¼š<br><img src="/2018/07/21/ç”±View-post-æ–¹æ³•å¼•å‘çš„æƒ³è±¡/image01.png"><br>ç»“è®ºå¾ˆæ˜æ˜¾äº†ï¼Œæ­¤æ—¶çš„runæ–¹æ³•å¤„åœ¨onResumeæ–¹æ³•ä¹‹åã€‚</p><h2 id="é—®é¢˜å»¶ä¼¸"><a href="#é—®é¢˜å»¶ä¼¸" class="headerlink" title="é—®é¢˜å»¶ä¼¸"></a>é—®é¢˜å»¶ä¼¸</h2><p>æˆ‘çŸ¥é“é—®é¢˜å·²ç»å¾ˆæ‚äº†ï¼Œæ—¢ç„¶æ ‡é¢˜æ˜¯[**å¼•å‘çš„æƒ³è±¡]ï¼Œé‚£ä¹ˆè¯·å…è®¸æˆ‘å‘æŒ¥æƒ³è±¡å§ğŸ˜„ã€‚è¿™ä¸ªé—®é¢˜æ˜¯ï¼šå¯¹äºApplicationï¼ŒServiceï¼ŒActivityä¸‰è€…çš„Contextçš„åº”ç”¨åœºæ™¯æ˜¯æ€æ ·çš„å‘¢ï¼Ÿç›´æ¥ç›—ç”¨ä¸€å¼ å›¾å§ï¼š<br><img src="/2018/07/21/ç”±View-post-æ–¹æ³•å¼•å‘çš„æƒ³è±¡/image02.png"><br>å…¶ä¸­ï¼š NO1è¡¨ç¤º Application å’Œ Service å¯ä»¥å¯åŠ¨ä¸€ä¸ª Activityï¼Œä¸è¿‡éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ task ä»»åŠ¡é˜Ÿåˆ—ã€‚è€Œå¯¹äº Dialog è€Œè¨€ï¼Œåªæœ‰åœ¨ Activity ä¸­æ‰èƒ½åˆ›å»ºã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚é¢˜ï¼Œç¬”è€…åœ¨æƒ³è¿™ä¸ªæ ‡é¢˜çš„æ—¶å€™æ€è€ƒäº†å¾ˆä¹…ï¼Œä¸çŸ¥é“åº”è¯¥å–ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ ‡é¢˜æ‰èƒ½æ¶µç›–å…¨æœ¬ç¯‡è¦æ¶‰åŠçš„å†…å®¹ã€‚ç»å°½è„‘å­ï¼Œæœ€ç»ˆç¡®å®šèµ·è¿™ä¸ªä¸ç—›ä¸ç—’çš„æ ‡é¢˜ã€‚åŸå› æ˜¯ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹‹å‰çš„ä¸€ç³»åˆ—ç›¸å…³ç–‘æƒ‘å°±æ˜¯ä»View.post()å¼€å§‹çš„ã€‚
    
    </summary>
    
      <category term="Android å…¶å®ƒ" scheme="http://yoursite.com/categories/Android-%E5%85%B6%E5%AE%83/"/>
    
    
      <category term="å†…å­˜æ³„éœ²" scheme="http://yoursite.com/tags/%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>Androidæ¼”åŒ–å†å²</title>
    <link href="http://yoursite.com/2018/06/21/Android%E5%90%84%E7%89%88%E6%9C%AC%E4%BB%A3%E5%8F%B7%E3%80%81%E7%89%88%E6%9C%AC%E5%8F%B7%E3%80%81API%E7%BA%A7%E5%88%AB%E3%80%81%E5%8F%91%E5%B8%83%E6%97%B6%E9%97%B4%E5%AF%B9%E7%85%A7%E8%A1%A8/"/>
    <id>http://yoursite.com/2018/06/21/Androidå„ç‰ˆæœ¬ä»£å·ã€ç‰ˆæœ¬å·ã€APIçº§åˆ«ã€å‘å¸ƒæ—¶é—´å¯¹ç…§è¡¨/</id>
    <published>2018-06-21T15:06:09.000Z</published>
    <updated>2018-07-21T10:02:34.244Z</updated>
    
    <content type="html"><![CDATA[<p>Androidå¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ç±»ä¼¼äºè¿™ä¸ªç‰ˆæœ¬å·å¯¹åº”çš„APIçº§åˆ«æ˜¯å¤šå°‘ï¼Ÿè¿™ä¸ªAPIçº§åˆ«å¯¹åº”çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘ï¼Ÿè¿™æ ·çš„é—®é¢˜ã€‚æœ¬æ–‡å°±ä»¥æ­¤ä¸ºå‡ºå‘ç‚¹ï¼Œè¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹Androidçš„ç‰ˆæœ¬æ¼”åŒ–è¿›ç¨‹ã€‚ä¸€æ˜¯ä¸ºäº†ä¸‹æ¬¡å†é‡åˆ°å‰é¢è¯´çš„é—®é¢˜æ—¶èƒ½å¤Ÿå¿«é€ŸæŸ¥æ‰¾æœ¬æ–‡å¾—åˆ°ç­”æ¡ˆï¼ŒäºŒæ˜¯è®©è‡ªå·±å¯¹Androidå‘å±•å†ç¨‹æœ‰ä¸€ä¸ªæ¸…æ™°çš„æ€è·¯ã€‚<a id="more"></a></p><h2 id="å¯¹ç…§è¡¨"><a href="#å¯¹ç…§è¡¨" class="headerlink" title="å¯¹ç…§è¡¨"></a>å¯¹ç…§è¡¨</h2><table><thead><tr><th>ç‰ˆæœ¬å·</th><th>APIçº§åˆ«</th><th style="text-align:center">ä»£å·</th><th style="text-align:right">å‘å¸ƒæ—¶é—´</th></tr></thead><tbody><tr><td>Android 9.0</td><td>28</td><td style="text-align:center">P</td><td style="text-align:right">2018-3</td></tr><tr><td>Android 8.1</td><td>27</td><td style="text-align:center">Oreo</td><td style="text-align:right"></td></tr><tr><td>Android 8.0</td><td>26</td><td style="text-align:center">Oreo</td><td style="text-align:right">2017-3</td></tr><tr><td>Android 7.1.1</td><td>25</td><td style="text-align:center">Nougat</td><td style="text-align:right">2016-10</td></tr><tr><td>Android 7.0</td><td>24</td><td style="text-align:center">Nougat</td><td style="text-align:right">2016-08</td></tr><tr><td>Android 6.0</td><td>23</td><td style="text-align:center">Marshmallow</td><td style="text-align:right">2015-10</td></tr><tr><td>Android 5.1</td><td>22</td><td style="text-align:center">Lollipop</td><td style="text-align:right">2015-03</td></tr><tr><td>Android 5.0</td><td>21</td><td style="text-align:center">Lollipop</td><td style="text-align:right">2014-11</td></tr><tr><td>Android 4.4W</td><td>20</td><td style="text-align:center">KitKat</td><td style="text-align:right">2014-06</td></tr><tr><td>Android 4.4</td><td>19</td><td style="text-align:center">KitKat</td><td style="text-align:right">2013-10</td></tr><tr><td>Android 4.3</td><td>18</td><td style="text-align:center">Jelly Bean</td><td style="text-align:right">2013-07</td></tr><tr><td>Android 4.2</td><td>17</td><td style="text-align:center">Jelly Bean</td><td style="text-align:right">2012-11</td></tr><tr><td>Android 4.1</td><td>16</td><td style="text-align:center">Jelly Bean</td><td style="text-align:right">2012-07</td></tr><tr><td>Android 4.0.3</td><td>15</td><td style="text-align:center">Ice Cream Sandwich</td><td style="text-align:right">2011-12</td></tr><tr><td>Android 4.0</td><td>14</td><td style="text-align:center">Ice Cream Sandwich</td><td style="text-align:right">2011-10</td></tr><tr><td>Android 3.2</td><td>13</td><td style="text-align:center">Honeycomb</td><td style="text-align:right">2011-07</td></tr><tr><td>Android 3.1</td><td>12</td><td style="text-align:center">Honeycomb</td><td style="text-align:right">2011-05</td></tr><tr><td>Android 3.0</td><td>11</td><td style="text-align:center">Honeycomb</td><td style="text-align:right">2011-02</td></tr><tr><td>Android 2.3.3</td><td>10</td><td style="text-align:center">Gingerbread</td><td style="text-align:right">2011-02</td></tr><tr><td>Android 2.3</td><td>9</td><td style="text-align:center">Gingerbread</td><td style="text-align:right">2010-12</td></tr><tr><td>Android 2.2</td><td>8</td><td style="text-align:center">Froyo</td><td style="text-align:right">2010-05</td></tr><tr><td>Android 2.1</td><td>7</td><td style="text-align:center">Eclair</td><td style="text-align:right">2010-01</td></tr><tr><td>Android 2.0.1</td><td>6</td><td style="text-align:center">Eclair</td><td style="text-align:right">2009-12</td></tr><tr><td>Android 2.0</td><td>5</td><td style="text-align:center">Eclair</td><td style="text-align:right">2009-10</td></tr><tr><td>Android 1.6</td><td>4</td><td style="text-align:center">Donut</td><td style="text-align:right">2009-09</td></tr><tr><td>Android 1.5</td><td>3</td><td style="text-align:center">Cupcake</td><td style="text-align:right">2009-04</td></tr><tr><td>Android 1.1</td><td>2</td><td style="text-align:center"></td><td style="text-align:right">2009-02</td></tr><tr><td>Android 1.0</td><td>1</td><td style="text-align:center"></td><td style="text-align:right">2008-09</td></tr></tbody></table><h2 id="Androidé‡è¦å†å²ç‰ˆæœ¬åŠŸèƒ½"><a href="#Androidé‡è¦å†å²ç‰ˆæœ¬åŠŸèƒ½" class="headerlink" title="Androidé‡è¦å†å²ç‰ˆæœ¬åŠŸèƒ½"></a>Androidé‡è¦å†å²ç‰ˆæœ¬åŠŸèƒ½</h2><h4 id="Android-7-0"><a href="#Android-7-0" class="headerlink" title="Android 7.0"></a>Android 7.0</h4><ul><li>å¤šè¯­è¨€åŒºåŸŸæ”¯æŒï¼Œæ›´å¤šè¯­è¨€</li><li>å¤šçª—å£æ”¯æŒ</li><li>æ–°å¢çš„è¡¨æƒ…ç¬¦å·<br><a href="https://developer.android.com/about/versions/nougat/android-7.0" target="_blank" rel="noopener">see more>></a></li></ul><h4 id="Android-6-0"><a href="#Android-6-0" class="headerlink" title="Android 6.0"></a>Android 6.0</h4><ul><li>è¿è¡Œæ—¶æƒé™åŠå…¶ç®¡ç†</li><li>ä½ç”µè€—æ¨¡å¼å’Œåº”ç”¨å¾…æœºæ¨¡å¼</li><li>æ–‡æœ¬é€‰æ‹©</li><li>WLAN å’Œç½‘ç»œè¿æ¥å˜æ›´</li><li>æŒ‡çº¹èº«ä»½éªŒè¯</li><li>ä¸»é¢˜åŒ– ColorStateList<br><a href="https://developer.android.com/about/versions/marshmallow/" target="_blank" rel="noopener">see more>></a></li></ul><h4 id="Android-5-0"><a href="#Android-5-0" class="headerlink" title="Android 5.0"></a>Android 5.0</h4><ul><li>Material Design</li><li>å…¨æ–°çš„é€šçŸ¥ä¸­å¿ƒè®¾è®¡</li><li>æ”¯æŒ64ä½ARTè™šæ‹Ÿæœº<br><a href="https://developer.android.com/about/versions/lollipop" target="_blank" rel="noopener">see more>></a></li></ul><h4 id="Android-4-4"><a href="#Android-4-4" class="headerlink" title="Android 4.4"></a>Android 4.4</h4><ul><li>å…¨å±æ²‰æµ¸æ¨¡å¼</li><li>é€æ˜ç³»ç»Ÿ UI æ ·å¼</li><li>ç”¨äºåŠ¨ç”»åœºæ™¯çš„è½¬åœºæ¡†æ¶</li><li>å±å¹•å½•åˆ¶</li><li>æ­¥æµ‹å™¨å’Œè®¡æ­¥å™¨<br><a href="https://developer.android.com/about/versions/kitkat" target="_blank" rel="noopener">see more>></a></li></ul><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://developer.android.com/guide/topics/manifest/uses-sdk-element#ApiLevels" target="_blank" rel="noopener">Androidå¹³å°ç‰ˆæœ¬å¯¹æ¯”</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Androidå¼€å‘è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ç±»ä¼¼äºè¿™ä¸ªç‰ˆæœ¬å·å¯¹åº”çš„APIçº§åˆ«æ˜¯å¤šå°‘ï¼Ÿè¿™ä¸ªAPIçº§åˆ«å¯¹åº”çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘ï¼Ÿè¿™æ ·çš„é—®é¢˜ã€‚æœ¬æ–‡å°±ä»¥æ­¤ä¸ºå‡ºå‘ç‚¹ï¼Œè¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹Androidçš„ç‰ˆæœ¬æ¼”åŒ–è¿›ç¨‹ã€‚ä¸€æ˜¯ä¸ºäº†ä¸‹æ¬¡å†é‡åˆ°å‰é¢è¯´çš„é—®é¢˜æ—¶èƒ½å¤Ÿå¿«é€ŸæŸ¥æ‰¾æœ¬æ–‡å¾—åˆ°ç­”æ¡ˆï¼ŒäºŒæ˜¯è®©è‡ªå·±å¯¹Androidå‘å±•å†ç¨‹æœ‰ä¸€ä¸ªæ¸…æ™°çš„æ€è·¯ã€‚
    
    </summary>
    
      <category term="Android å…¶å®ƒ" scheme="http://yoursite.com/categories/Android-%E5%85%B6%E5%AE%83/"/>
    
    
      <category term="Androidæ¼”åŒ–å†å²" scheme="http://yoursite.com/tags/Android%E6%BC%94%E5%8C%96%E5%8E%86%E5%8F%B2/"/>
    
  </entry>
  
  <entry>
    <title>RecycleViewæ¢ç©¶ï¼ˆä¸€ï¼‰ï¼šæ·»åŠ å¤´å°¾å¸ƒå±€</title>
    <link href="http://yoursite.com/2018/05/20/RecycleView%E6%8E%A2%E7%A9%B6%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%A4%B4%E5%B0%BE%E5%B8%83%E5%B1%80/"/>
    <id>http://yoursite.com/2018/05/20/RecycleViewæ¢ç©¶ï¼ˆä¸€ï¼‰ï¼šæ·»åŠ å¤´å°¾å¸ƒå±€/</id>
    <published>2018-05-20T13:27:13.000Z</published>
    <updated>2018-05-20T14:21:23.773Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬”è€…ä½¿ç”¨RecycleViewä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæ¯æ¬¡é‡åˆ°éœ€è¦ä¸ºRecycleViewæ·»åŠ å¤´å°¾å¸ƒå±€çš„æ—¶å€™ï¼Œéƒ½ä¼šæ˜¯ä¸€é˜µå¤´ç–¼ã€‚ä¹‹å‰æˆ‘çš„åšæ³•æ˜¯ç›´æ¥ç»™ä¾èµ–çš„å®ä½“é›†åˆæ·»åŠ å¤´å°¾ç±»å‹çš„Item Dataã€‚æ‰“è„¸çš„è¯´ï¼Œè¿™æ˜¯åœ¨èµ¶éœ€æ±‚çš„ä¸€ç§æ— èµ–åšæ³•ã€‚å¾—ç›Šäºæœ€è¿‘é¡¹ç›®ä¸æ˜¯å¾ˆç´§å¼ ï¼Œæ‰€ä»¥æŠ½ä¸ªå‘¨æœ«çš„æ—¶é—´å¥½å¥½ç ”ç©¶ä¸€ä¸‹è¿™ä¸€å—çš„çŸ¥è¯†ã€‚<a id="more"></a><br>è¨€å½’æ­£ä¼ ï¼Œæœ¬ç¯‡æ–‡ç« æˆ‘è¦å®ç°çš„æ•ˆæœæ˜¯<span style="border-bottom:1px dashed black;">ç®€æ´é«˜æ•ˆåœ°ä¸ºRecycleViewæ— é™å¢åŠ å¤´å°¾å¸ƒå±€ã€‚<span></span></span></p><h3 id="å…·ä½“æ€è·¯å¦‚ä¸‹"><a href="#å…·ä½“æ€è·¯å¦‚ä¸‹" class="headerlink" title="å…·ä½“æ€è·¯å¦‚ä¸‹"></a>å…·ä½“æ€è·¯å¦‚ä¸‹</h3><p>1ã€æ–°å»ºä¸€ä¸ª<code>HeaderFooterWrapAdapter</code>è£…é¥°ç±»ï¼Œå®ƒç»§æ‰¿äºRecycleView.Adapterï¼Œè´Ÿè´£æ‹“å±•æ™®é€šRecycleView.Adapterå¯¹è±¡ï¼ˆè¢«è£…é¥°å¯¹è±¡ï¼‰çš„åŠŸèƒ½ã€‚<br>2ã€åœ¨<code>onCreateViewHolder</code>ã€<code>onBindViewHolder</code>ã€<code>getItemViewType</code>ã€<code>getItemCount</code>è¿™å‡ ä¸ªæ–¹æ³•åŒºåˆ†æœ‰æ— å¤´å°¾å¸ƒå±€ã€‚å¦‚æœæ²¡æœ‰å¤´å°¾å¸ƒå±€ï¼Œä¸€å¾‹æŒ‰ç…§è¢«è£…é¥°å¯¹è±¡çš„é€»è¾‘å¤„ç†ã€‚<br>3ã€åœ¨<code>onAttachedToRecyclerView</code>æ–¹æ³•å†…ï¼Œåšå¥½GridViewçš„é€‚é…ã€‚</p><h3 id="ä¸‹é¢æˆ‘ä»¬å°±æŠŠä»¥ä¸Šçš„æ€è·¯è½¬åŒ–æˆå¯çˆ±çš„ä»£ç å§ã€‚"><a href="#ä¸‹é¢æˆ‘ä»¬å°±æŠŠä»¥ä¸Šçš„æ€è·¯è½¬åŒ–æˆå¯çˆ±çš„ä»£ç å§ã€‚" class="headerlink" title="ä¸‹é¢æˆ‘ä»¬å°±æŠŠä»¥ä¸Šçš„æ€è·¯è½¬åŒ–æˆå¯çˆ±çš„ä»£ç å§ã€‚"></a>ä¸‹é¢æˆ‘ä»¬å°±æŠŠä»¥ä¸Šçš„æ€è·¯è½¬åŒ–æˆå¯çˆ±çš„ä»£ç å§ã€‚</h3><p><strong>ä¸€ã€æˆ‘ä»¬åº”è¯¥è®©HeaderFooterWrapAdapterç»§æ‰¿è‡ªRecycleView.Adapter,å¹¶ä¸”å®šä¹‰å¥½éœ€è¦çš„æˆå‘˜å¯¹è±¡ã€‚</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class HeaderFooterWrapAdapter extends RecyclerView.Adapter &#123;</span><br><span class="line">RecyclerView.Adapter adapter;//è¢«è£…é¥°å¯¹è±¡</span><br><span class="line">private List&lt;View&gt; headerViews = new ArrayList&lt;&gt;();</span><br><span class="line">private List&lt;View&gt; footerViews = new ArrayList&lt;&gt;();</span><br><span class="line">â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong> äºŒã€é‡å†™RecyclerView.Adapterä¸­å‡ ä¸ªé‡è¦çš„æ–¹æ³•ã€‚ </strong><br>1ã€åˆ¤æ–­itemä¸ªæ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public int getItemCount() &#123;</span><br><span class="line">if (headerViews.size() != 0 &amp;&amp; footerViews.size() != 0)//åŒæ—¶åŠ äº†å¤´éƒ¨å’Œå°¾éƒ¨</span><br><span class="line">&#123;</span><br><span class="line">return adapter.getItemCount() + headerViews.size() + footerViews.size();</span><br><span class="line">&#125; else if (headerViews.size() != 0) &#123; //åªæœ‰å¤´éƒ¨</span><br><span class="line">return adapter.getItemCount() + headerViews.size();</span><br><span class="line">&#125; else if (footerViews.size() != 0) //åªæœ‰å°¾éƒ¨</span><br><span class="line">&#123;</span><br><span class="line">return adapter.getItemCount() + footerViews.size();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return adapter.getItemCount();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>2ã€åŒºåˆ†Itemç±»å‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public int getItemViewType(int position) &#123;</span><br><span class="line">if (headerViews.size() != 0) &#123;</span><br><span class="line">if (position &gt;= 0 &amp;&amp; position &lt; headerViews.size()) &#123;</span><br><span class="line">return headerViews.get(position).hashCode();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (footerViews.size() != 0) &#123;</span><br><span class="line">int i = position - headerViews.size() - adapter.getItemCount();</span><br><span class="line">if (i &gt;= 0)</span><br><span class="line">return footerViews.get(i).hashCode();</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3ã€åˆ›å»ºItemã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public RecyclerView.ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) &#123;</span><br><span class="line">for (View headerView : headerViews) &#123;</span><br><span class="line">if (headerView.hashCode() == viewType) &#123;</span><br><span class="line">return new HeaderViewHolder(headerView);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">for (View footerview : footerViews) &#123;</span><br><span class="line">if (footerview.hashCode() == viewType) &#123;</span><br><span class="line">return new FooterViewHolder(footerview);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return adapter.onCreateViewHolder(parent, viewType);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€ç»‘å®šæ•°æ®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onBindViewHolder(@NonNull RecyclerView.ViewHolder holder, int position) &#123;</span><br><span class="line">if (headerViews.size() != 0 &amp;&amp; footerViews.size() != 0)//åŒæ—¶åŠ äº†å¤´éƒ¨å’Œå°¾éƒ¨</span><br><span class="line">&#123;</span><br><span class="line">if (position &gt;= headerViews.size() &amp;&amp; position &lt; headerViews.size() + adapter.getItemCount()) &#123;</span><br><span class="line">adapter.onBindViewHolder(holder, position - headerViews.size());</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (headerViews.size() != 0) &#123; //åªæœ‰å¤´éƒ¨</span><br><span class="line">if (position &gt;= headerViews.size()) &#123;</span><br><span class="line">adapter.onBindViewHolder(holder, position - headerViews.size());</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (footerViews.size() != 0) //åªæœ‰å°¾éƒ¨</span><br><span class="line">&#123;</span><br><span class="line">if (position &gt;= 0 &amp;&amp; position &lt; adapter.getItemCount()) &#123;</span><br><span class="line">adapter.onBindViewHolder(holder, position);</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">adapter.onBindViewHolder(holder, position);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong> ä¸‰ã€æ¥ä¸‹æ¥é€‚é…GridViewï¼Œè¿™é‡Œä¸»è¦æ˜¯é€šè¿‡GridLayoutManagerçš„<code>setSpanSizeLookup</code>æ–¹æ³•åŠ¨æ€å¤„ç†å¤´å°¾å¸ƒå±€ã€‚ </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onAttachedToRecyclerView(@NonNull RecyclerView recyclerView) &#123;</span><br><span class="line">super.onAttachedToRecyclerView(recyclerView);</span><br><span class="line">final RecyclerView.LayoutManager layoutManager = recyclerView.getLayoutManager();</span><br><span class="line">if (layoutManager instanceof GridLayoutManager) &#123;</span><br><span class="line">((GridLayoutManager) layoutManager).setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() &#123;</span><br><span class="line">@Override</span><br><span class="line">public int getSpanSize(int position) &#123;</span><br><span class="line">if (headerViews.size() != 0 &amp;&amp; footerViews.size() != 0) &#123;</span><br><span class="line">if (position &gt;= 0 &amp;&amp; position &lt; headerViews.size()) &#123;</span><br><span class="line">return ((GridLayoutManager) layoutManager).getSpanCount();</span><br><span class="line">&#125; else if (position &gt;= getItemCount() - footerViews.size() &amp;&amp; position &lt; getItemCount()) &#123;</span><br><span class="line">return ((GridLayoutManager) layoutManager).getSpanCount();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br><span class="line">&#125; else if (headerViews.size() != 0) &#123;</span><br><span class="line">if (position &gt;= 0 &amp;&amp; position &lt; headerViews.size()) &#123;</span><br><span class="line">return ((GridLayoutManager) layoutManager).getSpanCount();</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br><span class="line">&#125; else if (footerViews.size() != 0) &#123;</span><br><span class="line">if (position &gt;= getItemCount() - footerViews.size() &amp;&amp; position &lt; getItemCount()) &#123;</span><br><span class="line">return ((GridLayoutManager) layoutManager).getSpanCount();</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br><span class="line">return 1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong> å››ã€å®šä¹‰æ·»åŠ å¤´éƒ¨å’Œå°¾éƒ¨å¸ƒå±€çš„å…¬å¼€æ–¹æ³•ã€‚ </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//æ·»åŠ å¤´å¸ƒå±€</span><br><span class="line">public void addHeaderView(View headerView) &#123;</span><br><span class="line">this.headerViews.add(headerView);</span><br><span class="line">notifyItemInserted(headerViews.size() - 1);</span><br><span class="line">&#125;</span><br><span class="line">//æ·»åŠ å°¾å¸ƒå±€</span><br><span class="line">public void addFooterView(View footerView) &#123;</span><br><span class="line">this.footerViews.add(footerView);</span><br><span class="line">notifyItemInserted(headerViews.size() + adapter.getItemCount() + footerViews.size() - 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¥½äº†ï¼Œä»¥ä¸Šå°±æ˜¯ä¸ºRecycleViewæ·»åŠ å¤´å°¾å¸ƒå±€çš„æ ¸å¿ƒä»£ç ã€‚è°ƒç”¨æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œä¼ªä»£ç å¦‚ä¸‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MyAdapter myAdapter=....;</span><br><span class="line">....</span><br><span class="line">HeaderFooterWrapAdapter headerFooterWrapAdapter=new HeaderFooterWrapAdapter(myAdapter);</span><br><span class="line">headerFooterWrapAdapter.addFooterView(footerView01);</span><br><span class="line">headerFooterWrapAdapter.addFooterView(footerView02);</span><br><span class="line">headerFooterWrapAdapter.addFooterView(footerView03);</span><br><span class="line">headerFooterWrapAdapter.addHeaderView(headerView01);</span><br><span class="line">headerFooterWrapAdapter.addHeaderView(headerView02);</span><br><span class="line">headerFooterWrapAdapter.addHeaderView(headerView03);</span><br><span class="line">.......</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„å°±æ˜¯Inflateåˆ›å»ºheaderViewæˆ–è€…footerViewæ—¶ï¼Œparentéœ€è¦ä¼ å…¥recyclerViewå¯¹è±¡æ‰èƒ½æ—¶å¸ƒå±€çš„é¡¶å±‚å±æ€§èµ·æ•ˆæœ,ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">View footerView = LayoutInflater.from(this).inflate(R.layout.footerview, rcv, false);</span><br></pre></td></tr></table></figure></p><p>å…³äºinflateçš„ä½¿ç”¨æŠ€å·§ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹<a href="https://www.zhihu.com/question/42782662" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚æœ€åï¼Œå†è´´ä¸€å¼ å®ç°çš„æ•ˆæœå›¾ç‰‡å§ï½<br><img src="/2018/05/20/RecycleViewæ¢ç©¶ï¼ˆä¸€ï¼‰ï¼šæ·»åŠ å¤´å°¾å¸ƒå±€/ezgif-4-059e8e8823.gif"></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://juejin.im/entry/5975a4ac5188256e2c58e1f4" target="_blank" rel="noopener">å­¦ä¼šè‡ªå·±ç»™RecyclerViewæ·»åŠ Headerã€Footerå’ŒåŠ è½½æ›´å¤šå›è°ƒ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬”è€…ä½¿ç”¨RecycleViewä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæ¯æ¬¡é‡åˆ°éœ€è¦ä¸ºRecycleViewæ·»åŠ å¤´å°¾å¸ƒå±€çš„æ—¶å€™ï¼Œéƒ½ä¼šæ˜¯ä¸€é˜µå¤´ç–¼ã€‚ä¹‹å‰æˆ‘çš„åšæ³•æ˜¯ç›´æ¥ç»™ä¾èµ–çš„å®ä½“é›†åˆæ·»åŠ å¤´å°¾ç±»å‹çš„Item Dataã€‚æ‰“è„¸çš„è¯´ï¼Œè¿™æ˜¯åœ¨èµ¶éœ€æ±‚çš„ä¸€ç§æ— èµ–åšæ³•ã€‚å¾—ç›Šäºæœ€è¿‘é¡¹ç›®ä¸æ˜¯å¾ˆç´§å¼ ï¼Œæ‰€ä»¥æŠ½ä¸ªå‘¨æœ«çš„æ—¶é—´å¥½å¥½ç ”ç©¶ä¸€ä¸‹è¿™ä¸€å—çš„çŸ¥è¯†ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="RecycleView" scheme="http://yoursite.com/tags/RecycleView/"/>
    
  </entry>
  
  <entry>
    <title>PopupWindowä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://yoursite.com/2018/04/29/PopupWindow%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2018/04/29/PopupWindowä½¿ç”¨æ•™ç¨‹/</id>
    <published>2018-04-29T01:43:34.000Z</published>
    <updated>2018-04-29T04:07:09.612Z</updated>
    
    <content type="html"><![CDATA[<p>PopupWindowæ˜¯<code>android.widget</code>ä¸­ä¸€ä¸ªå¼¹æ¡†æ§ä»¶ï¼Œä¸æ™®é€šdialogç›¸æ¯”ï¼Œå®ƒçš„ä¼˜åŠ¿åœ¨äºå¯ä»¥ä»»æ„æ”¹å˜å…¶åœ¨ç•Œé¢ä¸­çš„ä½ç½®ã€‚æœ¬ç¯‡æˆ‘ä»¬å°±æ¥å¥½å¥½ç ”ç©¶ä¸€ä¸‹å®ƒçš„ç”¨æ³•å§ã€‚<br><a id="more"></a></p><h2 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h2><p>PopupWindowæœ‰ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼š<br>1ã€é€šè¿‡è§†å›¾åˆ›å»ºï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PopupWindow ()// åˆ›å»ºä¸€ä¸ªç©ºçš„PopupWindow</span><br><span class="line"></span><br><span class="line">PopupWindow (View contentView)</span><br><span class="line"></span><br><span class="line">PopupWindow (int width, int height)</span><br><span class="line"></span><br><span class="line">PopupWindow (View contentView, // PopupWindowçš„å†…å®¹View, ç›¸å½“äºsetContentView</span><br><span class="line">int width, // å®½, ç›¸å½“äºsetwidth()</span><br><span class="line">int height,// é«˜, ç›¸å½“äºsetHeight</span><br><span class="line">boolean focusable)//æ˜¯å¦å¯è·å–ç„¦ç‚¹, ç›¸å½“äºsetFocusable()</span><br></pre></td></tr></table></figure></p><p>2ã€é€šè¿‡ä¸Šä¸‹æ–‡åˆ›å»ºï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PopupWindow (Context context)</span><br><span class="line"></span><br><span class="line">PopupWindow (Context context, </span><br><span class="line">AttributeSet attrs)</span><br><span class="line"></span><br><span class="line">PopupWindow (Context context, </span><br><span class="line">AttributeSet attrs, </span><br><span class="line">int defStyleAttr)</span><br><span class="line"></span><br><span class="line">PopupWindow (Context context, </span><br><span class="line">AttributeSet attrs, </span><br><span class="line">int defStyleAttr, </span><br><span class="line">int defStyleRes)</span><br></pre></td></tr></table></figure></p><p>åˆ›å»ºPopuWindowå¿…è¦çš„ä¸‰ä¸ªæ¡ä»¶:<br>void setHeight (int height) // å› ä¸ºPopupWindowæ²¡æœ‰é»˜è®¤å¸ƒå±€æ‰€ä»¥å¿…é¡»æŒ‡å®šå®½é«˜<br>void setWidth (int width)<br>void setContentView (View contentView) // éœ€è¦æ˜¾ç¤ºçš„å†…å®¹</p><blockquote><p><strong>æ³¨æ„</strong><br>PopupWindowæŒ‡å®šå®½é«˜æ—¶ç”¨LayoutParams.WRAP_CONTENTåŒ…è£¹å¸ƒå±€ï¼Œ è¿™æ—¶å¹¶ä¸æ€»æ˜¯å¸ƒå±€å¤šå¤§å°±æ˜¾ç¤ºå¤šå¤§ï¼Œä¼°è®¡æ˜¯BUGå§ã€‚æ‰€ä»¥é‡åˆ°è¿™ç§æƒ…å†µï¼Œå…·ä½“çš„PopupWindowå¤§å°æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æ‰‹åŠ¨è®¡ç®—ã€‚</p></blockquote><h2 id="æ˜¾ç¤º"><a href="#æ˜¾ç¤º" class="headerlink" title="æ˜¾ç¤º"></a>æ˜¾ç¤º</h2><p>æ˜¾ç¤ºPopupWindowå¯ä»¥åˆ†ä¸ºä¸¤ç§æ–¹å¼:</p><h4 id="1ã€é™„ç€æŸä¸ªæ§ä»¶showAsDropDownã€‚"><a href="#1ã€é™„ç€æŸä¸ªæ§ä»¶showAsDropDownã€‚" class="headerlink" title="1ã€é™„ç€æŸä¸ªæ§ä»¶showAsDropDownã€‚"></a>1ã€é™„ç€æŸä¸ªæ§ä»¶showAsDropDownã€‚</h4><p>é»˜è®¤æ˜¯PopupWindowçš„å·¦ä¸Šè§’å¯¹å…¶æ§ä»¶çš„å·¦ä¸‹è§’,æˆ–è€…è®¾ç½®<code>Gravity.RIGHT</code>, PopupWindowçš„å³ä¸Šè§’å¯¹é½æ§ä»¶çš„å³ä¸‹è§’ã€‚ä¸å­˜åœ¨Gravity.TOPæˆ–Gravity.BOTTOMæ•ˆæœã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void showAsDropDown (View anchor) //å¼¹çª—æ˜¾ç¤ºåœ¨anchoræ§ä»¶å·¦ä¸‹æ–¹</span><br><span class="line"></span><br><span class="line">void showAsDropDown (View anchor, int xoff, int yoff)//ä»¥æ§ä»¶å·¦ä¸‹è§’ä¸ºåŸç‚¹çš„åç§»åæ ‡</span><br><span class="line"></span><br><span class="line">void showAsDropDown (View anchor,int xoff,int yoff,int gravity) //å¼¹çª—æ˜¾ç¤ºåœ¨æ§ä»¶çš„å·¦ä¸‹æ–¹è¿˜æ˜¯å³ä¸‹æ–¹, å‚æ•°Gravity.RIGHT/Gravity.LEFT. é»˜è®¤æ˜¯å·¦ä¸‹æ–¹</span><br></pre></td></tr></table></figure></p><h4 id="2ã€è®¾ç½®å±å¹•åæ ‡showAtLocationã€‚"><a href="#2ã€è®¾ç½®å±å¹•åæ ‡showAtLocationã€‚" class="headerlink" title="2ã€è®¾ç½®å±å¹•åæ ‡showAtLocationã€‚"></a>2ã€è®¾ç½®å±å¹•åæ ‡showAtLocationã€‚</h4><p>å½“å‰çª—å£çš„ä»»æ„ä½ç½®(setClippingEnabledè®¾ç½®ä¸ºtureæ—¶ï¼Œä¸åŒ…æ‹¬çŠ¶æ€æ ã€‚)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void showAtLocation (</span><br><span class="line">View parent, //åªè¦æ˜¯å±å¹•ä¸Šä»»æ„æ§ä»¶å¯¹è±¡å³å¯</span><br><span class="line">int gravity, //å±å¹•ä½ç½®</span><br><span class="line">int x,       //åç§»åæ ‡</span><br><span class="line">int y)</span><br></pre></td></tr></table></figure></p><p>parent:è¯¥å±æ€§åªè¦æ˜¯å½“å‰ä»»æ„æ§ä»¶å¯¹è±¡å³å¯(Viewå’ŒViewGroupéƒ½è¡Œ), å®˜æ–¹æ–‡æ¡£ä»‹ç»è¯¥å¯¹è±¡å‚æ•°ä¸»è¦æ˜¯ä¸ºäº†å¾—åˆ°è¯¥å¯¹è±¡çš„<code>getWindowToken()</code>æ–¹æ³•ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯å¤šæ¬¡è°ƒç”¨showæ–¹æ³•åªä¼šæ‰§è¡Œç¬¬ä¸€å¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mPopupWindow.showAtLocation(popupwindow, Gravity.TOP, 100, 0); // åªæœ‰è¯¥è¡Œç”Ÿæ•ˆ</span><br><span class="line">mPopupWindow.showAtLocation(popupwindow, Gravity.LEFT, 100, 0);</span><br><span class="line">mPopupWindow.showAtLocation(popupwindow, Gravity.RIGHT, 100, 0);</span><br><span class="line">mPopupWindow.showAtLocation(popupwindow, Gravity.BOTTOM, 100, 0);</span><br></pre></td></tr></table></figure></p><h4 id="éšè—PopupWindow"><a href="#éšè—PopupWindow" class="headerlink" title="éšè—PopupWindow"></a>éšè—PopupWindow</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void dismiss ()</span><br></pre></td></tr></table></figure><h2 id="çŠ¶æ€"><a href="#çŠ¶æ€" class="headerlink" title="çŠ¶æ€"></a>çŠ¶æ€</h2><h4 id="å¤–éƒ¨è¢«ç‚¹å‡»å–æ¶ˆ"><a href="#å¤–éƒ¨è¢«ç‚¹å‡»å–æ¶ˆ" class="headerlink" title="å¤–éƒ¨è¢«ç‚¹å‡»å–æ¶ˆ"></a>å¤–éƒ¨è¢«ç‚¹å‡»å–æ¶ˆ</h4><p>å¦‚æœä¸ºtrueç‚¹å‡»PopupWindowå¤–éƒ¨åŒºåŸŸå¯ä»¥å–æ¶ˆPopupWindow<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setOutsideTouchable (boolean touchable) // è®¾ç½®å¤–éƒ¨æ˜¯å¦å¯è¢«ç‚¹å‡»</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯åœ¨android6.0ä»¥ä¸‹è¿˜æ˜¯æ— æ³•ç‚¹å‡»å¤–éƒ¨å–æ¶ˆPopupwindow. å¯ä»¥é€šè¿‡è®¾ç½®èƒŒæ™¯æ¥è§£å†³è¿™ä¸ªBugã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mPopupWindow.setBackgroundDrawable(new BitmapDrawable());</span><br></pre></td></tr></table></figure></p><h4 id="è§£å†³NavigationBaré‡å "><a href="#è§£å†³NavigationBaré‡å " class="headerlink" title="è§£å†³NavigationBaré‡å "></a>è§£å†³NavigationBaré‡å </h4><p>è¿™æ˜¯Android5.0(API22)åæ·»åŠ çš„æ–¹æ³•, é»˜è®¤ä¸ºtrueï¼Œä¸ºtrueæ—¶å°†ä¸ä¼šä¸å¯¼èˆªæ é‡å ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setAttachedInDecor (boolean enabled)</span><br></pre></td></tr></table></figure></p><h4 id="å¯è·å–ç„¦ç‚¹"><a href="#å¯è·å–ç„¦ç‚¹" class="headerlink" title="å¯è·å–ç„¦ç‚¹"></a>å¯è·å–ç„¦ç‚¹</h4><p>ä¸€èˆ¬æ§ä»¶éƒ½ä¸éœ€è¦ç„¦ç‚¹ï¼Œä½†æ˜¯è¾“å…¥æ¡†EditTextéœ€è¦å…ˆè·å–ç„¦ç‚¹æ‰èƒ½è¾“å…¥ã€‚ æœ€é‡è¦çš„æ˜¯å½“PopupWindowå¯è·å–ç„¦ç‚¹æ—¶æŒ‰ä¸‹æ‰‹æœºè¿”å›é”®å°†ä¸ä¼šé”€æ¯å½“å‰Activityè€Œæ˜¯å…³é—­å½“å‰PopupWindowã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è¿˜æ˜¯è®¾ç½®ä¸ºtrueï¼Œ æ›´åŠ ç¬¦åˆç”¨æˆ·æ“ä½œé€»è¾‘ã€‚è¯¥æ–¹æ³•ä¸ºtrueæ—¶åŒæ—¶æ‹¥æœ‰setOutsideTouchable(true)çš„ä½œç”¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setFocusable (boolean focusable)</span><br></pre></td></tr></table></figure></p><h4 id="é®ç›–é™„ç€View"><a href="#é®ç›–é™„ç€View" class="headerlink" title="é®ç›–é™„ç€View"></a>é®ç›–é™„ç€View</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setOverlapAnchor (boolean overlapAnchor)</span><br></pre></td></tr></table></figure><p>PopupWindowå¯¹é½æ–¹å¼ä»View anchorçš„å·¦ä¸‹è§’å˜æˆäº†å·¦ä¸Šè§’äº†ã€‚</p><h4 id="çª—å£è£å‰ª"><a href="#çª—å£è£å‰ª" class="headerlink" title="çª—å£è£å‰ª"></a>çª—å£è£å‰ª</h4><p>PopupWindowé»˜è®¤æ˜¯ä¸ä¼šè¶…å‡ºå±å¹•è¾¹ç•Œçš„. ä½†æ˜¯å¦‚æœè¯¥æ–¹æ³•ä¸ºfalseæ—¶ä¼šé‡‡ç”¨ç²¾å‡†ä½ç½®, èƒ½è¶…å‡ºå±å¹•èŒƒå›´.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setClippingEnabled (boolean enabled)</span><br></pre></td></tr></table></figure></p><h2 id="åŠ¨ç”»æ•ˆæœ"><a href="#åŠ¨ç”»æ•ˆæœ" class="headerlink" title="åŠ¨ç”»æ•ˆæœ"></a>åŠ¨ç”»æ•ˆæœ</h2><h4 id="è®¾ç½®åŠ¨ç”»"><a href="#è®¾ç½®åŠ¨ç”»" class="headerlink" title="è®¾ç½®åŠ¨ç”»"></a>è®¾ç½®åŠ¨ç”»</h4><p>å¯ä»¥è®¾ç½®popupWindowçš„æ˜¾ç¤ºå’Œéšè—åŠ¨ç”»ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setAnimationStyle (int animationStyle)</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æ–¹æ³•æ˜¯ä¼ å…¥ä¸€ä¸ªStyleçš„æ ·å¼idï¼Œç¤ºä¾‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;popupwindow_anim_style&quot;&gt;</span><br><span class="line">&lt;item name=&quot;android:windowEnterAnimation&quot;&gt;@anim/dialog_bottom_enter&lt;/item&gt;</span><br><span class="line">&lt;item name=&quot;android:windowExitAnimation&quot;&gt;@anim/dialog_bottom_exit&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p><p>åˆ†åˆ«ç”±ä¸¤ä¸ªå±æ€§ç»„æˆ. ä¸¤ä¸ªå±æ€§å„ä»£è¡¨ä¸€ä¸ªanimåŠ¨ç”»æ–‡ä»¶.</p><h4 id="è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»"><a href="#è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»" class="headerlink" title="è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»"></a>è¿›å…¥å’Œé€€å‡ºåŠ¨ç”»</h4><p>è¿™æ˜¯åœ¨Android6.0(API 23)ååŠ å…¥çš„æ–¹æ³•. é…åˆMaterial Designçš„è½¬åœºåŠ¨ç”»ä½¿ç”¨.<br>è¿›å…¥åŠ¨ç”»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setEnterTransition (Transition enterTransition)</span><br></pre></td></tr></table></figure></p><p>é€€å‡ºåŠ¨ç”»<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setExitTransition (Transition exitTransition)</span><br></pre></td></tr></table></figure></p><h2 id="è¾“å…¥æ¨¡å¼"><a href="#è¾“å…¥æ¨¡å¼" class="headerlink" title="è¾“å…¥æ¨¡å¼"></a>è¾“å…¥æ¨¡å¼</h2><p>é’ˆå¯¹PopupWindowä¸­åŒ…å«EditTextæ§ä»¶.</p><h4 id="è¾“å…¥æ¨¡å¼-1"><a href="#è¾“å…¥æ¨¡å¼-1" class="headerlink" title="è¾“å…¥æ¨¡å¼"></a>è¾“å…¥æ¨¡å¼</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setInputMethodMode (int mode)</span><br></pre></td></tr></table></figure><p>æ”¯æŒä¸‰ç§æ¨¡å¼ï¼š<br>1ã€INPUT_METHOD_FROM_FOCUSABLE æ ¹æ®å¯å¦è·å–ç„¦ç‚¹åˆ¤æ–­æ˜¯å¦å¯è¾“å…¥<br>2ã€INPUT_METHOD_NEEDED å…è®¸è¾“å…¥<br>3ã€INPUT_METHOD_NOT_NEEDED ä¸å…è®¸è¾“å…¥</p><h4 id="è½¯é”®ç›˜æ¨¡å¼"><a href="#è½¯é”®ç›˜æ¨¡å¼" class="headerlink" title="è½¯é”®ç›˜æ¨¡å¼"></a>è½¯é”®ç›˜æ¨¡å¼</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setSoftInputMode (int mode) // modeä¸ºWindowManager.LayoutParamsçš„softInputModeå¸¸é‡</span><br></pre></td></tr></table></figure><p>softInputModeåŒ…å«ä¹ç§å–å€¼, å¯ç»„åˆä½¿ç”¨,åˆ†ä¸ºä¸¤ç±»:<br>æ˜¾ç¤ºçŠ¶æ€æ¨¡å¼</p><ol><li>SOFT_INPUT_STATE_UNSPECIFIED é»˜è®¤æ¨¡å¼</li><li>SOFT_INPUT_STATE_HIDDEN</li><li>SOFT_INPUT_STATE_ALWAYS_HIDDEN æ€»æ˜¯éšè—</li><li>SOFT_INPUT_STATE_UNCHANGED</li><li>SOFT_INPUT_STATE_VISIBLE</li><li>SOFT_INPUT_STATE_ALWAYS_VISIBLE è‡ªåŠ¨å¼¹å‡ºè½¯é”®ç›˜</li></ol><p>è°ƒæ•´æ¨¡å¼</p><ol><li>SOFT_INPUT_ADJUST_UNSPECIFIED é»˜è®¤æ¨¡å¼</li><li>SOFT_INPUT_ADJUST_RESIZE è½¯é”®ç›˜å¼¹å‡ºåPopupWindowä¼šè‡ªåŠ¨è°ƒæ•´åæ ‡,ä¸è¢«é®æŒ¡</li><li>SOFT_INPUT_ADJUST_PAN</li></ol><h2 id="ç›‘å¬äº‹ä»¶"><a href="#ç›‘å¬äº‹ä»¶" class="headerlink" title="ç›‘å¬äº‹ä»¶"></a>ç›‘å¬äº‹ä»¶</h2><h4 id="éšè—äº‹ä»¶ç›‘å¬"><a href="#éšè—äº‹ä»¶ç›‘å¬" class="headerlink" title="éšè—äº‹ä»¶ç›‘å¬"></a>éšè—äº‹ä»¶ç›‘å¬</h4><p>å³PopupWindowæ‰§è¡Œ<code>dismiss()</code>åå›è°ƒçš„æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setOnDismissListener (PopupWindow.OnDismissListener onDismissListener)</span><br></pre></td></tr></table></figure></p><h4 id="è§¦æ‘¸äº‹ä»¶æ‹¦æˆª"><a href="#è§¦æ‘¸äº‹ä»¶æ‹¦æˆª" class="headerlink" title="è§¦æ‘¸äº‹ä»¶æ‹¦æˆª"></a>è§¦æ‘¸äº‹ä»¶æ‹¦æˆª</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void setTouchInterceptor (View.OnTouchListener l)</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>ä»¥ä¸‹çš„æ›´æ–°PopupWindowéƒ½å¿…é¡»åœ¨PopupWindowå¤„äºä»¥åŠè¢«æ˜¾ç¤ºçš„çŠ¶æ€ä¸‹æ‰è¡Œï¼Œä¸”PopupWindowçš„å®½é«˜è®¾ç½®éƒ½å¿…é¡»å¤§äºç­‰äº0ï¼Œ å¦‚æœæƒ³å¿½ç•¥PopupWindowçš„å®½é«˜è®¾ç½®å°±è®¾ä¸º-1ã€‚</p><h4 id="æ›´æ–°çŠ¶æ€"><a href="#æ›´æ–°çŠ¶æ€" class="headerlink" title="æ›´æ–°çŠ¶æ€"></a>æ›´æ–°çŠ¶æ€</h4><p>è¯¥æ–¹æ³•ä¸èƒ½æ›´æ–°PopupWindowçš„å®½é«˜, åªèƒ½æ›´æ–°PopupWindowçš„çŠ¶æ€. ä¾‹å¦‚æ›´æ–°Focusableå’ŒOutsideTouchableã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void update ()</span><br></pre></td></tr></table></figure></p><h4 id="æ›´æ–°å°ºå¯¸"><a href="#æ›´æ–°å°ºå¯¸" class="headerlink" title="æ›´æ–°å°ºå¯¸"></a>æ›´æ–°å°ºå¯¸</h4><p>ä¸Šé¢è¯´è¿‡update()ä¸èƒ½æ›´æ–°PopupWindowçš„å®½é«˜, ä½†æ˜¯æä¾›æ›´æ–°å®½é«˜çš„updateæ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void update (int width, // æ›´æ–°PopupWindowçš„å®½é«˜</span><br><span class="line">int height)</span><br></pre></td></tr></table></figure></p><h4 id="æ›´æ–°æ˜¾ç¤ºä½ç½®"><a href="#æ›´æ–°æ˜¾ç¤ºä½ç½®" class="headerlink" title="æ›´æ–°æ˜¾ç¤ºä½ç½®"></a>æ›´æ–°æ˜¾ç¤ºä½ç½®</h4><p>è¯¥æ–¹æ³•æ˜¯ç›¸å½“äºé‡æ–°showAsDropDown, æ‰€ä»¥è¿™æ˜¯<strong>ç›¸å¯¹äºæ§ä»¶</strong>çš„ä½ç½®æ›´æ–°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">void update (View anchor, // æ›´æ–°æ˜¾ç¤ºæ§ä»¶çš„ä½ç½®</span><br><span class="line">int width, </span><br><span class="line">int height)</span><br><span class="line"></span><br><span class="line">void update (View anchor, </span><br><span class="line">int xoff, // ç›¸å¯¹äºæ§ä»¶çš„åç§»å€¼</span><br><span class="line">int yoff, </span><br><span class="line">int width, </span><br><span class="line">int height)</span><br></pre></td></tr></table></figure></p><h4 id="ç›¸å¯¹ä½ç½®æ›´æ–°"><a href="#ç›¸å¯¹ä½ç½®æ›´æ–°" class="headerlink" title="ç›¸å¯¹ä½ç½®æ›´æ–°"></a>ç›¸å¯¹ä½ç½®æ›´æ–°</h4><p>ç›¸å¯¹äºå½“å‰çš„ä½ç½®è¿›è¡Œåç§»ï¼Œ ä¸åŒçš„æ˜¾ç¤ºä½ç½®å¯¹äºçš„ç›¸å¯¹åŸç‚¹ä¹Ÿä¸åŒã€‚<br>showAsDropDownçš„ç›¸å¯¹åŸç‚¹æ˜¯æ•´ä¸ªå±å¹•å·¦ä¸Šè§’, åŒ…æ‹¬çŠ¶æ€æ ã€‚æ‰€ä»¥ç”±äºåŒ…æ‹¬çŠ¶æ€æ æ‰€ä»¥åæ ‡åç§»çš„æ—¶å€™ä¸€å®šè¦yè½´åç§»å¤§äº60è¶…å‡ºçŠ¶æ€æ çš„é«˜åº¦ã€‚ å¦åˆ™å› ä¸ºé®æŒ¡çŠ¶æ€æ å¯¼è‡´PopupWindowæ— æ³•æ˜¾ç¤º.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mPopupWindow.update(50, 60, -1,-1); // xè½´åç§»50</span><br></pre></td></tr></table></figure></p><p>showAtLocationçš„ç›¸å¯¹åŸç‚¹æ˜¯<strong>è‡ªèº«ä½ç½®</strong>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">void update (int x, // åæ ‡åç§»</span><br><span class="line">int y, </span><br><span class="line">int width, // PopupWindowå®½é«˜</span><br><span class="line">int height)</span><br><span class="line"></span><br><span class="line">void update (int x, </span><br><span class="line">int y, </span><br><span class="line">int width, </span><br><span class="line">int height, </span><br><span class="line">boolean force) // å¯è·å–ç„¦ç‚¹</span><br></pre></td></tr></table></figure></p><h2 id="èƒŒæ™¯å˜ç°"><a href="#èƒŒæ™¯å˜ç°" class="headerlink" title="èƒŒæ™¯å˜ç°"></a>èƒŒæ™¯å˜ç°</h2><p>å½“æˆ‘ä»¬å¼¹å‡ºPopupWindowæ—¶ï¼Œæœ‰æ—¶å¸Œæœ›èƒŒæ™¯èƒ½å¤Ÿå˜æˆç°è‰²ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* è®¾ç½®æ·»åŠ å±å¹•çš„èƒŒæ™¯é€æ˜åº¦</span><br><span class="line">* </span><br><span class="line">* @param bgAlpha å±å¹•é€æ˜åº¦0.0-1.0 1è¡¨ç¤ºå®Œå…¨ä¸é€æ˜</span><br><span class="line">*            </span><br><span class="line">*/</span><br><span class="line">public void setBackgroundAlpha(float bgAlpha) &#123;</span><br><span class="line">WindowManager.LayoutParams lp = ((Activity) mContext).getWindow().getAttributes();</span><br><span class="line">lp.alpha = bgAlpha;</span><br><span class="line">((Activity) mContext).getWindow().setAttributes(lp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://juejin.im/post/58ed82c3a22b9d0063469e98" target="_blank" rel="noopener">PopupWindowæœ€å…¨ä½¿ç”¨è¯´æ˜</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;PopupWindowæ˜¯&lt;code&gt;android.widget&lt;/code&gt;ä¸­ä¸€ä¸ªå¼¹æ¡†æ§ä»¶ï¼Œä¸æ™®é€šdialogç›¸æ¯”ï¼Œå®ƒçš„ä¼˜åŠ¿åœ¨äºå¯ä»¥ä»»æ„æ”¹å˜å…¶åœ¨ç•Œé¢ä¸­çš„ä½ç½®ã€‚æœ¬ç¯‡æˆ‘ä»¬å°±æ¥å¥½å¥½ç ”ç©¶ä¸€ä¸‹å®ƒçš„ç”¨æ³•å§ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="PopupWindow" scheme="http://yoursite.com/tags/PopupWindow/"/>
    
  </entry>
  
  <entry>
    <title>Javaæšä¸¾ç”¨æ³•æ€»ç»“</title>
    <link href="http://yoursite.com/2018/03/24/Java%E6%9E%9A%E4%B8%BE%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2018/03/24/Javaæšä¸¾ç”¨æ³•æ€»ç»“/</id>
    <published>2018-03-24T12:35:09.000Z</published>
    <updated>2018-03-24T12:39:28.600Z</updated>
    
    <content type="html"><![CDATA[<p>æšä¸¾æ˜¯JDK1.5å¼•å…¥çš„æ–°ç±»å‹ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªå°åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒå´ç»™æˆ‘ä»¬çš„ç¨‹åºå¼€å‘å¸¦æ¥äº†æå¤§çš„ä¾¿æ·ï¼Œæœ¬æ–‡å°±å¯¹å®ƒçš„ç”¨æ³•åšä¸€ä¸ªå°ç»“ã€‚<a id="more"></a></p><h4 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h4><p>åœ¨JDK 1.5ä¹‹å‰ï¼Œæˆ‘ä»¬å®šä¹‰å¸¸é‡éƒ½æ˜¯public final static â€¦â€¦ï¼Œè¿™ç§å®šä¹‰æ–¹å¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼Šç«¯å°±æ˜¯ä»£ç ç´Šä¹±ï¼Œéœ€è¦å¤§é‡çš„æ³¨é‡Šã€‚æœ‰äº†æšä¸¾ç±»å‹ï¼Œäº‹æƒ…å°±å¥½åŠäº†ã€‚æ¯”å¦‚æˆ‘ä»¬è¦å®šä¹‰ä¸€ç»„é¢œè‰²å¸¸é‡ï¼Œå¯ä»¥è¿™æ ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public enum Color&#123;</span><br><span class="line">WHITE,BLACK,RED</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ˜¯ä¸æ˜¯å¾ˆæ¸…æ™°äº†å‘¢ï¼Œé™¤äº†ä¼šä½¿ä»£ç ç»“æ„æ¸…æ™°ä¹‹å¤–ï¼Œæšä¸¾è¿˜æä¾›äº†è®¸å¤šä¾¿æ·çš„æ“ä½œâ€¦â€¦</p><h4 id="Switch"><a href="#Switch" class="headerlink" title="Switch"></a>Switch</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">enum Signal &#123;  </span><br><span class="line">GREEN, YELLOW, RED  </span><br><span class="line">&#125;  </span><br><span class="line">public class TrafficLight &#123;  </span><br><span class="line">Signal color = Signal.RED;  </span><br><span class="line">public void change() &#123;  </span><br><span class="line">switch (color) &#123;  </span><br><span class="line">case RED:  </span><br><span class="line">color = Signal.GREEN;  </span><br><span class="line">break;  </span><br><span class="line">case YELLOW:  </span><br><span class="line">color = Signal.RED;  </span><br><span class="line">break;  </span><br><span class="line">case GREEN:  </span><br><span class="line">color = Signal.YELLOW;  </span><br><span class="line">break;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‘æšä¸¾ä¸­æ·»åŠ æ–°æ–¹æ³•"><a href="#å‘æšä¸¾ä¸­æ·»åŠ æ–°æ–¹æ³•" class="headerlink" title="å‘æšä¸¾ä¸­æ·»åŠ æ–°æ–¹æ³•"></a>å‘æšä¸¾ä¸­æ·»åŠ æ–°æ–¹æ³•</h4><p>æšä¸¾ä¸­å¯ä»¥è‡ªå®šä¹‰æ–¹æ³•ï¼Œä½†æ˜¯å¿…é¡»ä¿è¯å…ˆå®šä¹‰æšä¸¾çš„å®ä¾‹ï¼Œå¹¶ä¸”åœ¨æœ€åä¸€ä¸ªå®ä¾‹åé¢ç”¨åˆ†å·ç»“å°¾ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public enum Color &#123;  </span><br><span class="line">RED(&quot;çº¢è‰²&quot;, 1), GREEN(&quot;ç»¿è‰²&quot;, 2), BLANK(&quot;ç™½è‰²&quot;, 3), YELLO(&quot;é»„è‰²&quot;, 4);  </span><br><span class="line">// æˆå‘˜å˜é‡  </span><br><span class="line">private String name;  </span><br><span class="line">private int index;  </span><br><span class="line">// æ„é€ æ–¹æ³•  </span><br><span class="line">private Color(String name, int index) &#123;  </span><br><span class="line">this.name = name;  </span><br><span class="line">this.index = index;  </span><br><span class="line">&#125;  </span><br><span class="line">// æ™®é€šæ–¹æ³•  </span><br><span class="line">public static String getName(int index) &#123;  </span><br><span class="line">for (Color c : Color.values()) &#123;  </span><br><span class="line">if (c.getIndex() == index) &#123;  </span><br><span class="line">return c.name;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;  </span><br><span class="line">return null;  </span><br><span class="line">&#125;  </span><br><span class="line">// get set æ–¹æ³•  </span><br><span class="line">public String getName() &#123;  </span><br><span class="line">return name;  </span><br><span class="line">&#125;  </span><br><span class="line">public void setName(String name) &#123;  </span><br><span class="line">this.name = name;  </span><br><span class="line">&#125;  </span><br><span class="line">public int getIndex() &#123;  </span><br><span class="line">return index;  </span><br><span class="line">&#125;  </span><br><span class="line">public void setIndex(int index) &#123;  </span><br><span class="line">this.index = index;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>è¡¥å……</strong><br>æšä¸¾æœ‰ä¸¤ä¸ªé»˜è®¤çš„æ–¹æ³•ï¼Œ<code>name()</code>ã€<code>ordinal()</code>æ–¹æ³•ã€‚å‰è€…å¯ä»¥ç†è§£ä¸ºæ˜¯æšä¸¾å®ä¾‹çš„åç§°ã€‚åè€…ç†è§£ä¸ºæšä¸¾çš„ç¼–å·ï¼Œä»0é€’å¢ã€‚</p></blockquote><h4 id="è¦†ç›–æšä¸¾çš„æ–¹æ³•"><a href="#è¦†ç›–æšä¸¾çš„æ–¹æ³•" class="headerlink" title="è¦†ç›–æšä¸¾çš„æ–¹æ³•"></a>è¦†ç›–æšä¸¾çš„æ–¹æ³•</h4><p>ä¸‹é¢ç»™å‡ºè¦†ç›–<code>toString()</code>æ–¹æ³•çš„ä¾‹å­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public enum Color &#123;  </span><br><span class="line">RED(&quot;çº¢è‰²&quot;, 1), GREEN(&quot;ç»¿è‰²&quot;, 2), BLANK(&quot;ç™½è‰²&quot;, 3), YELLO(&quot;é»„è‰²&quot;, 4);  </span><br><span class="line">// æˆå‘˜å˜é‡  </span><br><span class="line">private String name;  </span><br><span class="line">private int index;  </span><br><span class="line">// æ„é€ æ–¹æ³•  </span><br><span class="line">private Color(String name, int index) &#123;  </span><br><span class="line">this.name = name;  </span><br><span class="line">this.index = index;  </span><br><span class="line">&#125;  </span><br><span class="line">//è¦†ç›–æ–¹æ³•  </span><br><span class="line">@Override </span><br><span class="line">public String toString() &#123;  </span><br><span class="line">return this.index+&quot;_&quot;+this.name;  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å®ç°æ¥å£"><a href="#å®ç°æ¥å£" class="headerlink" title="å®ç°æ¥å£"></a>å®ç°æ¥å£</h4><p>æ‰€æœ‰æšä¸¾éƒ½è‡ªåŠ¨ç»§æ‰¿è‡ªjava.lang.Enumç±»ã€‚ç”±äºJavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å°†æšä¸¾ç±»ç»§æ‰¿å…¶å®ƒçš„ç±»ï¼Œä½†æ˜¯æšä¸¾ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public interface Behaviour &#123;  </span><br><span class="line">void print();  </span><br><span class="line">String getInfo();  </span><br><span class="line">&#125;  </span><br><span class="line">public enum Color implements Behaviour&#123;  </span><br><span class="line">RED(&quot;çº¢è‰²&quot;, 1), GREEN(&quot;ç»¿è‰²&quot;, 2), BLANK(&quot;ç™½è‰²&quot;, 3), YELLO(&quot;é»„è‰²&quot;, 4);  </span><br><span class="line">// æˆå‘˜å˜é‡  </span><br><span class="line">private String name;  </span><br><span class="line">private int index;  </span><br><span class="line">// æ„é€ æ–¹æ³•  </span><br><span class="line">private Color(String name, int index) &#123;  </span><br><span class="line">this.name = name;  </span><br><span class="line">this.index = index;  </span><br><span class="line">&#125;  </span><br><span class="line">//æ¥å£æ–¹æ³•  </span><br><span class="line">@Override  </span><br><span class="line">public String getInfo() &#123;  </span><br><span class="line">return this.name;  </span><br><span class="line">&#125;  </span><br><span class="line">//æ¥å£æ–¹æ³•  </span><br><span class="line">@Override  </span><br><span class="line">public void print() &#123;  </span><br><span class="line">System.out.println(this.index+&quot;:&quot;+this.name);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾"><a href="#ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾" class="headerlink" title="ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾"></a>ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾</h4><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ç»Ÿä¸€ç®¡ç†å¸¸é‡è¯ï¼Œå¯ä»¥ä½¿ç”¨æ¥å£ç»„ç»‡æšä¸¾ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public interface Food &#123;  </span><br><span class="line">enum Coffee implements Food&#123;  </span><br><span class="line">BLACK_COFFEE,DECAF_COFFEE,LATTE,CAPPUCCINO  </span><br><span class="line">&#125;  </span><br><span class="line">enum Dessert implements Food&#123;  </span><br><span class="line">FRUIT, CAKE, GELATO  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://blog.csdn.net/qq_27093465/article/details/52180865" target="_blank" rel="noopener">Java æšä¸¾(enum) è¯¦è§£7ç§å¸¸è§çš„ç”¨æ³•</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æšä¸¾æ˜¯JDK1.5å¼•å…¥çš„æ–°ç±»å‹ï¼Œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªå°åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒå´ç»™æˆ‘ä»¬çš„ç¨‹åºå¼€å‘å¸¦æ¥äº†æå¤§çš„ä¾¿æ·ï¼Œæœ¬æ–‡å°±å¯¹å®ƒçš„ç”¨æ³•åšä¸€ä¸ªå°ç»“ã€‚
    
    </summary>
    
      <category term="JavaåŸºç¡€" scheme="http://yoursite.com/categories/Java%E5%9F%BA%E7%A1%80/"/>
    
    
      <category term="æšä¸¾" scheme="http://yoursite.com/tags/%E6%9E%9A%E4%B8%BE/"/>
    
  </entry>
  
  <entry>
    <title>Javaçº¿ç¨‹æ± </title>
    <link href="http://yoursite.com/2018/03/13/Java%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <id>http://yoursite.com/2018/03/13/Javaçº¿ç¨‹æ± /</id>
    <published>2018-03-13T14:44:03.000Z</published>
    <updated>2018-05-20T07:31:43.236Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè€—æ—¶é—´å’Œèµ„æºçš„ï¼Œå› æ­¤ï¼Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹è¿‡ç¨‹ä¸­å¦‚æœèƒ½å‡å°‘çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æ“ä½œï¼Œé‚£ä¹ˆå¯¹äºç¨‹åºçš„æ€§èƒ½å°†å¾—åˆ°å¾ˆå¤§çš„æé«˜ã€‚Javaçº¿ç¨‹æ± çš„å‡ºç°ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ä¸ä»…å¦‚æ­¤ï¼Œçº¿ç¨‹æ± è¿˜å¯ä»¥æ§åˆ¶çº¿ç¨‹çš„åˆ›å»ºæ•°é‡ï¼Œé¿å…å†…å­˜æ¶ˆè€—è¿‡å¤šã€‚<a id="more"></a><br>å­¦ä¹ çº¿ç¨‹æ± ï¼Œéœ€è¦ç”¨åˆ°ä»¥ä¸‹å‡ ä¸ªå…³é”®ç±»ã€‚<br>1ã€Executor<br>2ã€Executors<br>3ã€ExecutorSevice<br>4ã€ThreadPoolExecutor<br>åœ¨åˆ†åˆ«ä»‹ç»å®ƒä»¬ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ‹æ¸…ä¸€ä¸‹å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚<br><img src="/2018/03/13/Javaçº¿ç¨‹æ± /Jietu20180512-192205@2x.jpg"><br>å›¾ä¸­çš„AbstractExecutorServiceç±»å¯ä»¥ä¸ç”¨ç†ä¼šï¼Œæˆ‘ä»¬ä¸è®²å®ƒã€‚å¦å¤–ï¼ŒExcutorsç±»ä¸å¥½åœ¨<a href="http://www.cnblogs.com/xrq730/p/5527115.html" target="_blank" rel="noopener">UMLç±»å›¾</a>ä¸­å°†å…¶æ¶µç›–è¿›å»ï¼Œç­‰ä¼šæˆ‘ä»¬å†ä»‹ç»ã€‚</p><h1 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h1><p>æŸ¥çœ‹Executorçš„APIï¼Œæœ‰è¿™ä¹ˆä¸€æ®µè¯ï¼š</p><blockquote><p>The Executor implementations provided in this package implement ExecutorService, which is a more extensive interface. The ThreadPoolExecutor class provides an extensible thread pool implementation. The Executors class provides convenient factory methods for these Executors.</p></blockquote><p>å¤§æ¦‚æ„æ€æ˜¯ï¼ŒExecutorServiceæ¥å£åœ¨Executoræ¥å£çš„åŸºç¡€ä¸Šåˆæ‹“å±•äº†ä¸€äº›åŠŸèƒ½ï¼›è€ŒThreadPoolExecutorç±»æä¾›äº†ä¸€ä¸ªå¯æ‹“å±•çš„çº¿ç¨‹æ± å®ç°ï¼›Executorsç±»æ˜¯ä¸€ä¸ªå·¥å‚ç±»ï¼Œå®ƒä¸ºExecutorç±»çš„å®ç°æä¾›äº†ä¾¿æ·çš„é€šé“ã€‚<br>è¿™é‡Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä¹‹å‰æåˆ°çš„<code>Executors</code>ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼Œç”¨æ¥äº§ç”ŸExecutorå¯¹è±¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Executor excutor = Executors.newFixedThreadPool(10);  </span><br><span class="line">excutor.execute(new Runnable() &#123;  </span><br><span class="line">public void run() &#123;  </span><br><span class="line">System.out.println(&quot;Asynchronous task&quot;);  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ä»¥ä¸Šæ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚åŒæ—¶ï¼Œé™¤äº†å¯ä»¥ä½¿ç”¨<code>newFixedThreadPool</code>åˆ›å»ºExecutorå¯¹è±¡ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Executors.newSingleThreadExecutor();  </span><br><span class="line">Executors.newScheduledThreadPool(size);</span><br></pre></td></tr></table></figure></p><p>ç”Ÿäº§Executorå¯¹è±¡ï¼Œå…·ä½“ç”¨æ³•ä¹‹åä¼šä»‹ç»ã€‚</p><h1 id="ExecutorSevice"><a href="#ExecutorSevice" class="headerlink" title="ExecutorSevice"></a>ExecutorSevice</h1><p>å¦‚ä¸Šæ‰€æï¼ŒExecutorSeviceå®é™…ä¸Šåªæ˜¯æ¯”Executorå¤šäº†ä¸€äº›æ–¹æ³•è€Œå·²ï¼Œå®ƒåŒæ ·å¯ä»¥é€šè¿‡<code>Executors</code>æä¾›çš„å·¥å‚æ–¹æ³•åˆ›é€ å‡ºæ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecutorSevice executorService = Executors.newFixedThreadPool(10);</span><br></pre></td></tr></table></figure></p><p>é™¤äº†<code>execute()</code>ï¼ŒExecutorSeviceæä¾›äº†å…è®¸è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœçš„<code>submit()</code>ï¼Œè¿”å›ç»“æœçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š<br>1ã€ä¼ å…¥Runnableå¯¹è±¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;String&gt; future=executor.submit(new Runnable() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void run() &#123;</span><br><span class="line">System.out.println(&quot;Asynchronous task&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>2ã€ä¼ å…¥Callableå¯¹è±¡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;String&gt; future = executor.submit(new Callable&lt;String&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public String call() throws Exception &#123;</span><br><span class="line">System.out.println(&quot;Asynchronous task&quot;);</span><br><span class="line">return &quot;result&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªä¸¤ç§æ–¹å¼éƒ½å¯ä»¥é€šè¿‡<code>future.getï¼ˆï¼‰</code>è·å¾—è¿”å›çš„ç»“æœï¼Œå¹¶ä¸”<code>future.getï¼ˆï¼‰</code>æ˜¯ä¸€ä¸ªé˜»å¡æ–¹æ³•ã€‚ä¸åŒçš„æ˜¯ï¼ŒRunnableæ–¹å¼çš„è¿”å›å€¼å§‹ç»ˆä¸ºnullï¼ŒCallableæ–¹å¼çš„è¿”å›å€¼å°†å–å†³äºç”¨æˆ·çš„è®¾å®šã€‚<br>ç‰¹åˆ«åœ°ï¼ŒExecutorSeviceè¿˜æä¾›äº†å¯ä»¥å¤„ç†Callableé›†åˆçš„æ–¹æ³•invokeAnyå’ŒinvokeAll,å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/suifeng3051/article/details/49443835" target="_blank" rel="noopener">è¿™ä¸€ç¯‡æ–‡ç« </a>ã€‚<br>å°†<code>invokeAll</code>è¿ç”¨åœ¨éœ€è¦å¹¶è¡Œè¿è¡Œçš„åœºæ™¯ï¼Œå¯ä»¥å‡å°‘æ¯”è¾ƒå¤šçš„æ–¹æ³•æ‰§è¡Œæ—¶é—´ã€‚æ¯”å¦‚ï¼šæ–¹æ³•Aå’Œæ–¹æ³•Båˆ†åˆ«éƒ½æ‰§è¡Œäº†ä¸€äº›è€—æ—¶æ“ä½œï¼Œè€Œæˆ‘ä»¬æœ€åçš„å€¼ä¾èµ–äºè¿™ä¸¤ä¸ªæ–¹æ³•çš„æ‰§è¡Œç»“æœã€‚é‚£ä¹ˆç¬¬ä¸€ç§æ–¹æ³•æ˜¯è®©Aã€Bä¸²è¡Œæ‰§è¡Œï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯å°†Aã€Bé€»è¾‘åˆ†åˆ«è®¾ç½®ä¸ºcallableå¯¹è±¡ï¼Œä¹‹åé€šè¿‡invokeAllå¹¶è¡Œæ‰§è¡Œå®ƒä¿©ï¼Œå®éªŒç»“æœæ˜¯ç¬¬äºŒç§æ–¹æ³•ä¼˜äºç¬¬ä¸€ç§æ–¹æ³•çš„å®ç°ã€‚</p><h1 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h1><p>ThreadPoolExecutoræ”¯æŒé€šè¿‡è°ƒæ•´æ„é€ å‚æ•°æ¥é…ç½®ä¸åŒçš„å¤„ç†ç­–ç•¥ï¼Œä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„ç­–ç•¥é…ç½®æ–¹æ³•ä»¥åŠåº”ç”¨åœºæ™¯ã€‚</p><h4 id="ThreadPoolExecutor-çš„å¤„ç†é€»è¾‘"><a href="#ThreadPoolExecutor-çš„å¤„ç†é€»è¾‘" class="headerlink" title="ThreadPoolExecutor çš„å¤„ç†é€»è¾‘"></a>ThreadPoolExecutor çš„å¤„ç†é€»è¾‘</h4><p>é¦–å…ˆçœ‹ä¸€ä¸‹ ThreadPoolExecutor æ„é€ å‡½æ•°çš„å®šä¹‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public ThreadPoolExecutor(int corePoolSize,  //çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span><br><span class="line">int maximumPoolSize,                  //çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°é‡</span><br><span class="line">long keepAliveTime,                   //çº¿ç¨‹KeepAliveæ—¶é—´ï¼Œå½“çº¿ç¨‹æ± æ•°é‡è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°é‡ä»¥åï¼Œidleæ—¶é—´è¶…è¿‡è¿™ä¸ªå€¼çš„çº¿ç¨‹ä¼šè¢«ç»ˆæ­¢</span><br><span class="line">TimeUnit unit,                        //çº¿ç¨‹KeepAliveæ—¶é—´å•ä½</span><br><span class="line">BlockingQueue&lt;Runnable&gt; workQueue,    //ä»»åŠ¡é˜Ÿåˆ—</span><br><span class="line">ThreadFactory threadFactory,          //åˆ›å»ºçº¿ç¨‹çš„å·¥å‚å¯¹è±¡</span><br><span class="line">RejectedExecutionHandler handler)     //ä»»åŠ¡è¢«æ‹’ç»åè°ƒç”¨çš„handler</span><br></pre></td></tr></table></figure></p><p>ThreadPoolExecutor å¯¹çº¿ç¨‹æ± å’Œé˜Ÿåˆ—çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š<br>1ã€ä»çº¿ç¨‹æ± ä¸­è·å–å¯ç”¨çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çº¿ç¨‹åˆ™ä½¿ç”¨ThreadFactoryåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹æ•°è¾¾åˆ°corePoolSizeé™åˆ¶ï¼›<br>2ã€çº¿ç¨‹æ± çº¿ç¨‹æ•°è¾¾åˆ°corePoolSizeä»¥åï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ”¾å…¥é˜Ÿåˆ—ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸èƒ½å†å®¹çº³æ›´å¤šçš„ä»»åŠ¡ï¼›<br>3ã€å½“é˜Ÿåˆ—ä¸èƒ½å†å®¹çº³æ›´å¤šçš„ä»»åŠ¡ä»¥åï¼Œä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹æ•°è¾¾åˆ°maxinumPoolSizeé™åˆ¶ï¼›<br>4ã€çº¿ç¨‹æ•°è¾¾åˆ°maxinumPoolSizeé™åˆ¶ä»¥åæ–°ä»»åŠ¡ä¼šè¢«æ‹’ç»æ‰§è¡Œï¼Œè°ƒç”¨ RejectedExecutionHandler è¿›è¡Œå¤„ç†ã€‚</p><h4 id="ä¸‰ç§å¸¸ç”¨çš„-ThreadPoolExecutor"><a href="#ä¸‰ç§å¸¸ç”¨çš„-ThreadPoolExecutor" class="headerlink" title="ä¸‰ç§å¸¸ç”¨çš„ ThreadPoolExecutor"></a>ä¸‰ç§å¸¸ç”¨çš„ ThreadPoolExecutor</h4><p>Executors æ˜¯æä¾›äº†ä¸€ç»„å·¥å‚æ–¹æ³•ç”¨äºåˆ›å»ºå¸¸ç”¨çš„ ExecutorService ï¼Œåˆ†åˆ«æ˜¯ FixedThreadPoolï¼ŒCachedThreadPool ä»¥åŠ SingleThreadExecutorã€‚è¿™ä¸‰ç§ThreadPoolExecutoréƒ½æ˜¯è°ƒç”¨ ThreadPoolExecutor æ„é€ å‡½æ•°è¿›è¡Œåˆ›å»ºï¼ŒåŒºåˆ«åœ¨äºå‚æ•°ä¸åŒã€‚<br><strong>1ã€FixedThreadPool - çº¿ç¨‹æ± å¤§å°å›ºå®šï¼Œä»»åŠ¡é˜Ÿåˆ—æ— ç•Œã€‚</strong><br>ä¸‹é¢æ˜¯ Executors ç±» newFixedThreadPool æ–¹æ³•çš„æºç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newFixedThreadPool(int nThreads) &#123;</span><br><span class="line">return new ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">0L, TimeUnit.MILLISECONDS,</span><br><span class="line">new LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ° corePoolSize å’Œ maximumPoolSize è®¾ç½®æˆäº†ç›¸åŒçš„å€¼ï¼Œæ­¤æ—¶ä¸å­˜åœ¨çº¿ç¨‹æ•°é‡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°é‡çš„æƒ…å†µï¼Œæ‰€ä»¥KeepAliveæ—¶é—´è®¾ç½®ä¸ä¼šç”Ÿæ•ˆã€‚ä»»åŠ¡é˜Ÿåˆ—ä½¿ç”¨çš„æ˜¯ä¸é™åˆ¶å¤§å°çš„ LinkedBlockingQueue ï¼Œç”±äºæ˜¯æ— ç•Œé˜Ÿåˆ—æ‰€ä»¥å®¹çº³çš„ä»»åŠ¡æ•°é‡æ²¡æœ‰ä¸Šé™ã€‚<br>å› æ­¤ï¼ŒFixedThreadPoolçš„è¡Œä¸ºå¦‚ä¸‹ï¼š<br>1ã€ä»çº¿ç¨‹æ± ä¸­è·å–å¯ç”¨çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çº¿ç¨‹åˆ™ä½¿ç”¨ThreadFactoryåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹æ•°è¾¾åˆ°nThreadsï¼›<br>2ã€çº¿ç¨‹æ± çº¿ç¨‹æ•°è¾¾åˆ°nThreadsä»¥åï¼Œæ–°çš„ä»»åŠ¡å°†è¢«æ”¾å…¥é˜Ÿåˆ—ã€‚<br>FixedThreadPoolçš„ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿä¿è¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½è¢«æ‰§è¡Œï¼Œæ°¸è¿œä¸ä¼šæ‹’ç»æ–°çš„ä»»åŠ¡ï¼›åŒæ—¶ç¼ºç‚¹æ˜¯é˜Ÿåˆ—æ•°é‡æ²¡æœ‰é™åˆ¶ï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œæ—¶é—´æ— é™å»¶é•¿çš„è¿™ç§æç«¯æƒ…å†µä¸‹ä¼šé€ æˆå†…å­˜é—®é¢˜ã€‚<br><strong>2ã€SingleThreadExecutor - çº¿ç¨‹æ± å¤§å°å›ºå®šä¸º1ï¼Œä»»åŠ¡é˜Ÿåˆ—æ— ç•Œ</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newSingleThreadExecutor() &#123;</span><br><span class="line">return new FinalizableDelegatedExecutorService</span><br><span class="line">(new ThreadPoolExecutor(1, 1,</span><br><span class="line">0L, TimeUnit.MILLISECONDS,</span><br><span class="line">new LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªå·¥å‚æ–¹æ³•ä¸­ä½¿ç”¨æ— ç•ŒLinkedBlockingQueueï¼Œå¹¶çš„å°†çº¿ç¨‹æ•°è®¾ç½®æˆ1ã€‚è™½ç„¶æ˜¯å•çº¿ç¨‹å¤„ç†ï¼Œä¸€æ—¦çº¿ç¨‹å› ä¸ºå¤„ç†å¼‚å¸¸ç­‰åŸå› ç»ˆæ­¢çš„æ—¶å€™ï¼ŒThreadPoolExecutorä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»§ç»­è¿›è¡Œå·¥ä½œã€‚<br>SingleThreadExecutor é€‚ç”¨äºåœ¨é€»è¾‘ä¸Šéœ€è¦å•çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„åœºæ™¯ï¼ŒåŒæ—¶æ— ç•Œçš„LinkedBlockingQueueä¿è¯æ–°ä»»åŠ¡éƒ½èƒ½å¤Ÿæ”¾å…¥é˜Ÿåˆ—ï¼Œä¸ä¼šè¢«æ‹’ç»ï¼›ç¼ºç‚¹å’ŒFixedThreadPoolç›¸åŒï¼Œå½“å¤„ç†ä»»åŠ¡æ— é™ç­‰å¾…çš„æ—¶å€™ä¼šé€ æˆå†…å­˜é—®é¢˜ã€‚<br><strong>3ã€CachedThreadPool - çº¿ç¨‹æ± æ— é™å¤§ï¼ˆMAX INTï¼‰ï¼Œç­‰å¾…é˜Ÿåˆ—é•¿åº¦ä¸º1</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static ExecutorService newCachedThreadPool() &#123;</span><br><span class="line">return new ThreadPoolExecutor(0, Integer.MAX_VALUE,</span><br><span class="line">60L, TimeUnit.SECONDS,</span><br><span class="line">new SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>SynchronousQueueæ˜¯ä¸€ä¸ªåªæœ‰1ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ï¼Œå…¥é˜Ÿçš„ä»»åŠ¡éœ€è¦ä¸€ç›´ç­‰å¾…ç›´åˆ°é˜Ÿåˆ—ä¸­çš„å…ƒç´ è¢«ç§»å‡ºã€‚æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯0ï¼Œæ„å‘³ç€æ‰€æœ‰ä»»åŠ¡ä¼šå…ˆå…¥é˜Ÿåˆ—ï¼›æœ€å¤§çº¿ç¨‹æ•°æ˜¯Integer.MAX_VALUEï¼Œå¯ä»¥è®¤ä¸ºçº¿ç¨‹æ•°é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚KeepAliveæ—¶é—´è¢«è®¾ç½®æˆ60ç§’ï¼Œæ„å‘³ç€åœ¨æ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ç­‰å¾…60ç§’ä»¥åé€€å‡ºã€‚CachedThreadPoolå¯¹ä»»åŠ¡çš„å¤„ç†ç­–ç•¥æ˜¯æäº¤çš„ä»»åŠ¡ä¼šç«‹å³åˆ†é…ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ‰§è¡Œï¼Œçº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡ä¼šéšç€ä»»åŠ¡æ•°çš„å˜åŒ–è‡ªåŠ¨æ‰©å¼ å’Œç¼©å‡ï¼Œåœ¨ä»»åŠ¡æ‰§è¡Œæ—¶é—´æ— é™å»¶é•¿çš„æç«¯æƒ…å†µä¸‹ä¼šåˆ›å»ºè¿‡å¤šçš„çº¿ç¨‹ã€‚</p><blockquote><p><strong>è¯´æ˜ï¼š</strong><br>å®éªŒè¯æ˜ï¼Œå½“è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°åï¼Œçº¿ç¨‹æ± çš„æœºåˆ¶æ˜¯å°½é‡é‡ç”¨è¿˜åœ¨KeepAliveæ—¶é—´å†…çš„çº¿ç¨‹ã€‚</p></blockquote><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://segmentfault.com/a/1190000008394155" target="_blank" rel="noopener">ThreadPoolExecutorç­–ç•¥é…ç½®ä»¥åŠåº”ç”¨åœºæ™¯</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè€—æ—¶é—´å’Œèµ„æºçš„ï¼Œå› æ­¤ï¼Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹è¿‡ç¨‹ä¸­å¦‚æœèƒ½å‡å°‘çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯æ“ä½œï¼Œé‚£ä¹ˆå¯¹äºç¨‹åºçš„æ€§èƒ½å°†å¾—åˆ°å¾ˆå¤§çš„æé«˜ã€‚Javaçº¿ç¨‹æ± çš„å‡ºç°ï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ä¸ä»…å¦‚æ­¤ï¼Œçº¿ç¨‹æ± è¿˜å¯ä»¥æ§åˆ¶çº¿ç¨‹çš„åˆ›å»ºæ•°é‡ï¼Œé¿å…å†…å­˜æ¶ˆè€—è¿‡å¤šã€‚
    
    </summary>
    
      <category term="JavaåŸºç¡€" scheme="http://yoursite.com/categories/Java%E5%9F%BA%E7%A1%80/"/>
    
    
      <category term="å¹¶å‘ç¼–ç¨‹" scheme="http://yoursite.com/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"/>
    
      <category term="çº¿ç¨‹æ± " scheme="http://yoursite.com/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    
  </entry>
  
  <entry>
    <title>Androidå›¾ç‰‡å‹ç¼©æ–¹ç•¥</title>
    <link href="http://yoursite.com/2018/02/22/Android%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9%E6%96%B9%E7%95%A5/"/>
    <id>http://yoursite.com/2018/02/22/Androidå›¾ç‰‡å‹ç¼©æ–¹ç•¥/</id>
    <published>2018-02-22T02:50:42.000Z</published>
    <updated>2018-03-07T09:19:57.780Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬é€šå¸¸é‡‡ç”¨å¤šç§æ–¹å¼ç»“åˆçš„æ–¹æ³•å®ç°å›¾ç‰‡å‹ç¼©éœ€æ±‚ï¼Œè¿™äº›æ–¹å¼åŒ…æ‹¬è´¨é‡å‹ç¼©ã€å°ºå¯¸å‹ç¼©ã€‚æœ¬ç« å°†åˆ†åˆ«ä»‹ç»è¿™ä¸¤ç§æ–¹å¼ï¼Œå¹¶ä¸”æœ€åå°†ç»“åˆè¿™ä¸¤ç§æ–¹å¼å®ç°å›¾ç‰‡å‹ç¼©çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆã€‚<a id="more"></a></p><h1 id="è´¨é‡å‹ç¼©"><a href="#è´¨é‡å‹ç¼©" class="headerlink" title="è´¨é‡å‹ç¼©"></a>è´¨é‡å‹ç¼©</h1><p>è®¾ç½®bitmap optionså±æ€§ï¼Œé™ä½å›¾ç‰‡çš„è´¨é‡ï¼Œä½†åƒç´ ä¸ä¼šå‡å°‘ï¼Œoptions å±æ€§çš„å€¼ä¸º0-100ï¼Œæ¥å®ç°å‹ç¼©ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static void compressImageToFile(Bitmap bmp,File file) &#123;</span><br><span class="line">// 0-100 100ä¸ºä¸å‹ç¼©</span><br><span class="line">int options = 100; </span><br><span class="line">ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">// æŠŠå‹ç¼©åçš„æ•°æ®å­˜æ”¾åˆ°baosä¸­</span><br><span class="line">bmp.compress(Bitmap.CompressFormat.JPEG, options, baos);</span><br><span class="line">try &#123;  </span><br><span class="line">FileOutputStream fos = new FileOutputStream(file);  </span><br><span class="line">fos.write(baos.toByteArray());  </span><br><span class="line">fos.flush();  </span><br><span class="line">fos.close();  </span><br><span class="line">&#125; catch (Exception e) &#123;  </span><br><span class="line">e.printStackTrace();  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="å°ºå¯¸å‹ç¼©"><a href="#å°ºå¯¸å‹ç¼©" class="headerlink" title="å°ºå¯¸å‹ç¼©"></a>å°ºå¯¸å‹ç¼©</h1><p>é€šè¿‡ç¼©æ”¾å›¾ç‰‡åƒç´ æ¥å‡å°‘å›¾ç‰‡æ‰€å å†…å­˜ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public static void compressBitmapToFile(Bitmap bmp, File file)&#123;</span><br><span class="line">// å°ºå¯¸å‹ç¼©å€æ•°,å€¼è¶Šå¤§ï¼Œå›¾ç‰‡å°ºå¯¸è¶Šå°</span><br><span class="line">int ratio = 2;</span><br><span class="line">// å‹ç¼©Bitmapåˆ°å¯¹åº”å°ºå¯¸</span><br><span class="line">Bitmap result = Bitmap.createBitmap(bmp.getWidth() / ratio, bmp.getHeight() / ratio, Config.ARGB_8888);</span><br><span class="line">Canvas canvas = new Canvas(result);</span><br><span class="line">Rect rect = new Rect(0, 0, bmp.getWidth() / ratio, bmp.getHeight() / ratio);</span><br><span class="line">canvas.drawBitmap(bmp, null, rect, null);</span><br><span class="line"></span><br><span class="line">ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">// æŠŠå‹ç¼©åçš„æ•°æ®å­˜æ”¾åˆ°baosä¸­</span><br><span class="line">result.compress(Bitmap.CompressFormat.JPEG, 100 ,baos);</span><br><span class="line">try &#123;  </span><br><span class="line">FileOutputStream fos = new FileOutputStream(file);  </span><br><span class="line">fos.write(baos.toByteArray());  </span><br><span class="line">fos.flush();  </span><br><span class="line">fos.close();  </span><br><span class="line">&#125; catch (Exception e) &#123;  </span><br><span class="line">e.printStackTrace();  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è®¾ç½®å›¾ç‰‡é‡‡æ ·ç‡ï¼Œå‡å°‘å›¾ç‰‡åƒç´ ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public static void compressBitmap(String filePath, File file)&#123;</span><br><span class="line">// æ•°å€¼è¶Šé«˜ï¼Œå›¾ç‰‡åƒç´ è¶Šä½</span><br><span class="line">int inSampleSize = 2;</span><br><span class="line">BitmapFactory.Options options = new BitmapFactory.Options();</span><br><span class="line">//é‡‡æ ·ç‡</span><br><span class="line">options.inSampleSize = inSampleSize;</span><br><span class="line">Bitmap bitmap = BitmapFactory.decodeFile(filePath, options);  </span><br><span class="line">ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class="line">// æŠŠå‹ç¼©åçš„æ•°æ®å­˜æ”¾åˆ°baosä¸­</span><br><span class="line">bitmap.compress(Bitmap.CompressFormat.JPEG, 100 ,baos);</span><br><span class="line">try &#123;  </span><br><span class="line">FileOutputStream fos = new FileOutputStream(file);  </span><br><span class="line">fos.write(baos.toByteArray());  </span><br><span class="line">fos.flush();  </span><br><span class="line">fos.close();  </span><br><span class="line">&#125; catch (Exception e) &#123;  </span><br><span class="line">e.printStackTrace();  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>å°çŸ¥è¯†</strong><br>1ã€æ–‡ä»¶å¤§å°æ¢ç®—å…¬å¼ï¼š<br>1Byte=8bit<br>1KB=1024Byte(å­—èŠ‚)=8*1024bit<br>1MB=1024KB<br>1GB=1024MB<br>1TB=1024GB<br>2ã€å›¾åƒå ç”¨å†…å­˜ç©ºé—´çš„å¤§å°ï¼šåˆ†è¾¨ç‡ * ä½æ·± ï¼ 8<br>åˆ†è¾¨ç‡ï¼šå®½ * é«˜<br>ä½æ·±åº¦ï¼šæŒ‡å®šå›¾åƒä¸­çš„æ¯ä¸ªåƒç´ å¯ä»¥ä½¿ç”¨çš„é¢œè‰²ä¿¡æ¯æ•°é‡ã€‚<br>æ¯ä¸ªåƒç´ ä½¿ç”¨çš„ä¿¡æ¯ä½æ•°è¶Šå¤šï¼Œå¯ç”¨çš„é¢œè‰²å°±è¶Šå¤šï¼Œé¢œè‰²è¡¨ç°å°±æ›´é€¼çœŸã€‚<br>ä¾‹å¦‚ï¼š<br>ä¸€å¹…å›¾åƒåˆ†è¾¨ç‡ï¼š1024*768,24ä½ï¼Œåˆ™å…¶å¤§å°è®¡ç®—å¦‚ä¸‹ï¼š<br>å¤§å° = 1024 * 768 * 24 / 8 = 2359296 byte = 2304 KB</p></blockquote><h1 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h1><p>å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæ˜¯å°†å›¾ç‰‡çš„å°ºå¯¸å‹ç¼©åˆ°ä¸€å®šå¤§å°ï¼Œç„¶åé™ä½å›¾ç‰‡çš„è´¨é‡åˆ°ç‰¹å®šçš„å†…å­˜è¦æ±‚ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Bitmap obtainBitmap() &#123;</span><br><span class="line">Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.imag);</span><br><span class="line">Bitmap bg = Bitmap.createBitmap(bitmap.getWidth() / 2, bitmap.getHeight() / 2, Bitmap.Config.ARGB_8888);</span><br><span class="line">Canvas canvas = new Canvas(bg);</span><br><span class="line">Rect rect = new Rect(0, 0, bitmap.getWidth() / 2, bitmap.getHeight() / 2);</span><br><span class="line">canvas.drawBitmap(bitmap, null, rect, null);</span><br><span class="line">ByteArrayOutputStream outputStream = new ByteArrayOutputStream();</span><br><span class="line">int quality = 100;</span><br><span class="line">//ç›´åˆ°å›¾ç‰‡çš„å¤§å°å°äº100kb</span><br><span class="line">do &#123;</span><br><span class="line">outputStream.reset();</span><br><span class="line">bg.compress(Bitmap.CompressFormat.JPEG, quality, outputStream);</span><br><span class="line">quality = quality - 3;</span><br><span class="line">&#125; while (outputStream.toByteArray().length / 1024 &gt;= 100 &amp;&amp; quality &gt; 0);</span><br><span class="line">Bitmap result = BitmapFactory.decodeByteArray(outputStream.toByteArray(), 0, outputStream.size());</span><br><span class="line">return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://www.jianshu.com/p/e9e1db845c21" target="_blank" rel="noopener">Android å›¾ç‰‡å‹ç¼©ä¹‹å¤šç§å‹ç¼©æ–¹å¼ç»“åˆä½¿ç”¨</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ä»¬é€šå¸¸é‡‡ç”¨å¤šç§æ–¹å¼ç»“åˆçš„æ–¹æ³•å®ç°å›¾ç‰‡å‹ç¼©éœ€æ±‚ï¼Œè¿™äº›æ–¹å¼åŒ…æ‹¬è´¨é‡å‹ç¼©ã€å°ºå¯¸å‹ç¼©ã€‚æœ¬ç« å°†åˆ†åˆ«ä»‹ç»è¿™ä¸¤ç§æ–¹å¼ï¼Œå¹¶ä¸”æœ€åå°†ç»“åˆè¿™ä¸¤ç§æ–¹å¼å®ç°å›¾ç‰‡å‹ç¼©çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="Bitmap" scheme="http://yoursite.com/tags/Bitmap/"/>
    
  </entry>
  
  <entry>
    <title>Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥</title>
    <link href="http://yoursite.com/2018/01/20/Coordinatorlayout%E4%BD%BF%E7%94%A8%E5%85%A8%E6%94%BB%E7%95%A5/"/>
    <id>http://yoursite.com/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/</id>
    <published>2018-01-20T15:21:56.000Z</published>
    <updated>2018-05-12T11:41:13.639Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-è‡ªå®šä¹‰Behavior"><a href="#1-è‡ªå®šä¹‰Behavior" class="headerlink" title="1.è‡ªå®šä¹‰Behavior"></a>1.è‡ªå®šä¹‰Behavior</h2><h4 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h4><p>å…¶å®Behaviorå°±æ˜¯ä¸€ä¸ªåº”ç”¨äºViewçš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸€ä¸ªViewè·Ÿéšè€…å¦ä¸€ä¸ªViewçš„å˜åŒ–è€Œå˜åŒ–ï¼Œæˆ–è€…è¯´ä¸€ä¸ªViewç›‘å¬å¦ä¸€ä¸ªViewã€‚<br>åœ¨Behaviorä¸­ï¼Œè¢«è§‚å¯ŸViewä¹Ÿå°±æ˜¯äº‹ä»¶æºè¢«ç§°ä¸ºdenpendcyï¼Œè€Œè§‚å¯ŸViewï¼Œåˆ™è¢«ç§°ä¸ºchildã€‚<a id="more"></a><br><strong>Buttonä¸TextViewçš„çˆ±æ¨æƒ…ä»‡</strong><br>é¦–å…ˆåœ¨å¸ƒå±€æ–‡ä»¶ä¸­è·Ÿå¸ƒå±€è®¾ç½®ä¸ºCoordinatorLayoutï¼Œé‡Œé¢æ”¾ä¸€ä¸ªButtonå’Œä¸€ä¸ªTextViewã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;android.support.design.widget.CoordinatorLayout    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;TextView     </span><br><span class="line">app:layout_behavior=&quot;.EasyBehavior&quot;</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;è§‚å¯Ÿè€…View child&quot;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;Button     </span><br><span class="line">android:id=&quot;@+id/btn&quot;</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:layout_gravity=&quot;center&quot;</span><br><span class="line">android:text=&quot;è¢«è§‚å¯ŸView dependency&quot;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæˆ‘ä»¬åœ¨Activityä¸­åšä¸€äº›æ‰‹è„šï¼Œè®©ButtonåŠ¨èµ·æ¥(ä¸è¦åœ¨æ„åæ ‡è¿™äº›ç»†èŠ‚)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">super.onCreate(savedInstanceState);</span><br><span class="line">setContentView(R.layout.activity_easy_behavior);</span><br><span class="line">findViewById(R.id.btn).setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class="line">@Override public boolean onTouch(View v, MotionEvent event) &#123;        switch (event.getAction())&#123;          case MotionEvent.ACTION_MOVE:</span><br><span class="line">v.setX(event.getRawX()-v.getWidth()/2);</span><br><span class="line">v.setY(event.getRawY()-v.getHeight()/2);            break;</span><br><span class="line">&#125;        return false;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ­¤æ—¶ï¼ŒButtonå·²ç»å¯ä»¥è·Ÿéšæ‰‹æŒ‡ç§»åŠ¨äº†ã€‚<br>ç°åœ¨å»è‡ªå®šä¹‰ä¸€ä¸ªBehaviorè®©TextViewè·ŸéšButtonä¸€èµ·åŠ¨ï¼<br>åˆ›å»ºä¸€ä¸ªEasyBehaviorç±»ï¼Œç»§æ‰¿äºBehavior<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class EasyBehavior extends CoordinatorLayout.Behavior&lt;TextView&gt; &#123;//è¿™é‡Œçš„æ³›å‹æ˜¯childçš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…View</span><br><span class="line">public EasyBehavior(Context context, AttributeSet attrs) &#123;</span><br><span class="line">super(context, attrs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override  public boolean layoutDependsOn(CoordinatorLayout parent, TextView child, View dependency) &#123;    //å‘ŠçŸ¥ç›‘å¬çš„dependencyæ˜¯Button</span><br><span class="line">return dependency instanceof Button;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override  //å½“ dependency(Button)å˜åŒ–çš„æ—¶å€™ï¼Œå¯ä»¥å¯¹child(TextView)è¿›è¡Œæ“ä½œ</span><br><span class="line">public boolean onDependentViewChanged(CoordinatorLayout parent, TextView child, View dependency) &#123;</span><br><span class="line">child.setX(dependency.getX()+200);</span><br><span class="line">child.setY(dependency.getY()+200);</span><br><span class="line">child.setText(dependency.getX()+&quot;,&quot;+dependency.getY());    return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ä¸¤ä¸ªæ–¹æ³•<br>layoutDependsOn() ä»£è¡¨å¯»æ‰¾è¢«è§‚å¯ŸView<br>onDependentViewChanged() è¢«è§‚å¯ŸViewå˜åŒ–çš„æ—¶å€™å›è°ƒç”¨çš„æ–¹æ³•<br>åœ¨onDependentViewChangedä¸­ï¼Œæˆ‘ä»¬è®©TextViewè·ŸéšButtonçš„ç§»åŠ¨è€Œç§»åŠ¨ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œä¸€çœ‹å°±æ‡‚ã€‚<br><strong>Tip</strong><br>å¿…é¡»é‡å†™å¸¦åŒå‚çš„æ„é€ å™¨ï¼Œå› ä¸ºä»xmlåå°„éœ€è¦è°ƒç”¨ã€‚<br>æ¥ä¸‹æ¥ï¼Œåœ¨xmlä¸­ï¼Œç»™TextViewè®¾ç½®æˆ‘ä»¬çš„Behaviorã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView      </span><br><span class="line">app:layout_behavior=&quot;.EasyBehavior&quot;</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;è§‚å¯Ÿè€…View child&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/1.gif"></p><h2 id="2-CoordinatorLayoutä½¿ç”¨"><a href="#2-CoordinatorLayoutä½¿ç”¨" class="headerlink" title="2.CoordinatorLayoutä½¿ç”¨"></a>2.CoordinatorLayoutä½¿ç”¨</h2><p>CoordinatorLayoutæ˜¯è°·æ­Œæä¾›çš„Material Designè®¸å¤šåŠŸèƒ½çš„åŸºç¡€ï¼Œä½¿ç”¨å®ƒä½ å¯ä»¥è½»æ¾åœ°å®ç°è®¸å¤šåŠ¨ç”»æ•ˆæœã€‚è¿™äº›æ•ˆæœåŒ…æ‹¬ï¼š<br>1.æ»‘åŠ¨Floating Action Buttonä¸ºSnackBarçš„å¼¹èµ·æä¾›ç©ºé—´ã€‚<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/2.gif"><br>2.å±•å¼€æˆ–è€…æ”¶èµ·Toolbarä¸ºå±å¹•çš„ä¸»å†…å®¹æä¾›ç©ºé—´ã€‚<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/3.gif"><br>3.æ§åˆ¶æŸä¸ªåº”è¯¥è¢«æ”¶èµ·æˆ–å±•å¼€çš„Viewä»¥ä¸€å®šåœ°è§†å·®æ•ˆæœå®ŒæˆåŠ¨ä½œï¼ŒåŒ…æ‹¬parallax scrolling effects åŠ¨ç”»ã€‚<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/4.gif"></p><h4 id="Floating-Action-Buttons-å’Œ-Snackbars"><a href="#Floating-Action-Buttons-å’Œ-Snackbars" class="headerlink" title="Floating Action Buttons å’Œ Snackbars"></a>Floating Action Buttons å’Œ Snackbars</h4><p><code>FloatingActionButton</code>å¯ä»¥é€šè¿‡layout_anchorå’Œlayout_anchorGravityæ¥æ§åˆ¶æ˜¾ç¤ºçš„ä½ç½®ã€‚å½“æˆ‘ä»¬å°†å…¶æ˜¾ç¤ºåˆ°å±å¹•çš„åº•ç«¯æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å“åº”SnackBarçš„å¼¹èµ·æˆ–æ”¶èµ·ï¼šSnackBarå¼¹èµ·åFloatingActionButtonä¹Ÿå¼¹èµ·SnackBarçš„é«˜åº¦ï¼Œæ”¶èµ·åFloatingActionButtonä¹Ÿæ”¶èµ·ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.CoordinatorLayout</span><br><span class="line">android:id=&quot;@+id/main_content&quot;</span><br><span class="line">xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.RecyclerView</span><br><span class="line">android:id=&quot;@+id/rvToDoList&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.design.widget.FloatingActionButton</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:layout_gravity=&quot;bottom|right&quot;</span><br><span class="line">android:layout_margin=&quot;16dp&quot;</span><br><span class="line">android:src=&quot;@mipmap/ic_launcher&quot;</span><br><span class="line">app:layout_anchor=&quot;@id/rvToDoList&quot;</span><br><span class="line">app:layout_anchorGravity=&quot;bottom|right|end&quot;/&gt;</span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure></p><h4 id="Expanding-å’Œ-Collapsing-Toolbars"><a href="#Expanding-å’Œ-Collapsing-Toolbars" class="headerlink" title="Expanding å’Œ Collapsing Toolbars"></a>Expanding å’Œ Collapsing Toolbars</h4><p>1.ç¡®ä¿CoordinatorLayoutæ˜¯ä¸»å®¹å™¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.CoordinatorLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">android:id=&quot;@+id/main_content&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">android:fitsSystemWindows=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">app:popupTheme=&quot;@style/ThemeOverlay.AppCompat.Light&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.CoordinatorLayout&gt;</span><br></pre></td></tr></table></figure></p><p>2.ä¸ºäº†å“åº”æ»‘åŠ¨äº‹ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨AppBarLayout:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.AppBarLayout</span><br><span class="line">android:id=&quot;@+id/appbar&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;@dimen/detail_backdrop_height&quot;</span><br><span class="line">android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span><br><span class="line">android:fitsSystemWindows=&quot;true&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">app:popupTheme=&quot;@style/ThemeOverlay.AppCompat.Light&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.design.widget.AppBarLayout&gt;</span><br></pre></td></tr></table></figure></p><p>ä¸ºäº†è®©æ»‘åŠ¨çš„Viewå§‹ç»ˆåœ¨AppBarLayoutçš„ä¸‹é¢ï¼Œéœ€è¦ä¸ºæ»‘åŠ¨çš„Viewå®šä¹‰<code>layout_behavior</code>ä¸º@string/appbar_scrolling_view_behaviorã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>app:layout_scrollFlags</code>æ§åˆ¶AppBarLayoutä¸­çš„å­Viewå“åº”RecycleViewçš„æ»‘åŠ¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.AppBarLayout</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:fitsSystemWindows=&quot;true&quot;</span><br><span class="line">android:theme=&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;?attr/actionBarSize&quot;</span><br><span class="line">app:layout_scrollFlags=&quot;scroll|enterAlways&quot;/&gt;</span><br><span class="line">&lt;android.support.v7.widget.RecyclerView</span><br><span class="line">android:id=&quot;@+id/rvToDoList&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;/&gt;</span><br><span class="line">&lt;/android.support.design.widget.AppBarLayout&gt;</span><br></pre></td></tr></table></figure></p><p>å…³äºlayout_scrollFlagsçš„å€¼è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼š</p><ol><li>scroll - æƒ³æ»šåŠ¨å°±å¿…é¡»è®¾ç½®è¿™ä¸ªã€‚</li><li>enterAlways - å®ç°quick returnæ•ˆæœ, å½“å‘ä¸‹ç§»åŠ¨æ—¶ï¼Œç«‹å³æ˜¾ç¤ºViewï¼ˆæ¯”å¦‚Toolbar)ã€‚</li><li>exitUntilCollapsed - å‘ä¸Šæ»šåŠ¨æ—¶æ”¶ç¼©Viewï¼Œä½†å¯ä»¥å›ºå®šToolbarä¸€ç›´åœ¨ä¸Šé¢(å¯é€šè¿‡minHeightè®¾ç½®)ã€‚</li><li>enterAlwaysCollapsed - å½“ä½ çš„Viewå·²ç»è®¾ç½®minHeightå±æ€§åˆä½¿ç”¨æ­¤æ ‡å¿—æ—¶ï¼Œä½ çš„Viewåªèƒ½ä»¥æœ€å°é«˜åº¦è¿›å…¥ï¼Œåªæœ‰å½“æ»šåŠ¨è§†å›¾åˆ°è¾¾é¡¶éƒ¨æ—¶æ‰æ‰©å¤§åˆ°å®Œæ•´é«˜åº¦ã€‚</li><li>snap - å¦‚æœå¤´éƒ¨æ»‘åŠ¨æ“ä½œè¶…è¿‡50%çš„è·ç¦»ï¼Œåˆ™è‡ªåŠ¨å…³é—­ã€‚å¦‚æœå¤´éƒ¨æ»‘åŠ¨æ“ä½œä¸è¶…è¿‡50%çš„è·ç¦»ï¼Œåˆ™ä¸å…³é—­ã€‚</li></ol><h4 id="åˆ›å»ºæŠ˜å æ•ˆæœ"><a href="#åˆ›å»ºæŠ˜å æ•ˆæœ" class="headerlink" title="åˆ›å»ºæŠ˜å æ•ˆæœ"></a>åˆ›å»ºæŠ˜å æ•ˆæœ</h4><p>CollapsingToolbarLayoutä½œç”¨æ˜¯æä¾›äº†ä¸€ä¸ªå¯ä»¥æŠ˜å çš„Toolbarï¼Œå®ƒç»§æ‰¿è‡³FrameLayoutï¼Œç»™å®ƒè®¾ç½®layout_scrollFlagsï¼Œå®ƒå¯ä»¥æ§åˆ¶åŒ…å«åœ¨CollapsingToolbarLayoutä¸­çš„æ§ä»¶(å¦‚ï¼šImageViewã€Toolbar)åœ¨å“åº”layout_behavioräº‹ä»¶æ—¶ä½œå‡ºç›¸åº”çš„scrollFlagsæ»šåŠ¨äº‹ä»¶(ç§»é™¤å±å¹•æˆ–å›ºå®šåœ¨å±å¹•é¡¶ç«¯)ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.support.design.widget.AppBarLayout  </span><br><span class="line">android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">android:layout_height=&quot;256dp&quot;  </span><br><span class="line">android:fitsSystemWindows=&quot;true&quot;&gt;  </span><br><span class="line">&lt;android.support.design.widget.CollapsingToolbarLayout  </span><br><span class="line">android:id=&quot;@+id/collapsing_toolbar_layout&quot;  </span><br><span class="line">android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">android:layout_height=&quot;match_parent&quot;  </span><br><span class="line">app:contentScrim=&quot;#30469b&quot;  </span><br><span class="line">app:expandedTitleMarginStart=&quot;48dp&quot;  </span><br><span class="line">app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;&gt;  </span><br><span class="line"></span><br><span class="line">&lt;ImageView  </span><br><span class="line">android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">android:layout_height=&quot;match_parent&quot;  </span><br><span class="line">android:scaleType=&quot;centerCrop&quot;  </span><br><span class="line">android:src=&quot;@mipmap/bg&quot;  </span><br><span class="line">app:layout_collapseMode=&quot;parallax&quot;  </span><br><span class="line">app:layout_collapseParallaxMultiplier=&quot;0.7&quot;  /&gt;  </span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.Toolbar  </span><br><span class="line">android:id=&quot;@+id/toolbar&quot;  </span><br><span class="line">android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">android:layout_height=&quot;?attr/actionBarSize&quot;  </span><br><span class="line">app:layout_collapseMode=&quot;pin&quot; /&gt;  </span><br><span class="line">&lt;/android.support.design.widget.CollapsingToolbarLayout&gt;  </span><br><span class="line">&lt;android.support.v7.widget.RecyclerView  </span><br><span class="line">android:id=&quot;@+id/recyclerView&quot;  </span><br><span class="line">android:layout_width=&quot;match_parent&quot;  </span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">app:layout_behavior=&quot;@string/appbar_scrolling_view_behavior&quot;</span><br><span class="line">android:scrollbars=&quot;none&quot; /&gt;  </span><br><span class="line">&lt;/android.support.design.widget.AppBarLayout&gt;</span><br></pre></td></tr></table></figure></p><p>1ã€åœ¨CollapsingToolbarLayoutä¸­è®¾ç½®äº†ä¸€ä¸ªImageViewå’Œä¸€ä¸ªToolbarã€‚å¹¶æŠŠè¿™ä¸ªCollapsingToolbarLayoutæ”¾åˆ°AppBarLayoutä¸­ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚<br>åœ¨CollapsingToolbarLayoutä¸­ï¼Œæˆ‘ä»¬é™¤äº†è®¾ç½®layout_scrollFlagsï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸€äº›å…¶å®ƒçš„å±æ€§ï¼Œç®€è¦è¯´æ˜ä¸€ä¸‹ï¼š</p><ul><li>contentScrim - è®¾ç½®å½“å®Œå…¨CollapsingToolbarLayoutæŠ˜å (æ”¶ç¼©)åçš„èƒŒæ™¯é¢œè‰²ã€‚</li><li>expandedTitleMarginStart - è®¾ç½®æ‰©å¼ æ—¶å€™(è¿˜æ²¡æœ‰æ”¶ç¼©æ—¶)titleå‘å·¦å¡«å……çš„è·ç¦»ã€‚</li></ul><p>æ²¡æ‰©å¼ æ—¶å€™å¦‚å›¾ï¼š<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/5.png"><br>2ã€åœ¨ImageViewæ§ä»¶ä¸­ï¼š<br>æˆ‘ä»¬è®¾ç½®äº†layout_collapseMode (æŠ˜å æ¨¡å¼) - æœ‰ä¸¤ä¸ªå€¼:</p><ul><li>pin -  è®¾ç½®ä¸ºè¿™ä¸ªæ¨¡å¼æ—¶ï¼Œå½“CollapsingToolbarLayoutå®Œå…¨æ”¶ç¼©åï¼ŒToolbarè¿˜å¯ä»¥ä¿ç•™åœ¨å±å¹•ä¸Šã€‚</li><li>parallax - è®¾ç½®ä¸ºè¿™ä¸ªæ¨¡å¼æ—¶ï¼Œåœ¨å†…å®¹æ»šåŠ¨æ—¶ï¼ŒCollapsingToolbarLayoutä¸­çš„Viewï¼ˆæ¯”å¦‚ImageView)ä¹Ÿå¯ä»¥åŒæ—¶æ»šåŠ¨ï¼Œå®ç°è§†å·®æ»šåŠ¨æ•ˆæœï¼Œé€šå¸¸å’Œlayout_collapseParallaxMultiplier(è®¾ç½®è§†å·®å› å­)æ­é…ä½¿ç”¨ã€‚</li><li>layout_collapseParallaxMultiplier(è§†å·®å› å­) - è®¾ç½®è§†å·®æ»šåŠ¨å› å­ï¼Œå€¼ä¸ºï¼š0~1ã€‚</li></ul><p>3ã€åœ¨Toolbaræ§ä»¶ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº†layout_collapseMode(æŠ˜å æ¨¡å¼)ä¸ºpinã€‚<br>æ•ˆæœå¦‚å›¾:<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/6.gif"><br>ç»¼ä¸Šåˆ†æï¼šå½“è®¾ç½®äº†layout_behaviorçš„æ§ä»¶å“åº”èµ·äº†CollapsingToolbarLayoutä¸­çš„layout_scrollFlagsäº‹ä»¶æ—¶ï¼ŒImageViewä¼šæœ‰è§†å·®æ•ˆæœçš„å‘ä¸Šæ»šåŠ¨ç§»é™¤å±å¹•ï¼Œå½“å¼€å§‹æŠ˜å æ—¶CollapsingToolbarLayoutçš„èƒŒæ™¯è‰²(ä¹Ÿå°±æ˜¯Toolbarçš„èƒŒæ™¯è‰²)å°±ä¼šå˜ä¸ºæˆ‘ä»¬è®¾ç½®å¥½çš„èƒŒæ™¯è‰²ï¼ŒToolbarä¹Ÿä¸€ç›´ä¼šå›ºå®šåœ¨æœ€é¡¶ç«¯ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>ä½¿ç”¨CollapsingToolbarLayoutæ—¶å¿…é¡»æŠŠtitleè®¾ç½®åˆ°CollapsingToolbarLayoutä¸Šï¼Œè®¾ç½®åˆ°Toolbarä¸Šä¸ä¼šæ˜¾ç¤ºã€‚å³ï¼šmCollapsingToolbarLayout.setTitle(â€œ â€œ);</p></blockquote><h4 id="Bottom-Sheet"><a href="#Bottom-Sheet" class="headerlink" title="Bottom Sheet"></a>Bottom Sheet</h4><p>æœ‰ä¸¤ç§ç±»å‹çš„<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2017/0327/7729.html" target="_blank" rel="noopener">Bottom Sheet</a>ï¼š<br>1.<strong>Persistent bottom sheet :</strong>é€šå¸¸ç”¨äºæ˜¾ç¤ºä¸»ç•Œé¢ä¹‹å¤–çš„é¢å¤–ä¿¡æ¯ï¼Œå®ƒæ˜¯ä¸»ç•Œé¢çš„ä¸€éƒ¨åˆ†ï¼Œåªä¸è¿‡é»˜è®¤è¢«éšè—äº†ï¼Œå…¶æ·±åº¦ï¼ˆelevationï¼‰è·Ÿä¸»ç•Œé¢å¤„äºåŒä¸€çº§åˆ«ï¼›è¿˜æœ‰ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯åœ¨Persistent bottom sheetæ‰“å¼€çš„æ—¶å€™ï¼Œä¸»ç•Œé¢ä»ç„¶æ˜¯å¯ä»¥æ“ä½œçš„ã€‚psï¼šPersistent bottom sheetè¯¥å¦‚ä½•ç¿»è¯‘å‘¢ï¼Ÿæˆ‘è§‰å¾—ç¿»è¯‘ä¸ºæ™®é€šbottom sheetå°±å¥½äº†ï¼Œè¿˜çœ‹åˆ°æœ‰äººç¿»è¯‘ä¸ºâ€œå¸¸é©»bottom sheetâ€ï¼Œå¯èƒ½æ›´æ¥è¿‘äºè‹±è¯­çš„å­—é¢æ„æ€ï¼Œå¯æ˜¯åè€Œä¸æ˜“ç†è§£ã€‚<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/7.png"><br>2.<strong>æ¨¡æ€bottom sheet :</strong>é¡¾åæ€ä¹‰ï¼Œæ¨¡æ€çš„bottom sheetåœ¨æ‰“å¼€çš„æ—¶å€™ä¼šé˜»æ­¢å’Œä¸»ç•Œé¢çš„äº¤äº’ï¼Œå¹¶ä¸”åœ¨è§†è§‰ä¸Šä¼šåœ¨bottom sheetèƒŒååŠ ä¸€å±‚åŠé€æ˜çš„é˜´å½±ï¼Œä½¿å¾—çœ‹ä¸Šå»æ·±åº¦ï¼ˆelevationï¼‰æ›´æ·±ã€‚<br>æ€»ç»“èµ·æ¥è¿™ä¸¤ç§Bottom Sheetçš„åŒºåˆ«ä¸»è¦åœ¨äºè§†è§‰å’Œäº¤äº’ä¸Šï¼Œå½“ç„¶ä½¿ç”¨æ–¹æ³•ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚<br><img src="/2018/01/20/Coordinatorlayoutä½¿ç”¨å…¨æ”»ç•¥/8.png"></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://guides.codepath.com/android/Handling-Scrolls-with-CoordinatorLayout#troubleshooting-coordinated-layouts" target="_blank" rel="noopener">CoordinatorLayoutä»‹ç»</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-è‡ªå®šä¹‰Behavior&quot;&gt;&lt;a href=&quot;#1-è‡ªå®šä¹‰Behavior&quot; class=&quot;headerlink&quot; title=&quot;1.è‡ªå®šä¹‰Behavior&quot;&gt;&lt;/a&gt;1.è‡ªå®šä¹‰Behavior&lt;/h2&gt;&lt;h4 id=&quot;åŸºç¡€æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#åŸºç¡€æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€æ¦‚å¿µ&quot;&gt;&lt;/a&gt;åŸºç¡€æ¦‚å¿µ&lt;/h4&gt;&lt;p&gt;å…¶å®Behaviorå°±æ˜¯ä¸€ä¸ªåº”ç”¨äºViewçš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸€ä¸ªViewè·Ÿéšè€…å¦ä¸€ä¸ªViewçš„å˜åŒ–è€Œå˜åŒ–ï¼Œæˆ–è€…è¯´ä¸€ä¸ªViewç›‘å¬å¦ä¸€ä¸ªViewã€‚&lt;br&gt;åœ¨Behaviorä¸­ï¼Œè¢«è§‚å¯ŸViewä¹Ÿå°±æ˜¯äº‹ä»¶æºè¢«ç§°ä¸ºdenpendcyï¼Œè€Œè§‚å¯ŸViewï¼Œåˆ™è¢«ç§°ä¸ºchildã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="Coordinatorlayout" scheme="http://yoursite.com/tags/Coordinatorlayout/"/>
    
  </entry>
  
  <entry>
    <title>MD5åŠ å¯†ç®—æ³•</title>
    <link href="http://yoursite.com/2017/12/20/MD5%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
    <id>http://yoursite.com/2017/12/20/MD5åŠ å¯†ç®—æ³•/</id>
    <published>2017-12-20T09:19:02.000Z</published>
    <updated>2018-03-07T09:25:59.223Z</updated>
    
    <content type="html"><![CDATA[<p>MD5(Message-Digest Algorithm 5,ä¿¡æ¯-æ‘˜è¦ç®—æ³•5)ç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ï¼Œæ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ï¼Œå“ˆå¸Œç®—æ³•ï¼‰ã€‚MD5ç®—æ³•å°†æ•°æ®ï¼ˆå¦‚æ±‰å­—ï¼‰è¿ç®—æˆå¦ä¸€å›ºå®šé•¿åº¦å€¼ï¼ŒMD5çš„å‰ç”Ÿæœ‰MD2ï¼ŒMD3å’ŒMD4ã€‚<a id="more"></a><br>MD5ç®—æ³•å…·æœ‰å¦‚ä¸‹ç‰¹å¾ï¼š<br>1ã€å‹ç¼©æ€§ï¼šä»»æ„é•¿åº¦çš„æ•°æ®ç®—å‡ºçš„MD5å€¼æ˜¯å›ºå®šçš„ï¼Œå³128 ä½å›ºå®šé•¿åº¦çš„æ•£åˆ—å€¼ã€‚<br>2ã€å®¹æ˜“è®¡ç®—ï¼šä»åŸæ•°æ®å¾ˆå®¹æ˜“ç®—å‡ºMD5å€¼ã€‚<br>3ã€æŠ—ä¿®æ”¹æ€§ï¼šå¯¹åŸæ•°æ®ä»»ä½•ä¸€ä¸ªç»†å¾®çš„æ”¹åŠ¨ï¼Œæ‰€å¾—åˆ°çš„MD5å€¼éƒ½ä¼šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚<br>4ã€å¼ºæŠ—ç¢°æ’ï¼šMD5 ä½¿ç”¨çš„æ˜¯æ•£åˆ—å‡½æ•°ï¼ˆä¹Ÿç§°å“ˆå¸Œå‡½æ•°ï¼‰ï¼Œä¸€å®šæ¦‚ç‡ä¸Šä¹Ÿå­˜åœ¨å“ˆå¸Œå†²çªï¼ˆä¹Ÿç§°å“ˆå¸Œç¢°æ’ï¼‰ï¼Œå³å¤šä¸ªä¸åŒçš„åŸæ•°æ®å¯¹åº”ä¸€ä¸ªç›¸åŒçš„ MD5 å€¼ã€‚ä¸è¿‡ï¼Œç»è¿‡ MD4ã€MD3 ç­‰å‡ ä»£ç®—æ³•çš„ä¼˜åŒ–ï¼ŒMD5 å·²ç»å……åˆ†åˆ©ç”¨æ•£åˆ—çš„åˆ†æ•£æ€§é«˜åº¦é¿å…ç¢°æ’çš„å‘ç”Ÿã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼ŒMD5 æ˜¯ä¸€ç§ä¸å¯é€†çš„ç®—æ³•ï¼Œä¹Ÿå°±è¯´ï¼Œä½ æ— æ³•é€šè¿‡å¾—åˆ°çš„ MD5 å€¼é€†å‘ç®—å‡ºåŸæ•°æ®å†…å®¹ã€‚æ­£æ˜¯å‡­å€Ÿè¿™äº›ç‰¹ç‚¹ï¼ŒMD5 è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p><h1 id="MD5çš„ä½¿ç”¨åœºæ™¯"><a href="#MD5çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="MD5çš„ä½¿ç”¨åœºæ™¯"></a>MD5çš„ä½¿ç”¨åœºæ™¯</h1><h4 id="åœºæ™¯ä¸€"><a href="#åœºæ™¯ä¸€" class="headerlink" title="åœºæ™¯ä¸€"></a>åœºæ™¯ä¸€</h4><p>å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„ HTTP é€šä¿¡ï¼Œé€šä¿¡åŒæ–¹å¯ä»¥å°†æŠ¥æ–‡å†…å®¹åšä¸€ä¸ª MD5 è®¡ç®—ï¼Œå¹¶å°†è®¡ç®—æ‰€å¾— MD5 å€¼ä¸€å¹¶ä¼ é€’ç»™å½¼æ­¤ï¼Œè¿™æ ·ï¼Œæ¥æ”¶æ–¹å¯ä»¥é€šè¿‡å¯¹æŠ¥æ–‡å†…å®¹å†æ¬¡åš MD5 è®¡ç®—å¾—åˆ°ä¸€ä¸ª MD5 å€¼ï¼Œä¸ä¼ é€’æŠ¥æ–‡ä¸­çš„ MD5 å€¼åšæ¯”è¾ƒï¼ŒéªŒè¯æ•°æ®æ˜¯å¦å®Œæ•´ï¼Œæˆ–è€…æ˜¯å¦ä¸­é€”è¢«æ‹¦æˆªç¯¡æ”¹è¿‡ã€‚</p><h4 id="åœºæ™¯äºŒ"><a href="#åœºæ™¯äºŒ" class="headerlink" title="åœºæ™¯äºŒ"></a>åœºæ™¯äºŒ</h4><p>ç½‘ç»œäº‘ç›˜ä¸­çš„æ–‡ä»¶ç§’ä¼ åŠŸèƒ½ä¹Ÿè¿ç”¨åˆ° MD5 ç®—æ³•ã€‚æœåŠ¡å™¨å­˜å‚¨æ–‡ä»¶çš„æ—¶å€™ï¼ŒåŒæ—¶è®°å½•æ¯ä¸€ä¸ªæ–‡ä»¶çš„ MD5 å€¼ï¼Œä¸åŒæ–‡ä»¶å¯¹åº”ç€ä¸åŒçš„ MD5 å€¼ã€‚è¿™æ ·ï¼Œé‡åˆ°ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå°†ä¸Šä¼ æ–‡ä»¶çš„ MD5 å€¼ä¸æœåŠ¡å™¨ä¸Šæ‰€æœ‰å­˜å‚¨çš„ MD5 å€¼åšæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒï¼Œåˆ™è¯´æ˜ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å·²ç»åœ¨æœåŠ¡å™¨å­˜æœ‰ã€‚è¿™æ ·ï¼Œåªéœ€è¦åœ¨æ•°æ®åº“è¡¨ä¸­æ·»åŠ ä¸€ä¸ªè®°å½•ï¼Œæ˜ å°„åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼Œè€Œä¸ç”¨é‡å¤ä¸Šä¼ ï¼Œå®ç°æ‰€è°“ç§’ä¼ çš„åŠŸèƒ½ã€‚</p><blockquote><p>æ³¨æ„ï¼šä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼ŒMD5  å¹¶ä¸å±äºåŠ å¯†ç®—æ³•ï¼Œä¹Ÿä¸å±äºç­¾åç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç§æ‘˜è¦ç®—æ³•ï¼Œç”¨äºæ•°æ®å®Œæ•´æ€§æ ¡éªŒç­‰ã€‚</p></blockquote><h1 id="Java-è¯­è¨€ä¸­è®¡ç®—-MD5-å€¼çš„å®ç°æ–¹å¼"><a href="#Java-è¯­è¨€ä¸­è®¡ç®—-MD5-å€¼çš„å®ç°æ–¹å¼" class="headerlink" title="Java è¯­è¨€ä¸­è®¡ç®— MD5 å€¼çš„å®ç°æ–¹å¼"></a>Java è¯­è¨€ä¸­è®¡ç®— MD5 å€¼çš„å®ç°æ–¹å¼</h1><p><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œè·å– MessageDigest å¯¹è±¡ï¼Œå‚æ•°ä¸º MD5 å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª MD5 ç®—æ³•ï¼ˆå…¶ä»–è¿˜æœ‰ SHA1 ç®—æ³•ç­‰ï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;);</span><br></pre></td></tr></table></figure></p><p><strong>ç¬¬äºŒæ­¥</strong>ï¼Œè¾“å…¥åŸæ•°æ®ï¼Œå‚æ•°ç±»å‹ä¸º byte[] ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5.update(buffer);</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šupdate() æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼ StringBuilder å¯¹è±¡çš„ append() æ–¹æ³•ï¼Œé‡‡ç”¨çš„æ˜¯è¿½åŠ æ¨¡å¼ï¼Œå±äºä¸€ä¸ªç´¯è®¡æ›´æ”¹çš„è¿‡ç¨‹ï¼Œæ¯”å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">md5.update(new byte[]&#123;&apos;a&apos;, &apos;b&apos;&#125;);</span><br><span class="line">md5.update(new byte[]&#123;&apos;c&apos;, &apos;d&apos;&#125;);</span><br></pre></td></tr></table></figure></p><p>ä¸<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5.update(new byte[]&#123;&apos;a&apos;,&apos;b&apos;,&apos;c&apos;, &apos;d&apos;&#125;);</span><br></pre></td></tr></table></figure></p><p>æ˜¯ç­‰æ•ˆçš„ã€‚<br><strong>ç¬¬ä¸‰æ­¥</strong>ï¼Œè®¡ç®— MD5 å€¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String resultArray = md5.digest();</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šdigest() æ–¹æ³•è¢«è°ƒç”¨åï¼ŒMessageDigest å¯¹è±¡å°±è¢«é‡ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¸èƒ½ç´§æ¥ç€å†æ¬¡è°ƒç”¨è¯¥æ–¹æ³•è®¡ç®—åŸæ•°æ®çš„ MD5 å€¼ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ reset() æ–¹æ³•é‡ç½®è¾“å…¥æºã€‚<br>digest() æ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„ç±»å‹çš„ 16 ä½é•¿åº¦çš„å“ˆå¸Œå€¼ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬ä¼šè½¬åŒ–ä¸ºåå…­è¿›åˆ¶çš„ 32 ä½é•¿åº¦çš„å­—ç¬¦ä¸²æ¥ä½¿ç”¨ï¼Œå¯ä»¥åˆ©ç”¨ <a href="https://www.jianshu.com/p/8b89ab19db84" target="_blank" rel="noopener">BigInteger</a> ç±»æ¥åšè¿™ä¸ªè½¬åŒ–ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BigInteger bigInt = new BigInteger(1, resultArray);</span><br><span class="line">String resultStr = bigInt.toString(16);</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡è¿™å±‚è½¬æ¢ï¼Œå¾—åˆ°çš„ MD5 å€¼ä¾¿æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 32 ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œç±»ä¼¼è¿™æ ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">15aa7ec97a6288e46ae865a7211eb4eb</span><br></pre></td></tr></table></figure></p><p>æœ‰äº†ä¸Šé¢çš„åŸºç¡€æˆ‘ä»¬å†æ¥çœ‹å¦‚ä½•å°†ä¸€ä¸ªæ–‡ä»¶é€šè¿‡MD5åŠ å¯†è½¬åŒ–æˆ32ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public static String fileToMD5(String filePath) &#123;</span><br><span class="line">String md5 = null;</span><br><span class="line">MessageDigest digest = null;</span><br><span class="line">try &#123;</span><br><span class="line">digest = MessageDigest.getInstance(&quot;MD5&quot;);</span><br><span class="line">FileInputStream inputStream = new FileInputStream(filePath);</span><br><span class="line">byte[] b = new byte[1024];</span><br><span class="line">int len = -1;</span><br><span class="line">while ((len = inputStream.read(b)) != -1) &#123;</span><br><span class="line">digest.update(b, 0, len);</span><br><span class="line">&#125;</span><br><span class="line">byte[] bytes = digest.digest();</span><br><span class="line">BigInteger bigInteger = new BigInteger(1, bytes);</span><br><span class="line">md5 = bigInteger.toString(16);</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">return md5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šæ–‡ä»¶çš„å¤§å°ç›´æ¥å½±å“å­—èŠ‚æµçš„è¯»å–é€Ÿåº¦ï¼Œé—´æ¥å½±å“è¿™é‡Œ MD5 çš„è®¡ç®—æ—¶é•¿ã€‚Java è¯­è¨€æä¾›æœ‰å¤šç§æ–¹å¼è¯»å–æ–‡ä»¶ï¼Œé™¤äº†ä¸Šé¢ç”¨åˆ°çš„ FileInputStream è¿™ç§é¡ºåºè¯»å–çš„ API ç±»ï¼Œè¿˜æœ‰é‡‡ç”¨éšæœºè¯»å–æ–¹å¼çš„ RandomAccessFile ç±»ç­‰ã€‚å¯¹äºæ–‡ä»¶è¯»å–çš„æ•ˆç‡é—®é¢˜ï¼Œç ”ç©¶ä¹‹åå†ä½œä»‹ç»ã€‚</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="http://yifeng.studio/2017/06/13/md5-profile-and-implementation-in-java/" target="_blank" rel="noopener">MD5 ç®€ä»‹ï¼ŒåŠå…¶åœ¨ Java ä¸­çš„å®ç°æ–¹å¼</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MD5(Message-Digest Algorithm 5,ä¿¡æ¯-æ‘˜è¦ç®—æ³•5)ç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ï¼Œæ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ï¼Œå“ˆå¸Œç®—æ³•ï¼‰ã€‚MD5ç®—æ³•å°†æ•°æ®ï¼ˆå¦‚æ±‰å­—ï¼‰è¿ç®—æˆå¦ä¸€å›ºå®šé•¿åº¦å€¼ï¼ŒMD5çš„å‰ç”Ÿæœ‰MD2ï¼ŒMD3å’ŒMD4ã€‚
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="MD5" scheme="http://yoursite.com/tags/MD5/"/>
    
  </entry>
  
  <entry>
    <title>Gitä½¿ç”¨è§„åˆ™è¡¥å……</title>
    <link href="http://yoursite.com/2017/12/16/Git%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99%E8%A1%A5%E5%85%85/"/>
    <id>http://yoursite.com/2017/12/16/Gitä½¿ç”¨è§„åˆ™è¡¥å……/</id>
    <published>2017-12-16T01:57:26.000Z</published>
    <updated>2018-05-12T11:45:22.305Z</updated>
    
    <content type="html"><![CDATA[<p>å­¦ä¹ çš„gitçš„åŒå­¦æƒ³å¿…çœ‹è¿‡äº†<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">å»–é›ªå³°è€å¸ˆçš„Gitæ•™ç¨‹</a>ï¼Œç¬”è€…åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä¹Ÿæ·±å—è¿™ç¯‡æ–‡ç« çš„å¯å‘ã€‚ä½†æ˜¯åœ¨å­¦ä¹ æˆ–ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œç¬”è€…ä¹Ÿé‡åˆ°äº†ä¸€äº›æ¯”è¾ƒå®é™…çš„ä½†æ˜¯å»–è€å¸ˆæ²¡æœ‰æåˆ°æˆ–è€…åªæ˜¯ä¸€ç¬”å¸¦è¿‡çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å°±æŠŠè¿™äº›é—®é¢˜çš„è§£å†³åŠæ³•è®°å½•ä¸€ä¸‹å§ï½<a id="more"></a><br><strong>1.å¦‚ä½•æ–¹ä¾¿çš„ä½¿ç”¨ä¸€å°æœºå™¨å‘ä¸åŒçš„è¿œç«¯ä»“åº“ï¼ˆå¦‚ï¼šgithubï¼‰æäº¤ä»£ç ?</strong><br>æˆ‘ä»¬çŸ¥é“åœ¨å¾€githubçš„æŸä¸€ä¸ªä»“åº“æäº¤ä»£ç æ—¶ï¼Œéœ€è¦åœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ªSSH Keyï¼Œç„¶åå°†å…¶æ·»åŠ åˆ°githubä¸­ï¼Œå¦‚ä¸‹ã€‚<br><img src="/2017/12/16/Gitä½¿ç”¨è§„åˆ™è¡¥å……/Jietu20180512-194316.jpg"><br>ä½†æ˜¯ç°åœ¨éœ€è¦ä¸ºgithubä¸­çš„å¦å¤–ä¸€ä¸ªåº“æ·»åŠ SSH keyï¼Œç†æ‰€å½“ç„¶åœ°ï¼Œæˆ‘ä»¬è¦å†æ¬¡åœ¨æœ¬åœ°ç”Ÿæˆä¸€ä¸ªSSH keyï¼Œå‘½ä»¤å¦‚ä¸‹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;youremail@yourcompany.com&quot;</span><br></pre></td></tr></table></figure></p><p>è‹¥ä¸€è·¯å›è½¦ï¼ˆå¯†ç å¯ä»¥ä¸å†™ï¼‰ï¼Œè¿™æ ·ä¼šè¦†ç›–~/.ssh/ ç›®å½•ä¸‹ç”Ÿæˆ id_rsa å’Œ id_rsa.pub ä¸¤ä¸ªæ–‡ä»¶ã€‚ä¸ºäº†åŒºåˆ†ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªå›è½¦åè®¾ç½®è·¯å¾„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa):~/.ssh/æ–‡ä»¶å</span><br></pre></td></tr></table></figure></p><p>ç”±æ­¤æˆ‘ä»¬åˆ†åˆ«ä¸ºgithubä¸­çš„ä¸¤ä¸ªåº“ï¼ˆAåº“å’ŒBåº“ï¼‰ç”Ÿæˆå¯¹åº”çš„å…¬é’¥å’Œç§é’¥ï¼Œå®Œæˆåçš„ç›®å½•ï¼š<br>id_rsa<br>id_rsa.pub<br>id_sub<br>id_sub.pub<br>ä¹‹åæˆ‘ä»¬å°†æ–°ç”Ÿæˆçš„SSH keyè®¾ç½®ç»™Båº“ï¼Œæ­¤æ—¶ï¼Œç†æ‰€å½“ç„¶åœ°æˆ‘ä»¬å¼€å§‹å¾€Båº“ä¸­æäº¤ä»£ç ï¼Œä½†æ˜¯äº‹å®æ²¡æœ‰é‚£ä¹ˆç¾å¥½ï¼Œ<strong>æç¤ºï¼šæ²¡æœ‰æƒé™ã€‚</strong>å¦‚ä½•è§£å†³å‘¢ï¼Ÿ<br>1ã€ é¦–å…ˆæŸ¥çœ‹ä»£ç†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -l</span><br></pre></td></tr></table></figure></p><p>è‹¥æç¤º<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not open a connection to your authentication agent.</span><br></pre></td></tr></table></figure></p><p>åˆ™ç³»ç»Ÿä»£ç†é‡Œæ²¡æœ‰ä»»ä½•keyï¼Œæ‰§è¡Œå¦‚ä¸‹æ“ä½œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec ssh-agent bash</span><br></pre></td></tr></table></figure></p><p>è‹¥ç³»ç»Ÿå·²ç»æœ‰ssh-key ä»£ç† ,å¯ä»¥åˆ é™¤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -D</span><br></pre></td></tr></table></figure></p><p>2.æ·»åŠ ç§é’¥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-add ~/.ssh/id_rsa  </span><br><span class="line">ssh-add ~/.ssh/id_sub</span><br></pre></td></tr></table></figure></p><p>3.æ·»åŠ å…¬é’¥<br>åœ¨githubå¯¹åº”çš„ç®¡ç†é¡µé¢ï¼Œæ·»åŠ å¯¹åº”çš„å…¬é’¥ï¼ˆ.pub æ–‡ä»¶å†…å®¹ï¼‰ï¼Œä¿å­˜åˆ°ä»£ç ç®¡ç†æœåŠ¡å™¨ã€‚<br>4.æ·»åŠ å’Œç¼–è¾‘é…ç½®æ–‡ä»¶config<br>åœ¨ ~/.ssh ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªconfigæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch ~/.ssh/config</span><br></pre></td></tr></table></figure></p><p>æ·»åŠ å†…å®¹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># github  </span><br><span class="line">Host github.com  </span><br><span class="line">HostName github.com  </span><br><span class="line">PreferredAuthentications publickey  </span><br><span class="line"># IdentityFile ~/.ssh/id_sub</span><br><span class="line">IdentityFile ~/.ssh/id_rsa  </span><br><span class="line">user git</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„åˆ°ç¬¬äº”ã€å…­è¡Œ,å¦‚æœæˆ‘ä»¬éœ€è¦å¾€å¯¹åº”çš„è¿œç«¯ç‰ˆæœ¬åº“ä¸­æäº¤ä»£ç ï¼Œé‚£ä¹ˆå®šä¹‰ç›¸åº”çš„IdentityFileè¡Œå³å¯ã€‚ä½†æ˜¯ï¼ŒåŒä¸€ä¸ªæ—¶é—´åªèƒ½é…ç½®ä¸€ä¸ªIdentityFileï¼Œåˆ‡æ¢çš„æ—¶å€™åªéœ€æ›´æ¢IdentityFileå³å¯ã€‚<br><strong>2.å¦‚ä½•ä¿®æ”¹commitçš„å¤‡æ³¨ï¼Ÿ</strong><br>è¯•æƒ³ä½ åœ¨è°ƒç”¨<code>git commit -m &quot;å¤‡æ³¨&quot;</code>åï¼Œå¦‚æœçªç„¶åæ‚”äº†ï¼Œæƒ³é‡æ–°ä¿®æ”¹commitçš„å¤‡æ³¨è¯­ï¼Œå¯ä»¥è°ƒç”¨<code>git commit â€”amend</code>,ä¹‹åå¯ä»¥åœ¨viç¼–è¾‘å™¨ä¸­é‡æ–°ç¼–è¾‘æˆ‘ä»¬çš„å¤‡æ³¨äº†ã€‚<br><strong>3.Gitå¿½ç•¥è§„åˆ™åŠ.gitignoreè§„åˆ™ä¸ç”Ÿæ•ˆçš„è§£å†³åŠæ³•</strong><br>åœ¨gitä¸­å¦‚æœæƒ³å¿½ç•¥æ‰æŸä¸ªæ–‡ä»¶ï¼Œä¸è®©è¿™ä¸ªæ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¿®æ”¹æ ¹ç›®å½•ä¸­ .gitignore æ–‡ä»¶çš„æ–¹æ³•ï¼ˆå¦‚æ— ï¼Œåˆ™éœ€è‡ªå·±æ‰‹å·¥å»ºç«‹æ­¤æ–‡ä»¶ï¼‰ã€‚è¿™ä¸ªæ–‡ä»¶æ¯ä¸€è¡Œä¿å­˜äº†ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤ä¸ºæ³¨é‡Š â€“ å°†è¢« Git å¿½ç•¥</span><br><span class="line"></span><br><span class="line">*.a       # å¿½ç•¥æ‰€æœ‰ .a ç»“å°¾çš„æ–‡ä»¶</span><br><span class="line">!lib.a    # ä½† lib.a é™¤å¤–</span><br><span class="line">/TODO     # ä»…ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ subdir/TODO</span><br><span class="line">build/    # å¿½ç•¥ build/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><br><span class="line">doc/*.txt # ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txt</span><br></pre></td></tr></table></figure></p><p>è§„åˆ™å¾ˆç®€å•ï¼Œä¸åšè¿‡å¤šè§£é‡Šï¼Œä½†æ˜¯æœ‰æ—¶å€™åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œçªç„¶å¿ƒè¡€æ¥æ½®æƒ³æŠŠæŸäº›ç›®å½•æˆ–æ–‡ä»¶åŠ å…¥å¿½ç•¥è§„åˆ™ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹æ³•å®šä¹‰åå‘ç°å¹¶æœªç”Ÿæ•ˆï¼ŒåŸå› æ˜¯.gitignoreåªèƒ½å¿½ç•¥é‚£äº›åŸæ¥æ²¡æœ‰è¢«trackçš„æ–‡ä»¶ï¼Œå¦‚æœæŸäº›æ–‡ä»¶å·²ç»è¢«çº³å…¥äº†ç‰ˆæœ¬ç®¡ç†ä¸­ï¼Œåˆ™ä¿®æ”¹.gitignoreæ˜¯æ— æ•ˆçš„ã€‚é‚£ä¹ˆè§£å†³æ–¹æ³•å°±æ˜¯å…ˆæŠŠæœ¬åœ°ç¼“å­˜åˆ é™¤ï¼ˆæ”¹å˜æˆæœªtrackçŠ¶æ€ï¼‰ï¼Œç„¶åå†æäº¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached .</span><br><span class="line">git add .</span><br><span class="line">git commit -m &apos;update .gitignore&apos;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å­¦ä¹ çš„gitçš„åŒå­¦æƒ³å¿…çœ‹è¿‡äº†&lt;a href=&quot;https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å»–é›ªå³°è€å¸ˆçš„Gitæ•™ç¨‹&lt;/a&gt;ï¼Œç¬”è€…åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ä¹Ÿæ·±å—è¿™ç¯‡æ–‡ç« çš„å¯å‘ã€‚ä½†æ˜¯åœ¨å­¦ä¹ æˆ–ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œç¬”è€…ä¹Ÿé‡åˆ°äº†ä¸€äº›æ¯”è¾ƒå®é™…çš„ä½†æ˜¯å»–è€å¸ˆæ²¡æœ‰æåˆ°æˆ–è€…åªæ˜¯ä¸€ç¬”å¸¦è¿‡çš„é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« å°±æŠŠè¿™äº›é—®é¢˜çš„è§£å†³åŠæ³•è®°å½•ä¸€ä¸‹å§ï½
    
    </summary>
    
      <category term="Gitä½¿ç”¨" scheme="http://yoursite.com/categories/Git%E4%BD%BF%E7%94%A8/"/>
    
    
      <category term="Git" scheme="http://yoursite.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Androidè·å–ç³»ç»Ÿå›¾ç‰‡çš„ç ”ç©¶</title>
    <link href="http://yoursite.com/2017/11/13/Android%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E5%9B%BE%E7%89%87%E7%9A%84%E7%A0%94%E7%A9%B6/"/>
    <id>http://yoursite.com/2017/11/13/Androidè·å–ç³»ç»Ÿå›¾ç‰‡çš„ç ”ç©¶/</id>
    <published>2017-11-13T11:42:08.000Z</published>
    <updated>2018-03-01T09:01:26.490Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨Androidå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä»ç›¸å†Œä¸­è·å–å›¾ç‰‡ã€æ‹ç…§è·å–å›¾ç‰‡ã€ç›¸å†Œå¤šé€‰çš„éœ€æ±‚ï¼Œé‚£ä¹ˆä»Šå¤©å°±ä»è¿™ä¸‰ç‚¹å‡ºå‘æ¥ç ”ç©¶ä¸€ä¸‹Androidè·å–ç³»ç»Ÿçš„å›¾ç‰‡çš„æ–¹æ³•å§ï½<a id="more"></a></p><h1 id="1-ç›¸å†Œè·å–å›¾ç‰‡ï¼ˆå•å¼ ï¼‰"><a href="#1-ç›¸å†Œè·å–å›¾ç‰‡ï¼ˆå•å¼ ï¼‰" class="headerlink" title="1.ç›¸å†Œè·å–å›¾ç‰‡ï¼ˆå•å¼ ï¼‰"></a>1.ç›¸å†Œè·å–å›¾ç‰‡ï¼ˆå•å¼ ï¼‰</h1><p>ä»ç›¸å†Œè·å–å•å¼ å›¾ç‰‡çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ç§æ˜¯ç›´æ¥è·å–ï¼Œå¦å¤–ä¸€ç§æ˜¯åœ¨è¿›å…¥å†…å®¹ï¼ˆå›¾ç‰‡ï¼‰é€‰æ‹©ç•Œé¢ä¹‹å‰å¼¹å‡ºä¸€ä¸ªç±»åˆ«é€‰æ‹©çª—ã€‚</p><h4 id="ç›´æ¥è·å–"><a href="#ç›´æ¥è·å–" class="headerlink" title="ç›´æ¥è·å–"></a>ç›´æ¥è·å–</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">void getImageFromAlbum() &#123;  </span><br><span class="line">Intent intent = new Intent(Intent.ACTION_PICK);  </span><br><span class="line">intent.setType(&quot;image/*&quot;);//ç›¸ç‰‡ç±»å‹  </span><br><span class="line">startActivityForResult(intent, REQUEST_CODE_PICK_IMAGE);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿›è¡Œå†…å®¹ç±»åˆ«é€‰æ‹©ä¹‹åï¼Œæ‰è¿›å…¥å…·ä½“çš„å†…å®¹ç•Œé¢"><a href="#è¿›è¡Œå†…å®¹ç±»åˆ«é€‰æ‹©ä¹‹åï¼Œæ‰è¿›å…¥å…·ä½“çš„å†…å®¹ç•Œé¢" class="headerlink" title="è¿›è¡Œå†…å®¹ç±»åˆ«é€‰æ‹©ä¹‹åï¼Œæ‰è¿›å…¥å…·ä½“çš„å†…å®¹ç•Œé¢"></a>è¿›è¡Œå†…å®¹ç±»åˆ«é€‰æ‹©ä¹‹åï¼Œæ‰è¿›å…¥å…·ä½“çš„å†…å®¹ç•Œé¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void getContent() &#123;</span><br><span class="line">Intent intent = new Intent();</span><br><span class="line">intent.setType(&quot;image/*&quot;);</span><br><span class="line">intent.setAction(Intent.ACTION_GET_CONTENT);</span><br><span class="line">startActivityForResult(Intent.createChooser(intent, &quot;Select Picture&quot;), 1);//å®šä¹‰å¼¹çª—çš„æ ‡é¢˜ã€‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-ä»ç…§ç›¸æœºè·å–ç…§ç‰‡"><a href="#2-ä»ç…§ç›¸æœºè·å–ç…§ç‰‡" class="headerlink" title="2.ä»ç…§ç›¸æœºè·å–ç…§ç‰‡"></a>2.ä»ç…§ç›¸æœºè·å–ç…§ç‰‡</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">protected void getImageFromCamera() &#123;  </span><br><span class="line">String state = Environment.getExternalStorageState();  </span><br><span class="line">if (state.equals(Environment.MEDIA_MOUNTED)) &#123;  </span><br><span class="line">Intent intent = new Intent();</span><br><span class="line">intent.setAction(&quot;android.media.action.IMAGE_CAPTURE&quot;);</span><br><span class="line">startActivityForResult(intent, 2); </span><br><span class="line">&#125;  </span><br><span class="line">else &#123;  </span><br><span class="line">Toast.makeText(getApplicationContext(), &quot;è¯·ç¡®è®¤å·²ç»æ’å…¥SDå¡&quot;, Toast.LENGTH_LONG).show();  </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“å›¾ç‰‡çš„ä¿¡æ¯è¿”å›åï¼Œæˆ‘ä»¬è¦åœ¨<code>onActivityResult</code>æ–¹æ³•ä¸­è·å–è¿”å›çš„å›¾ç‰‡ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Override  </span><br><span class="line">protected void onActivityResult(int requestCode, int resultCode, Intent data) &#123;  </span><br><span class="line">if (requestCode == 1) &#123;             </span><br><span class="line">Uri uri = data.getData();  </span><br><span class="line">//to do find the path of pic  </span><br><span class="line"></span><br><span class="line">&#125; else if (requestCode == 2 ) &#123;             </span><br><span class="line">Uri uri = data.getData();  </span><br><span class="line">//to do find the path of pic  </span><br><span class="line">&#125; &#125;</span><br></pre></td></tr></table></figure></p><p>ä¸åŒçš„æœºå™¨è·å¾—ç›¸ç‰‡çš„æ–¹å¼ä¸å¤ªä¸€æ ·ï¼Œå¯èƒ½æœ‰çš„ç›¸æœºèƒ½å¤Ÿé€šè¿‡  inten.getData()è·å–åˆ°uriç„¶åå†æ ¹æ®uriè·å–æ•°æ®çš„è·¯å¾„ï¼Œåœ¨å°è£…æˆbitmapï¼Œä½†æœ‰æ—¶å€™æœ‰çš„ç›¸æœºè·å–åˆ°çš„æ˜¯nullçš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>å…¶å®è¿™æ—¶å€™æˆ‘ä»¬å°±åº”è¯¥ä»bundleä¸­è·å–æ•°æ®ï¼Œé€šè¿‡(Bitmap) bundle.get(â€œdataâ€)ç›´æ¥è·å–åˆ°ç›¸æœºå›¾ç‰‡çš„bitmapæ•°æ®ã€‚ä¸ºäº†èƒ½å¤ŸåŒæ—¶é€‚åº”ä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬è¿™æ—¶å€™å°±åº”è¯¥åœ¨è·å–å›¾ç‰‡æ—¶åšåˆ¤æ–­äº†ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å“åº”çš„æ—¶å€™åšä¸€ä¸ªåˆ¤æ–­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@Override  </span><br><span class="line">protected void onActivityResult(int requestCode, int resultCode, Intent data) &#123;  </span><br><span class="line">if (requestCode == 1) &#123;             </span><br><span class="line">Uri uri = data.getData();  </span><br><span class="line">//to do find the path of pic by uri  </span><br><span class="line"></span><br><span class="line">&#125; else if (requestCode == 2 ) &#123;             </span><br><span class="line">Uri uri = data.getData();  </span><br><span class="line">if(uri == null)&#123;  </span><br><span class="line">//use bundle to get data  </span><br><span class="line">Bundle bundle = data.getExtras();    </span><br><span class="line">if (bundle != null) &#123;                 </span><br><span class="line">Bitmap  photo = (Bitmap) bundle.get(&quot;data&quot;);                //get bitmap  </span><br><span class="line">//spath :ç”Ÿæˆå›¾ç‰‡å–ä¸ªåå­—å’Œè·¯å¾„åŒ…å«ç±»å‹        </span><br><span class="line">saveImage(Bitmap photo, String spath);  </span><br><span class="line">&#125; else &#123;           </span><br><span class="line">Toast.makeText(getApplicationContext(), &quot;err****&quot;, Toast.LENGTH_LONG).show();           </span><br><span class="line">return;        </span><br><span class="line">&#125;    </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">//to do find the path of pic by uri  </span><br><span class="line">&#125;   </span><br><span class="line">&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åé¢çš„è¿‡ç¨‹å°±éœ€è¦é€šè¿‡bitmapè½¬åŒ–æˆç›¸åº”çš„å›¾ç‰‡æ–‡ä»¶äº†ã€‚ä¸è¿‡å¾—åˆ°<strong>æœ€ç»ˆçš„å›¾ç‰‡æ˜¯è¢«å‹ç¼©äº†çš„</strong>ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static void saveImage(Bitmap photo, String spath) &#123;  </span><br><span class="line">try &#123;  </span><br><span class="line">BufferedOutputStream bos = new BufferedOutputStream(  </span><br><span class="line">new FileOutputStream(spath, false));  </span><br><span class="line">photo.compress(Bitmap.CompressFormat.JPEG, 100, bos);  </span><br><span class="line">bos.flush();  </span><br><span class="line">bos.close();  </span><br><span class="line">&#125; catch (Exception e) &#123;  </span><br><span class="line">e.printStackTrace();  </span><br><span class="line">return false;  </span><br><span class="line">&#125;  </span><br><span class="line">return true;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="3-å®ç°ç›¸å†Œå¤šé€‰åŠŸèƒ½"><a href="#3-å®ç°ç›¸å†Œå¤šé€‰åŠŸèƒ½" class="headerlink" title="3.å®ç°ç›¸å†Œå¤šé€‰åŠŸèƒ½"></a>3.å®ç°ç›¸å†Œå¤šé€‰åŠŸèƒ½</h1><p>Androidè‡ªèº«æ²¡æœ‰å®ç°ç›¸å†Œå¤šé€‰åŠŸèƒ½ï¼Œå¦‚æœæƒ³è¦å®ç°çš„è¯ï¼Œè¿˜æ˜¯æœ‰åŠæ³•çš„ã€‚é€šè¿‡<code>getContentResolver().query()</code>éå†æ•´ä¸ªç›¸å†Œå³å¯è·å–æ‰€æœ‰çš„æœ¬åœ°å›¾ç‰‡ï¼Œç„¶ååˆ©ç”¨GridViewæˆ–è€…å…¶å®ƒçš„æ–¹å¼å°†è¿™äº›å›¾ç‰‡å±•ç¤ºå³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ContentResolver contentResolver = getContentResolver();</span><br><span class="line">Cursor cursor = contentResolver.query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, null, null, null, null);</span><br><span class="line">if (cursor.moveToFirst()) &#123;</span><br><span class="line">do &#123;</span><br><span class="line">String uriStr = cursor.getString(cursor.getColumnIndex(MediaStore.Images.ImageColumns.DATA));</span><br><span class="line">//è¿™é‡Œå¯ä»¥å…ˆå°†uriSträ¿å­˜åˆ°å†…å­˜ï¼Œä¹‹åå†åŠ è½½åˆ°Adapterä¸­ã€‚</span><br><span class="line">Log.d(&quot;TAG&quot;, &quot;query: &quot; + column);</span><br><span class="line">&#125; while (cursor.moveToNext());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="4-æœ€ä½³å®è·µ"><a href="#4-æœ€ä½³å®è·µ" class="headerlink" title="4.æœ€ä½³å®è·µ"></a>4.æœ€ä½³å®è·µ</h1><h4 id="è·å–æƒé™"><a href="#è·å–æƒé™" class="headerlink" title="è·å–æƒé™"></a>è·å–æƒé™</h4><p>ä¸è¦å¿˜è®°äº†ï¼ŒAndroidåœ¨è¯»å–å¤–éƒ¨å­˜å‚¨ç©ºé—´æ—¶éœ€è¦è·å–<code>android.permission.READ_EXTERNAL_STORAGE</code>æƒé™ã€‚ä½†æ˜¯6.0ä»¥ä¸Šçš„Androidç³»ç»Ÿæœ‰äº†åŠ¨æ€è·å–æƒé™çš„æ¦‚å¿µï¼Œå…·ä½“è¯·æŸ¥çœ‹<a href="https://developer.android.com/training/permissions/requesting.html?hl=zh-cn" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚<br>ä¸Šé¢æåˆ°è¯»å–å¤–éƒ¨å­˜å‚¨ç©ºé—´æ—¶éœ€è¦è¯»å–æƒé™ï¼Œå…¶å®æ‰€æœ‰éœ€è¦è®¿é—®å¤–éƒ¨å­˜å‚¨ç©ºé—´çš„æ“ä½œéƒ½æ˜¯éœ€è¦è®¿é—®æƒé™çš„ã€‚ä½†æ˜¯å¯¹äºå†…éƒ¨å­˜å‚¨ç©ºé—´çš„è®¿é—®åˆ™ä¸éœ€è¦æƒé™çš„ç”³è¯·ã€‚å…³äºå†…éƒ¨å­˜å‚¨ç©ºé—´ä¸å¤–éƒ¨å­˜å‚¨ç©ºé—´çš„åŒºåˆ«ï¼Œå…·ä½“è¯·æŸ¥çœ‹<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2013/0923/1557.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="http://www.cnblogs.com/kobe8/p/4031226.html" target="_blank" rel="noopener">Androidå¼€å‘ä¹‹è·å–ç›¸å†Œç…§ç‰‡å’Œè·å–æ‹ç…§ç…§ç‰‡</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨Androidå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä»ç›¸å†Œä¸­è·å–å›¾ç‰‡ã€æ‹ç…§è·å–å›¾ç‰‡ã€ç›¸å†Œå¤šé€‰çš„éœ€æ±‚ï¼Œé‚£ä¹ˆä»Šå¤©å°±ä»è¿™ä¸‰ç‚¹å‡ºå‘æ¥ç ”ç©¶ä¸€ä¸‹Androidè·å–ç³»ç»Ÿçš„å›¾ç‰‡çš„æ–¹æ³•å§ï½
    
    </summary>
    
      <category term="Androidå¤šåª’ä½“æ“ä½œ" scheme="http://yoursite.com/categories/Android%E5%A4%9A%E5%AA%92%E4%BD%93%E6%93%8D%E4%BD%9C/"/>
    
    
      <category term="è·å–æ‹ç…§æˆ–ç›¸å†Œå›¾ç‰‡" scheme="http://yoursite.com/tags/%E8%8E%B7%E5%8F%96%E6%8B%8D%E7%85%A7%E6%88%96%E7%9B%B8%E5%86%8C%E5%9B%BE%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹</title>
    <link href="http://yoursite.com/2017/10/09/Android%E8%87%AA%E5%AE%9A%E4%B9%89View%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/</id>
    <published>2017-10-09T08:22:18.000Z</published>
    <updated>2018-05-12T12:08:02.082Z</updated>
    
    <content type="html"><![CDATA[<p>è‡ªå®šä¹‰Viewä¸€ç›´éƒ½æ˜¯Androidå¼€å‘çš„ä¸€ä¸ªé‡è¦æ¨¡å—ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¹Ÿæ— æ³•é¿å…åœ°ä¼šç”¨åˆ°å®ƒã€‚é‚£ä¹ˆä»Šå¤©å°±æ¥è¯¦ç»†çš„æ¢³ç†ä¸€ä¸‹è¿™ä¸€å—çš„çŸ¥è¯†ç‚¹å§ã€‚<a id="more"></a></p><h1 id="1-è‡ªå®šä¹‰View"><a href="#1-è‡ªå®šä¹‰View" class="headerlink" title="1.è‡ªå®šä¹‰View"></a>1.è‡ªå®šä¹‰View</h1><p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ï¼Œä¸ºä»€ä¹ˆè¦è‡ªå®šä¹‰Viewï¼Ÿä¸»è¦æ˜¯Androidç³»ç»Ÿå†…ç½®çš„Viewæ— æ³•å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚å®šåˆ¶æˆ‘ä»¬æƒ³è¦çš„Viewã€‚è‡ªå®šä¹‰Viewæˆ‘ä»¬å¤§éƒ¨åˆ†æ—¶å€™åªéœ€é‡å†™ä¸¤ä¸ªå‡½æ•°ï¼šonMeasure()ã€onDraw()ã€‚onMeasureè´Ÿè´£å¯¹å½“å‰Viewçš„å°ºå¯¸è¿›è¡Œæµ‹é‡ï¼ŒonDrawè´Ÿè´£æŠŠå½“å‰è¿™ä¸ªViewç»˜åˆ¶å‡ºæ¥ã€‚</p><h4 id="ä»æ„é€ æ–¹æ³•è®²èµ·"><a href="#ä»æ„é€ æ–¹æ³•è®²èµ·" class="headerlink" title="ä»æ„é€ æ–¹æ³•è®²èµ·"></a>ä»æ„é€ æ–¹æ³•è®²èµ·</h4><p>Viewæœ‰å››ç§å½¢å¼çš„æ„é€ æ–¹æ³•ï¼Œå…¶ä¸­å››ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•æ˜¯API 21æ‰å‡ºç°ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬åªéœ€è¦é‡å†™å…¶ä»–ä¸‰ä¸ªæ„é€ æ–¹æ³•å³å¯ã€‚å®ƒä»¬çš„å‚æ•°ä¸ä¸€æ ·åˆ†åˆ«å¯¹åº”ä¸åŒçš„åˆ›å»ºæ–¹å¼ï¼Œæ¯”å¦‚åªæœ‰ä¸€ä¸ªContextå‚æ•°çš„æ„é€ æ–¹æ³•é€šå¸¸æ˜¯é€šè¿‡ä»£ç åˆå§‹åŒ–æ§ä»¶æ—¶ä½¿ç”¨ï¼›è€Œä¸¤ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•é€šå¸¸å¯¹åº”å¸ƒå±€æ–‡ä»¶ä¸­æ§ä»¶è¢«æ˜ å°„æˆå¯¹è±¡æ—¶è°ƒç”¨ï¼ˆéœ€è¦è§£æå±æ€§ï¼‰ï¼›é€šå¸¸æˆ‘ä»¬è®©è¿™ä¸¤ä¸ªæ„é€ æ–¹æ³•æœ€ç»ˆè°ƒç”¨ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œç„¶ååœ¨ç¬¬ä¸‰ä¸ªæ„é€ æ–¹æ³•ä¸­è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public MyTextView(Context context) &#123;</span><br><span class="line">this(context, null);</span><br><span class="line">&#125;</span><br><span class="line">public MyTextView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">this(context, attrs, 0);</span><br><span class="line">&#125;</span><br><span class="line">public MyTextView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">super(context, attrs, defStyleAttr);</span><br><span class="line">//åˆå§‹åŒ–æ“ä½œ</span><br><span class="line">â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="onMeasure"><a href="#onMeasure" class="headerlink" title="onMeasure"></a>onMeasure</h4><p>åœ¨å­¦ä¹ Androidçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±çŸ¥é“ï¼Œåœ¨xmlå¸ƒå±€æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬çš„layout_widthå’Œlayout_heightå‚æ•°å¯ä»¥ä¸ç”¨å†™å…·ä½“çš„å°ºå¯¸ï¼Œè€Œæ˜¯wrap_contentæˆ–è€…æ˜¯match_parentã€‚å…¶æ„æ€æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå°±æ˜¯å°†å°ºå¯¸è®¾ç½®ä¸ºâ€œåŒ…ä½å†…å®¹â€å’Œâ€œå¡«å……çˆ¶å¸ƒå±€ç»™æˆ‘ä»¬çš„æ‰€æœ‰ç©ºé—´â€ã€‚è¿™ä¸¤ä¸ªè®¾ç½®å¹¶æ²¡æœ‰æŒ‡å®šçœŸæ­£çš„å¤§å°ï¼Œå¯æ˜¯æˆ‘ä»¬ç»˜åˆ¶åˆ°å±å¹•ä¸Šçš„Viewå¿…é¡»æ˜¯è¦æœ‰å…·ä½“çš„å®½é«˜çš„ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±å»å¤„ç†å’Œè®¾ç½®å°ºå¯¸ã€‚å½“ç„¶äº†ï¼ŒViewç±»ç»™äº†é»˜è®¤çš„å¤„ç†ï¼Œä½†æ˜¯å¦‚æœViewç±»çš„é»˜è®¤å¤„ç†ä¸æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼Œæˆ‘ä»¬å°±å¾—é‡å†™onMeasureå‡½æ•°å•¦ã€‚è¿™é‡Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„Viewæ˜¯ä¸ªæ­£æ–¹å½¢ï¼Œå¦‚æœåœ¨xmlä¸­æŒ‡å®šå®½é«˜ä¸º<code>wrap_content</code>ï¼Œå¦‚æœä½¿ç”¨Viewç±»æä¾›çš„measureå¤„ç†æ–¹å¼ï¼Œæ˜¾ç„¶æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚<br>å…ˆçœ‹çœ‹onMeasureå‡½æ•°åŸå‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)</span><br></pre></td></tr></table></figure></p><p>å‚æ•°ä¸­çš„widthMeasureSpecå’ŒheightMeasureSpecæ˜¯ä¸ªä»€ä¹ˆé¬¼ï¼Ÿçœ‹èµ·æ¥å¾ˆåƒwidthå’Œheightï¼Œæ²¡é”™ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å°±æ˜¯åŒ…å«å®½å’Œé«˜çš„ä¿¡æ¯ã€‚ä»€ä¹ˆï¼ŸåŒ…å«ï¼Ÿéš¾é“è¿˜è¦å…¶ä»–ä¿¡æ¯ï¼Ÿæ˜¯çš„ï¼å®ƒè¿˜åŒ…å«æµ‹é‡æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªintæ•´æ•°ï¼Œé‡Œé¢æ”¾äº†æµ‹é‡æ¨¡å¼å’Œå°ºå¯¸å¤§å°ã€‚é‚£ä¹ˆä¸€ä¸ªæ•°æ€ä¹ˆæ”¾ä¸¤ä¸ªä¿¡æ¯å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®å®½é«˜æ—¶æœ‰3ä¸ªé€‰æ‹©ï¼šwrap_contentã€match_parentä»¥åŠæŒ‡å®šå›ºå®šå°ºå¯¸ï¼Œè€Œæµ‹é‡æ¨¡å¼ä¹Ÿæœ‰3ç§ï¼šUNSPECIFIEDï¼ŒEXACTLYï¼ŒAT_MOSTï¼Œå½“ç„¶ï¼Œä»–ä»¬å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»å“ˆï¼Œè¿™ä¸‰ç§æ¨¡å¼åé¢æˆ‘ä¼šè¯¦ç»†ä»‹ç»ï¼Œä½†æµ‹é‡æ¨¡å¼æ— éå°±æ˜¯è¿™3ç§æƒ…å†µï¼Œè€Œå¦‚æœä½¿ç”¨äºŒè¿›åˆ¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨2ä¸ªbitå°±å¯ä»¥åšåˆ°ï¼Œå› ä¸º2ä¸ªbitå–å€¼èŒƒå›´æ˜¯[0,3]é‡Œé¢å¯ä»¥å­˜æ”¾4ä¸ªæ•°è¶³å¤Ÿæˆ‘ä»¬ç”¨äº†ã€‚é‚£ä¹ˆGoogleæ˜¯æ€ä¹ˆæŠŠä¸€ä¸ªintåŒæ—¶æ”¾æµ‹é‡æ¨¡å¼å’Œå°ºå¯¸ä¿¡æ¯å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“intå‹æ•°æ®å ç”¨32ä¸ªbitï¼Œè€Œgoogleå®ç°çš„æ˜¯ï¼Œå°†intæ•°æ®çš„å‰é¢2ä¸ªbitç”¨äºåŒºåˆ†ä¸åŒçš„å¸ƒå±€æ¨¡å¼ï¼Œåé¢30ä¸ªbitå­˜æ”¾çš„æ˜¯å°ºå¯¸çš„æ•°æ®ã€‚<br>é‚£æˆ‘ä»¬æ€ä¹ˆä»intæ•°æ®ä¸­æå–æµ‹é‡æ¨¡å¼å’Œå°ºå¯¸å‘¢ï¼Ÿæ”¾å¿ƒï¼Œä¸ç”¨ä½ æ¯æ¬¡éƒ½è¦å†™ä¸€æ¬¡ç§»ä½&lt;&lt;å’Œå–ä¸”&amp;æ“ä½œï¼ŒAndroidå†…ç½®ç±»MeasureSpecå¸®æˆ‘ä»¬å†™å¥½å•¦~ï¼Œæˆ‘ä»¬åªéœ€æŒ‰ç…§ä¸‹é¢æ–¹æ³•å°±å¯ä»¥æ‹¿åˆ°å•¦ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int widthMode = MeasureSpec.getMode(widthMeasureSpec);</span><br><span class="line">int widthSize = MeasureSpec.getSize(widthMeasureSpec);</span><br></pre></td></tr></table></figure></p><p>çˆ±æ€è€ƒçš„ä½ è‚¯å®šä¼šé—®ï¼Œæ—¢ç„¶æˆ‘ä»¬èƒ½é€šè¿‡widthMeasureSpecæ‹¿åˆ°å®½åº¦å°ºå¯¸å¤§å°ï¼Œé‚£æˆ‘ä»¬è¿˜è¦æµ‹é‡æ¨¡å¼å¹²å˜›ï¼Ÿæµ‹é‡æ¨¡å¼ä¼šä¸ä¼šæ˜¯å¤šä½™çš„ï¼Ÿè¯·æ³¨æ„ï¼šè¿™é‡Œçš„çš„å°ºå¯¸å¤§å°å¹¶ä¸æ˜¯æœ€ç»ˆæˆ‘ä»¬çš„Viewçš„å°ºå¯¸å¤§å°ï¼Œè€Œæ˜¯çˆ¶Viewæä¾›çš„å‚è€ƒå¤§å°ã€‚æˆ‘ä»¬çœ‹çœ‹æµ‹é‡æ¨¡å¼ï¼Œæµ‹é‡æ¨¡å¼æ˜¯å¹²å•¥ç”¨çš„å‘¢ï¼Ÿ</p><table><thead><tr><th>æµ‹é‡æ¨¡å¼</th><th style="text-align:left">è¡¨ç¤ºæ„æ€</th></tr></thead><tbody><tr><td>UNSPECIFIED</td><td style="text-align:left">çˆ¶å®¹å™¨æ²¡æœ‰å¯¹å½“å‰Viewæœ‰ä»»ä½•é™åˆ¶ï¼Œå½“å‰Viewå¯ä»¥ä»»æ„å–å°ºå¯¸</td></tr><tr><td>EXACTLY</td><td style="text-align:left">å½“å‰çš„å°ºå¯¸å°±æ˜¯å½“å‰Viewåº”è¯¥å–çš„å°ºå¯¸</td></tr><tr><td>AT_MOST</td><td style="text-align:left">å½“å‰å°ºå¯¸æ˜¯å½“å‰Viewèƒ½å–çš„æœ€å¤§å°ºå¯¸</td></tr></tbody></table><p>è€Œä¸Šé¢çš„æµ‹é‡æ¨¡å¼è·Ÿæˆ‘ä»¬çš„å¸ƒå±€æ—¶çš„wrap_contentã€match_parentä»¥åŠå†™æˆå›ºå®šçš„å°ºå¯¸æœ‰ä»€ä¹ˆå¯¹åº”å…³ç³»å‘¢ï¼Ÿ<br>1ã€match_parentâ€”&gt;EXACTLYã€‚æ€ä¹ˆç†è§£å‘¢ï¼Ÿmatch_parentå°±æ˜¯è¦åˆ©ç”¨çˆ¶Viewç»™æˆ‘ä»¬æä¾›çš„æ‰€æœ‰å‰©ä½™ç©ºé—´ï¼Œè€Œçˆ¶Viewå‰©ä½™ç©ºé—´æ˜¯ç¡®å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæµ‹é‡æ¨¡å¼çš„æ•´æ•°é‡Œé¢å­˜æ”¾çš„å°ºå¯¸ã€‚<br>2ã€wrap_contentâ€”&gt;AT_MOSTã€‚æ€ä¹ˆç†è§£ï¼šå°±æ˜¯æˆ‘ä»¬æƒ³è¦å°†å¤§å°è®¾ç½®ä¸ºåŒ…è£¹æˆ‘ä»¬çš„viewå†…å®¹ï¼Œé‚£ä¹ˆå°ºå¯¸å¤§å°å°±æ˜¯çˆ¶Viewç»™æˆ‘ä»¬ä½œä¸ºå‚è€ƒçš„å°ºå¯¸ï¼Œåªè¦ä¸è¶…è¿‡è¿™ä¸ªå°ºå¯¸å°±å¯ä»¥å•¦ï¼Œå…·ä½“å°ºå¯¸å°±æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚å»è®¾å®šã€‚<br>3ã€å›ºå®šå°ºå¯¸ï¼ˆå¦‚100dpï¼‰â€”&gt;EXACTLYã€‚ç”¨æˆ·è‡ªå·±æŒ‡å®šäº†å°ºå¯¸å¤§å°ï¼Œæˆ‘ä»¬å°±ä¸ç”¨å†å»å¹²æ¶‰äº†ï¼Œå½“ç„¶æ˜¯ä»¥æŒ‡å®šçš„å¤§å°ä¸ºä¸»å•¦ã€‚</p><h4 id="åŠ¨æ‰‹é‡å†™onMeasureå‡½æ•°"><a href="#åŠ¨æ‰‹é‡å†™onMeasureå‡½æ•°" class="headerlink" title="åŠ¨æ‰‹é‡å†™onMeasureå‡½æ•°"></a>åŠ¨æ‰‹é‡å†™onMeasureå‡½æ•°</h4><p>ä¸Šé¢è®²äº†å¤ªå¤šç†è®ºï¼Œæˆ‘ä»¬å®é™…æ“ä½œä¸€ä¸‹å§ï¼Œæ„Ÿå—ä¸€ä¸‹onMeasureçš„ä½¿ç”¨ï¼Œå‡è®¾æˆ‘ä»¬è¦å®ç°è¿™æ ·ä¸€ä¸ªæ•ˆæœï¼šå°†å½“å‰çš„Viewä»¥æ­£æ–¹å½¢çš„å½¢å¼æ˜¾ç¤ºï¼Œå³è¦å®½é«˜ç›¸ç­‰ï¼Œå¹¶ä¸”é»˜è®¤çš„å®½é«˜å€¼ä¸º100åƒç´ ã€‚å°±å¯ä»¥è¿™äº›ç¼–å†™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">private int getMySize(int defaultSize, int measureSpec) &#123;</span><br><span class="line">int mySize = defaultSize;</span><br><span class="line"></span><br><span class="line">int mode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">int size = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">switch (mode) &#123;</span><br><span class="line">case MeasureSpec.UNSPECIFIED: &#123;//å¦‚æœæ²¡æœ‰æŒ‡å®šå¤§å°ï¼Œå°±è®¾ç½®ä¸ºé»˜è®¤å¤§å°</span><br><span class="line">mySize = defaultSize;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">case MeasureSpec.AT_MOST: &#123;//å¦‚æœæµ‹é‡æ¨¡å¼æ˜¯æœ€å¤§å–å€¼ä¸ºsize</span><br><span class="line">//æˆ‘ä»¬å°†å¤§å°å–æœ€å¤§å€¼,ä½ ä¹Ÿå¯ä»¥å–å…¶ä»–å€¼</span><br><span class="line">mySize = size;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">case MeasureSpec.EXACTLY: &#123;//å¦‚æœæ˜¯å›ºå®šçš„å¤§å°ï¼Œé‚£å°±ä¸è¦å»æ”¹å˜å®ƒ</span><br><span class="line">mySize = size;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return mySize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">super.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">int width = getMySize(100, widthMeasureSpec);</span><br><span class="line">int height = getMySize(100, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">if (width &lt; height) &#123;</span><br><span class="line">height = width;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">width = height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setMeasuredDimension(width, height);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬è®¾ç½®ä¸€ä¸‹å¸ƒå±€<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;com.hc.studyview.MyView</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;100dp&quot;</span><br><span class="line">android:background=&quot;#ff0000&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>çœ‹çœ‹ä½¿ç”¨äº†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„onMeasureå‡½æ•°åçš„æ•ˆæœï¼š<br><img src="/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/1.jpg"><br>è€Œå¦‚æœæˆ‘ä»¬ä¸é‡å†™onMeasureï¼Œæ•ˆæœåˆ™æ˜¯å¦‚ä¸‹ï¼š<br><img src="/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/2.jpg"></p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°å½“<code>MyView</code>çš„çˆ¶Viewæ˜¯<code>RelativeLayout</code>æ—¶ï¼Œæ— æ³•é€šè¿‡é‡å†™onMeasureå®šä¹‰æ–¹å½¢Viewçš„æƒ…å†µï¼Œè§£å†³æ–¹æ¡ˆ<a href="https://stackoverflow.com/questions/17228741/why-is-my-android-custom-view-not-square/17465228#17465228" target="_blank" rel="noopener">è¯·çœ‹è¿™é‡Œ</a>ã€‚</p></blockquote><h4 id="é‡å†™onDraw"><a href="#é‡å†™onDraw" class="headerlink" title="é‡å†™onDraw"></a>é‡å†™onDraw</h4><p>ä¸Šé¢æˆ‘ä»¬å­¦ä¼šäº†è‡ªå®šä¹‰å°ºå¯¸å¤§å°ï¼Œé‚£ä¹ˆå°ºå¯¸æˆ‘ä»¬ä¼šè®¾å®šäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŠŠæˆ‘ä»¬æƒ³è¦çš„æ•ˆæœç”»å‡ºæ¥å§~ç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœå¾ˆç®€å•ï¼Œç›´æ¥åœ¨ç”»æ¿Canvaså¯¹è±¡ä¸Šç»˜åˆ¶å°±å¥½å•¦ï¼Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å»å­¦ä¹ ï¼šåœ¨æˆ‘ä»¬çš„Viewä¸Šæ˜¾ç¤ºä¸€ä¸ªåœ†å½¢ã€‚æˆ‘ä»¬åœ¨ä¸Šé¢å·²ç»å®ç°äº†å®½é«˜å°ºå¯¸ç›¸ç­‰çš„åŸºç¡€ä¸Šï¼Œç»§ç»­å¾€ä¸‹åšï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onDraw(Canvas canvas) &#123;</span><br><span class="line">int r = getMeasuredWidth() / 2;//ä¹Ÿå¯ä»¥æ˜¯getMeasuredHeight()/2,æœ¬ä¾‹ä¸­æˆ‘ä»¬å·²ç»å°†å®½é«˜è®¾ç½®ç›¸ç­‰äº†</span><br><span class="line">//åœ†å¿ƒçš„æ¨ªåæ ‡ä¸ºå½“å‰çš„Viewçš„åŠå¾„å€¼ï¼ˆæ³¨æ„æ˜¯å°†å½“å‰Viewåä¸Šè§’çš„ç¬¬ä¸€ä¸ªç‚¹è§†ä¸ºåŸç‚¹ã€‚ï¼‰</span><br><span class="line">int centerX = r;</span><br><span class="line">//åœ†å¿ƒçš„çºµåæ ‡ä¸ºå½“å‰çš„Viewçš„åŠå¾„å€¼</span><br><span class="line">int centerY =r;</span><br><span class="line"></span><br><span class="line">Paint paint = new Paint();</span><br><span class="line">paint.setColor(Color.GREEN);</span><br><span class="line">//å¼€å§‹ç»˜åˆ¶</span><br><span class="line">canvas.drawCircle(centerX, centerY, r, paint);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><img src="/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/3.jpg"><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>å› ä¸ºonDraw()å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼ˆä»»ä½•invalidate()çš„è°ƒç”¨éƒ½ä¼šè§¦å‘onDrawæ–¹æ³•ï¼‰ï¼Œæ‰€ä»¥è¦ç‰¹åˆ«æ³¨æ„onDrawä¸­å˜é‡å€¼çš„ç®¡ç†ã€‚</p></blockquote><h4 id="è‡ªå®šä¹‰å¸ƒå±€å±æ€§"><a href="#è‡ªå®šä¹‰å¸ƒå±€å±æ€§" class="headerlink" title="è‡ªå®šä¹‰å¸ƒå±€å±æ€§"></a>è‡ªå®šä¹‰å¸ƒå±€å±æ€§</h4><p>å¦‚æœæœ‰äº›å±æ€§æˆ‘ä»¬å¸Œæœ›ç”±ç”¨æˆ·æŒ‡å®šï¼Œåªæœ‰å½“ç”¨æˆ·ä¸æŒ‡å®šçš„æ—¶å€™æ‰ç”¨æˆ‘ä»¬ç¡¬ç¼–ç çš„å€¼ï¼Œæ¯”å¦‚ä¸Šé¢çš„é»˜è®¤å°ºå¯¸ï¼Œæˆ‘ä»¬æƒ³è¦ç”±ç”¨æˆ·è‡ªå·±åœ¨å¸ƒå±€æ–‡ä»¶é‡Œé¢æŒ‡å®šè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿé‚£å½“ç„¶æ˜¯é€šè¿‡è‡ªå®šä¹‰å±æ€§ï¼Œè®©ç”¨æˆ·ç”¨æˆ‘ä»¬å®šä¹‰çš„å±æ€§å•¦~<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨res/values/styles.xmlæ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰è¯·è‡ªå·±æ–°å»ºï¼‰é‡Œé¢å£°æ˜ä¸€ä¸ªæˆ‘ä»¬è‡ªå®šä¹‰çš„å±æ€§ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;!--nameä¸ºå£°æ˜çš„&quot;å±æ€§é›†åˆ&quot;åï¼Œå¯ä»¥éšä¾¿å–ï¼Œä½†æ˜¯æœ€å¥½æ˜¯è®¾ç½®ä¸ºè·Ÿæˆ‘ä»¬çš„Viewä¸€æ ·çš„åç§°--&gt;</span><br><span class="line">&lt;declare-styleable name=&quot;MyView&quot;&gt;</span><br><span class="line">&lt;!--å£°æ˜æˆ‘ä»¬çš„å±æ€§ï¼Œåç§°ä¸ºdefault_size,å–å€¼ç±»å‹ä¸ºå°ºå¯¸ç±»å‹ï¼ˆdp,pxç­‰ï¼‰--&gt;</span><br><span class="line">&lt;attr name=&quot;default_size&quot; format=&quot;dimension&quot; /&gt;</span><br><span class="line">&lt;/declare-styleable&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥å°±æ˜¯åœ¨å¸ƒå±€æ–‡ä»¶ç”¨ä¸Šæˆ‘ä»¬çš„è‡ªå®šä¹‰çš„å±æ€§å•¦~<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:hc=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;com.hc.studyview.MyView</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;100dp&quot;</span><br><span class="line">hc:default_size=&quot;100dp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šå¦‚æœæ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰å±æ€§ï¼Œå°±éœ€è¦åœ¨æ ¹æ ‡ç­¾ï¼ˆLinearLayoutï¼‰é‡Œé¢è®¾å®šå‘½åç©ºé—´ã€‚å‘½åç©ºé—´çš„ä¸€ç§å†™æ³•æ˜¯xmlns:hc=â€<a href="http://schemas.android.com/apk/res-auto&quot;ï¼Œres-autoè¡¨ç¤ºè‡ªåŠ¨æŸ¥æ‰¾ï¼Œè¿˜æœ‰ä¸€ç§å†™æ³•æ˜¯xmlns:hc=&quot;http://schemas.android.com/apk/com.hc.studyview.MyView&quot;ï¼Œ`com.hc.studyview.MyView`ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŒ…åã€‚è€Œå‘½åç©ºé—´çš„åç§°å¯ä»¥éšæ„å–ï¼Œå¦‚ä¸Šå°±æ˜¯`hc`ã€‚" target="_blank" rel="noopener">http://schemas.android.com/apk/res-auto&quot;ï¼Œres-autoè¡¨ç¤ºè‡ªåŠ¨æŸ¥æ‰¾ï¼Œè¿˜æœ‰ä¸€ç§å†™æ³•æ˜¯xmlns:hc=&quot;http://schemas.android.com/apk/com.hc.studyview.MyView&quot;ï¼Œ`com.hc.studyview.MyView`ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŒ…åã€‚è€Œå‘½åç©ºé—´çš„åç§°å¯ä»¥éšæ„å–ï¼Œå¦‚ä¸Šå°±æ˜¯`hc`ã€‚</a><br>æœ€åå°±æ˜¯åœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰çš„Viewé‡Œé¢æŠŠæˆ‘ä»¬è‡ªå®šä¹‰çš„å±æ€§çš„å€¼å–å‡ºæ¥ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè¿˜è®°å¾—æœ‰ä¸ªAttributeSetå±æ€§å—ï¼Ÿå°±æ˜¯é å®ƒå¸®æˆ‘ä»¬æŠŠå¸ƒå±€é‡Œé¢çš„å±æ€§å–å‡ºæ¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">private int defalutSize;</span><br><span class="line">public MyView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">super(context, attrs);</span><br><span class="line">//ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬åœ¨styles.xmlæ–‡ä»¶ä¸­çš„&lt;declare-styleable&gt;æ ‡ç­¾</span><br><span class="line">//å³å±æ€§é›†åˆçš„æ ‡ç­¾ï¼Œåœ¨Ræ–‡ä»¶ä¸­åç§°ä¸ºR.styleable+name</span><br><span class="line">TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.MyView);</span><br><span class="line">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå±æ€§é›†åˆé‡Œé¢çš„å±æ€§ï¼ŒRæ–‡ä»¶åç§°ï¼šR.styleable+å±æ€§é›†åˆåç§°+ä¸‹åˆ’çº¿+å±æ€§åç§°</span><br><span class="line">//ç¬¬äºŒä¸ªå‚æ•°ä¸ºé»˜è®¤å€¼</span><br><span class="line">defalutSize = a.getDimensionPixelSize(R.styleable.MyView_default_size, 100);</span><br><span class="line"></span><br><span class="line">//æœ€åè®°å¾—å°†TypedArrayå¯¹è±¡å›æ”¶</span><br><span class="line">a.recycle();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åï¼ŒæŠŠMyViewçš„å®Œæ•´ä»£ç é™„ä¸Šï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">package com.hc.studyview;</span><br><span class="line"></span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.content.res.TypedArray;</span><br><span class="line">import android.graphics.Canvas;</span><br><span class="line">import android.graphics.Color;</span><br><span class="line">import android.graphics.Paint;</span><br><span class="line">import android.util.AttributeSet;</span><br><span class="line">import android.util.Log;</span><br><span class="line">import android.view.MotionEvent;</span><br><span class="line">import android.view.View;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">* Package com.hc.studyview</span><br><span class="line">* Created by HuaChao on 2016/6/3.</span><br><span class="line">*/</span><br><span class="line">public class MyView extends View &#123;</span><br><span class="line"></span><br><span class="line">private int defalutSize;</span><br><span class="line"></span><br><span class="line">public MyView(Context context) &#123;</span><br><span class="line">super(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public MyView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">super(context, attrs);</span><br><span class="line">//ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬åœ¨styles.xmlæ–‡ä»¶ä¸­çš„&lt;declare-styleable&gt;æ ‡ç­¾</span><br><span class="line">//å³å±æ€§é›†åˆçš„æ ‡ç­¾ï¼Œåœ¨Ræ–‡ä»¶ä¸­åç§°ä¸ºR.styleable+name</span><br><span class="line">TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.MyView);</span><br><span class="line">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå±æ€§é›†åˆé‡Œé¢çš„å±æ€§ï¼ŒRæ–‡ä»¶åç§°ï¼šR.styleable+å±æ€§é›†åˆåç§°+ä¸‹åˆ’çº¿+å±æ€§åç§°</span><br><span class="line">//ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®è¿™ä¸ªå±æ€§ï¼Œåˆ™è®¾ç½®çš„é»˜è®¤çš„å€¼</span><br><span class="line">defalutSize = a.getDimensionPixelSize(R.styleable.MyView_default_size, 100);</span><br><span class="line">//æœ€åè®°å¾—å°†TypedArrayå¯¹è±¡å›æ”¶</span><br><span class="line">a.recycle();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private int getMySize(int defaultSize, int measureSpec) &#123;</span><br><span class="line">int mySize = defaultSize;</span><br><span class="line"></span><br><span class="line">int mode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">int size = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">switch (mode) &#123;</span><br><span class="line">case MeasureSpec.UNSPECIFIED: &#123;//å¦‚æœæ²¡æœ‰æŒ‡å®šå¤§å°ï¼Œå°±è®¾ç½®ä¸ºé»˜è®¤å¤§å°</span><br><span class="line">mySize = defaultSize;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">case MeasureSpec.AT_MOST: &#123;//å¦‚æœæµ‹é‡æ¨¡å¼æ˜¯æœ€å¤§å–å€¼ä¸ºsize</span><br><span class="line">//æˆ‘ä»¬å°†å¤§å°å–æœ€å¤§å€¼,ä½ ä¹Ÿå¯ä»¥å–å…¶ä»–å€¼</span><br><span class="line">mySize = size;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">case MeasureSpec.EXACTLY: &#123;//å¦‚æœæ˜¯å›ºå®šçš„å¤§å°ï¼Œé‚£å°±ä¸è¦å»æ”¹å˜å®ƒ</span><br><span class="line">mySize = size;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return mySize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">super.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">int width = getMySize(defalutSize, widthMeasureSpec);</span><br><span class="line">int height = getMySize(defalutSize, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">if (width &lt; height) &#123;</span><br><span class="line">height = width;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">width = height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setMeasuredDimension(width, height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onDraw(Canvas canvas) &#123;</span><br><span class="line">int r = getMeasuredWidth() / 2;//ä¹Ÿå¯ä»¥æ˜¯getMeasuredHeight()/2,æœ¬ä¾‹ä¸­æˆ‘ä»¬å·²ç»å°†å®½é«˜è®¾ç½®ç›¸ç­‰äº†</span><br><span class="line">int centerX = r;</span><br><span class="line">int centerY = r;</span><br><span class="line">Paint paint = new Paint();</span><br><span class="line">paint.setColor(Color.GREEN);</span><br><span class="line">//å¼€å§‹ç»˜åˆ¶</span><br><span class="line">canvas.drawCircle(centerX, centerY, r, paint);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="2-è‡ªå®šä¹‰ViewGroup"><a href="#2-è‡ªå®šä¹‰ViewGroup" class="headerlink" title="2.è‡ªå®šä¹‰ViewGroup"></a>2.è‡ªå®šä¹‰ViewGroup</h1><h4 id="åŸºæœ¬æ­¥éª¤"><a href="#åŸºæœ¬æ­¥éª¤" class="headerlink" title="åŸºæœ¬æ­¥éª¤"></a>åŸºæœ¬æ­¥éª¤</h4><p>è‡ªå®šä¹‰Viewçš„è¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±é‚£å‡ æ­¥ï¼Œå¯è‡ªå®šä¹‰ViewGroupå¯å°±æ²¡é‚£ä¹ˆç®€å•å•¦~ï¼Œå› ä¸ºå®ƒä¸ä»…è¦ç®¡å¥½è‡ªå·±çš„ï¼Œè¿˜è¦å…¼é¡¾å®ƒçš„å­Viewã€‚æˆ‘ä»¬éƒ½çŸ¥é“ViewGroupæ˜¯ä¸ªViewå®¹å™¨ï¼Œå®ƒè£…çº³child Viewå¹¶ä¸”è´Ÿè´£æŠŠchild Viewæ”¾å…¥æŒ‡å®šçš„ä½ç½®ã€‚æˆ‘ä»¬å‡è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯è®©ä½ è´Ÿè´£è®¾è®¡ViewGroupï¼Œä½ ä¼šæ€ä¹ˆå»è®¾è®¡å‘¢ï¼Ÿ<br>1ã€é¦–å…ˆï¼Œæˆ‘ä»¬å¾—çŸ¥é“å„ä¸ªå­Viewçš„å¤§å°å§ï¼Œåªæœ‰å…ˆçŸ¥é“å­Viewçš„å¤§å°ï¼Œæˆ‘ä»¬æ‰çŸ¥é“å½“å‰çš„ViewGroupè¯¥è®¾ç½®ä¸ºå¤šå¤§å»å®¹çº³å®ƒä»¬ã€‚<br>2ã€æ ¹æ®å­Viewçš„å¤§å°ï¼Œä»¥åŠæˆ‘ä»¬çš„ViewGroupè¦å®ç°çš„åŠŸèƒ½ï¼Œå†³å®šå‡ºViewGroupçš„å¤§å°ã€‚<br>3ã€ViewGroupå’Œå­Viewçš„å¤§å°ç®—å‡ºæ¥äº†ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å»æ‘†æ”¾äº†å§ï¼Œå…·ä½“æ€ä¹ˆå»æ‘†æ”¾å‘¢ï¼Ÿè¿™å¾—æ ¹æ®ä½ å®šåˆ¶çš„éœ€æ±‚å»æ‘†æ”¾äº†ï¼Œæ¯”å¦‚ï¼Œä½ æƒ³è®©å­ViewæŒ‰ç…§å‚ç›´é¡ºåºä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªæ”¾ï¼Œæˆ–è€…æ˜¯æŒ‰ç…§å…ˆåé¡ºåºä¸€ä¸ªå ä¸€ä¸ªå»æ”¾ï¼Œè¿™æ˜¯ä½ è‡ªå·±å†³å®šçš„ã€‚<br>4ã€å·²ç»çŸ¥é“æ€ä¹ˆå»æ‘†æ”¾è¿˜ä¸è¡Œå•Šï¼Œå†³å®šäº†æ€ä¹ˆæ‘†æ”¾å°±æ˜¯ç›¸å½“äºæŠŠå·²æœ‰çš„ç©ºé—´â€åˆ†å‰²â€æˆå¤§å¤§å°å°çš„ç©ºé—´ï¼Œæ¯ä¸ªç©ºé—´å¯¹åº”ä¸€ä¸ªå­Viewï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯æŠŠå­Viewå¯¹å·å…¥åº§äº†ï¼ŒæŠŠå®ƒä»¬æ”¾è¿›å®ƒä»¬è¯¥æ”¾çš„åœ°æ–¹å»ã€‚<br>ç°åœ¨å°±å®Œæˆäº†ViewGroupçš„è®¾è®¡äº†ï¼Œæˆ‘ä»¬æ¥ä¸ªå…·ä½“çš„æ¡ˆä¾‹ï¼šå°†å­ViewæŒ‰ä»ä¸Šåˆ°ä¸‹å‚ç›´é¡ºåºä¸€ä¸ªæŒ¨ç€ä¸€ä¸ªæ‘†æ”¾ï¼Œå³æ¨¡ä»¿å®ç°LinearLayoutçš„å‚ç›´å¸ƒå±€ã€‚<br>é¦–å…ˆé‡å†™onMeasureï¼Œå®ç°æµ‹é‡å­Viewå¤§å°ä»¥åŠè®¾å®šViewGroupçš„å¤§å°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">super.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">//å°†æ‰€æœ‰çš„å­Viewè¿›è¡Œæµ‹é‡ï¼Œè¿™ä¼šè§¦å‘æ¯ä¸ªå­Viewçš„onMeasureå‡½æ•°</span><br><span class="line">//æ³¨æ„è¦ä¸measureChildåŒºåˆ†ï¼ŒmeasureChildæ˜¯å¯¹å•ä¸ªviewè¿›è¡Œæµ‹é‡</span><br><span class="line">measureChildren(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">int widthMode = MeasureSpec.getMode(widthMeasureSpec);</span><br><span class="line">int widthSize = MeasureSpec.getSize(widthMeasureSpec);</span><br><span class="line">int heightMode = MeasureSpec.getMode(heightMeasureSpec);</span><br><span class="line">int heightSize = MeasureSpec.getSize(heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">int childCount = getChildCount();</span><br><span class="line"></span><br><span class="line">if (childCount == 0) &#123;//å¦‚æœæ²¡æœ‰å­View,å½“å‰ViewGroupæ²¡æœ‰å­˜åœ¨çš„æ„ä¹‰ï¼Œä¸ç”¨å ç”¨ç©ºé—´</span><br><span class="line">setMeasuredDimension(0, 0);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">//å¦‚æœå®½é«˜éƒ½æ˜¯åŒ…è£¹å†…å®¹</span><br><span class="line">if (widthMode == MeasureSpec.AT_MOST &amp;&amp; heightMode == MeasureSpec.AT_MOST) &#123;</span><br><span class="line">//æˆ‘ä»¬å°†é«˜åº¦è®¾ç½®ä¸ºæ‰€æœ‰å­Viewçš„é«˜åº¦ç›¸åŠ ï¼Œå®½åº¦è®¾ä¸ºå­Viewä¸­æœ€å¤§çš„å®½åº¦</span><br><span class="line">int height = getTotleHeight();</span><br><span class="line">int width = getMaxChildWidth();</span><br><span class="line">setMeasuredDimension(width, height);</span><br><span class="line">&#125; else if (heightMode == MeasureSpec.AT_MOST) &#123;//å¦‚æœåªæœ‰é«˜åº¦æ˜¯åŒ…è£¹å†…å®¹</span><br><span class="line">//å®½åº¦è®¾ç½®ä¸ºViewGroupè‡ªå·±çš„æµ‹é‡å®½åº¦ï¼Œé«˜åº¦è®¾ç½®ä¸ºæ‰€æœ‰å­Viewçš„é«˜åº¦æ€»å’Œ</span><br><span class="line">setMeasuredDimension(widthSize, getTotleHeight());</span><br><span class="line">&#125; else if (widthMode == MeasureSpec.AT_MOST) &#123;//å¦‚æœåªæœ‰å®½åº¦æ˜¯åŒ…è£¹å†…å®¹</span><br><span class="line">//å®½åº¦è®¾ç½®ä¸ºå­Viewä¸­å®½åº¦æœ€å¤§çš„å€¼ï¼Œé«˜åº¦è®¾ç½®ä¸ºViewGroupè‡ªå·±çš„æµ‹é‡å€¼</span><br><span class="line">setMeasuredDimension(getMaxChildWidth(), heightSize);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">/***</span><br><span class="line">* è·å–å­Viewä¸­å®½åº¦æœ€å¤§çš„å€¼</span><br><span class="line">*/</span><br><span class="line">private int getMaxChildWidth() &#123;</span><br><span class="line">int childCount = getChildCount();</span><br><span class="line">int maxWidth = 0;</span><br><span class="line">for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">View childView = getChildAt(i);</span><br><span class="line">if (childView.getMeasuredWidth() &gt; maxWidth)</span><br><span class="line">maxWidth = childView.getMeasuredWidth();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return maxWidth;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/***</span><br><span class="line">* å°†æ‰€æœ‰å­Viewçš„é«˜åº¦ç›¸åŠ </span><br><span class="line">**/</span><br><span class="line">private int getTotleHeight() &#123;</span><br><span class="line">int childCount = getChildCount();</span><br><span class="line">int height = 0;</span><br><span class="line">for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">View childView = getChildAt(i);</span><br><span class="line">height += childView.getMeasuredHeight();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä»£ç ä¸­çš„æ³¨é‡Šæˆ‘å·²ç»å†™å¾—å¾ˆè¯¦ç»†ï¼Œä¸å†å¯¹æ¯ä¸€è¡Œä»£ç è¿›è¡Œè®²è§£ã€‚ä¸Šé¢çš„onMeasureå°†å­Viewæµ‹é‡å¥½äº†ï¼Œä»¥åŠæŠŠè‡ªå·±çš„å°ºå¯¸ä¹Ÿè®¾ç½®å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å»æ‘†æ”¾å­Viewå§~<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onLayout(boolean changed, int l, int t, int r, int b) &#123;</span><br><span class="line">int count = getChildCount();</span><br><span class="line">//è®°å½•å½“å‰çš„é«˜åº¦ä½ç½®</span><br><span class="line">int curHeight = t;</span><br><span class="line">//å°†å­Viewé€ä¸ªæ‘†æ”¾</span><br><span class="line">for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">View child = getChildAt(i);</span><br><span class="line">int height = child.getMeasuredHeight();</span><br><span class="line">int width = child.getMeasuredWidth();</span><br><span class="line">//æ‘†æ”¾å­Viewï¼Œå‚æ•°åˆ†åˆ«æ˜¯å­ViewçŸ©å½¢åŒºåŸŸçš„å·¦ã€ä¸Šã€å³ã€ä¸‹è¾¹</span><br><span class="line">child.layout(l, curHeight, l + width, curHeight + height);</span><br><span class="line">curHeight += height;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼Œå°†æˆ‘ä»¬è‡ªå®šä¹‰çš„ViewGroupé‡Œé¢æ”¾3ä¸ªButton ,å°†è¿™3ä¸ªButtonçš„å®½åº¦è®¾ç½®ä¸ä¸€æ ·ï¼ŒæŠŠæˆ‘ä»¬çš„ViewGroupçš„å®½é«˜éƒ½è®¾ç½®ä¸ºåŒ…è£¹å†…å®¹wrap_contentï¼Œä¸ºäº†çœ‹çš„æ•ˆæœæ˜æ˜¾ï¼Œæˆ‘ä»¬ç»™ViewGroupåŠ ä¸ªèƒŒæ™¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;com.hc.studyview.MyViewGroup</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:background=&quot;#ff9900&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width=&quot;100dp&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;btn&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width=&quot;200dp&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;btn&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width=&quot;50dp&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;btn&quot; /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/com.hc.studyview.MyViewGroup&gt;</span><br><span class="line"></span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>çœ‹çœ‹æœ€åçš„æ•ˆæœå§~<br><img src="/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/4.jpg"><br>æ˜¯ä¸æ˜¯å¾ˆæ¿€åŠ¨æˆ‘ä»¬è‡ªå·±ä¹Ÿå¯ä»¥å®ç°LinearLayoutçš„æ•ˆæœå•¦~~~</p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>getMeasureWidth()/getMeasureHeight()éœ€è¦åœ¨è°ƒç”¨setMeasuredDimension()ä¹‹åä½¿ç”¨ï¼›getWidth()/getHeight()éœ€è¦åœ¨è°ƒç”¨layout()å‡½æ•°ä¹‹åä½¿ç”¨ã€‚ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨getMeasureWidth()/getMeasureHeight()è·å–å®½é«˜å³å¯ã€‚</p></blockquote><h4 id="è‡ªå®šä¹‰LayoutParams"><a href="#è‡ªå®šä¹‰LayoutParams" class="headerlink" title="è‡ªå®šä¹‰LayoutParams"></a>è‡ªå®šä¹‰LayoutParams</h4><p>ViewGroupä¸­æœ‰ä¸¤ä¸ªå†…éƒ¨ç±»ViewGroup.LayoutParamså’ŒViewGroup.MarginLayoutParamsï¼ŒMarginLayoutParamsç»§æ‰¿è‡ªLayoutParamsï¼Œè¿™ä¸¤ä¸ªå†…éƒ¨ç±»å°±æ˜¯ViewGroupçš„å¸ƒå±€å‚æ•°ç±»ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨LinearLayoutç­‰å¸ƒå±€ä¸­ä½¿ç”¨çš„layout_width\layout<em>heightç­‰ä»¥â€œlayout</em> â€å¼€å¤´çš„å±æ€§éƒ½æ˜¯å¸ƒå±€å±æ€§ã€‚</p><blockquote><p><strong>ä¸ºä»€ä¹ˆLayoutParams ç±»è¦å®šä¹‰åœ¨ViewGroupä¸­ï¼Ÿ</strong><br>å¤§å®¶éƒ½çŸ¥é“ViewGroupæ˜¯æ‰€æœ‰å®¹å™¨çš„åŸºç±»ï¼Œä¸€ä¸ªæ§ä»¶éœ€è¦è¢«åŒ…è£¹åœ¨ä¸€ä¸ªå®¹å™¨ä¸­ï¼Œè¿™ä¸ªå®¹å™¨å¿…é¡»æä¾›ä¸€ç§è§„åˆ™æ§åˆ¶å­æ§ä»¶çš„æ‘†æ”¾ï¼Œæ¯”å¦‚ä½ çš„å®½é«˜æ˜¯å¤šå°‘ï¼Œè·ç¦»é‚£ä¸ªä½ç½®å¤šè¿œç­‰ã€‚æ‰€ä»¥ViewGroupæœ‰ä¹‰åŠ¡æä¾›ä¸€ä¸ªå¸ƒå±€å±æ€§ç±»ï¼Œç”¨äºæ§åˆ¶å­æ§ä»¶çš„å¸ƒå±€å±æ€§ã€‚</p></blockquote><p>åœ¨Viewä¸­æœ‰ä¸€ä¸ªmLayoutParamsçš„å˜é‡ç”¨æ¥ä¿å­˜è¿™ä¸ªViewçš„æ‰€æœ‰å¸ƒå±€å±æ€§ã€‚ViewGroup.LayoutParamsæœ‰ä¸¤ä¸ªå±æ€§layout_widthå’Œlayout_heightï¼Œå› ä¸ºæ‰€æœ‰çš„å®¹å™¨éƒ½éœ€è¦è®¾ç½®å­æ§ä»¶çš„å®½é«˜ï¼Œæ‰€ä»¥è¿™ä¸ªLayoutParamsæ˜¯æ‰€æœ‰å¸ƒå±€å‚æ•°çš„åŸºç±»ï¼Œå¦‚æœéœ€è¦æ‰©å±•å…¶ä»–å±æ€§ï¼Œéƒ½åº”è¯¥ç»§æ‰¿è‡ªå®ƒã€‚æ¯”å¦‚RelativeLayoutä¸­å°±æä¾›äº†å®ƒè‡ªå·±çš„å¸ƒå±€å‚æ•°ç±»RelativeLayout.LayoutParamsï¼Œå¹¶æ‰©å±•äº†å¾ˆå¤šå¸ƒå±€å‚æ•°ï¼Œæˆ‘ä»¬å¹³æ—¶åœ¨RelativeLayoutä¸­ä½¿ç”¨çš„å¸ƒå±€å±æ€§éƒ½æ¥è‡ªå®ƒï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;declare-styleable name= &quot;RelativeLayout_Layout&quot;&gt;</span><br><span class="line">&lt;attr name =&quot;layout_toLeftOf&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_toRightOf&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_above&quot; format=&quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_below&quot; format=&quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignBaseline&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignLeft&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignTop&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignRight&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignBottom&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentLeft&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentTop&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentRight&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentBottom&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_centerInParent&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_centerVertical&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignWithParentIfMissing&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_toStartOf&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_toEndOf&quot; format=&quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignStart&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignEnd&quot; format= &quot;reference&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentStart&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;attr name =&quot;layout_alignParentEnd&quot; format= &quot;boolean&quot; /&gt;</span><br><span class="line">&lt;/declare-styleable &gt;</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>ä¸ºä»€ä¹ˆViewä¸­ä¼šæœ‰ä¸€ä¸ªmLayoutParamså˜é‡ï¼Ÿ</strong><br>æˆ‘ä»¬åœ¨ä¹‹å‰å­¦ä¹ è‡ªå®šä¹‰æ§ä»¶çš„æ—¶å€™å­¦è¿‡è‡ªå®šä¹‰å±æ€§ï¼Œæˆ‘ä»¬åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œåˆå§‹åŒ–å¸ƒå±€æ–‡ä»¶ä¸­çš„å±æ€§å€¼ï¼Œæˆ‘ä»¬å§‘ä¸”æŠŠå±æ€§åˆ†ä¸ºä¸¤ç§ã€‚ä¸€ç§æ˜¯æœ¬Viewçš„ç»˜åˆ¶å±æ€§ï¼Œæ¯”å¦‚TextViewçš„æ–‡æœ¬ã€æ–‡å­—é¢œè‰²ã€èƒŒæ™¯ç­‰ï¼Œè¿™äº›å±æ€§æ˜¯è·ŸViewçš„ç»˜åˆ¶ç›¸å…³çš„ã€‚å¦ä¸€ç§å°±æ˜¯ä»¥â€œlayout_â€æ‰“å¤´çš„å«åšå¸ƒå±€å±æ€§ï¼Œè¿™äº›å±æ€§æ˜¯çˆ¶æ§ä»¶å¯¹å­æ§ä»¶çš„å¤§å°åŠä½ç½®çš„ä¸€äº›æè¿°å±æ€§ï¼Œè¿™äº›å±æ€§åœ¨çˆ¶æ§ä»¶æ‘†æ”¾å®ƒçš„æ—¶å€™ä¼šä½¿ç”¨åˆ°ï¼Œæ‰€ä»¥å…ˆä¿å­˜èµ·æ¥ï¼Œè€Œè¿™äº›å±æ€§éƒ½æ˜¯ViewGroup.LayoutParamså®šä¹‰çš„ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªå˜é‡ä¿å­˜ç€ã€‚</p></blockquote><p>çœ‹äº†ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¤§æ¦‚çŸ¥é“æ€ä¹ˆä¸ºæˆ‘ä»¬çš„å¸ƒå±€å®¹å™¨å®šä¹‰è‡ªå·±çš„å¸ƒå±€å±æ€§äº†å§ï¼Œå°±ä¸ç»•å¼¯å­äº†ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤åšï¼š </p><h5 id="â‘ -å¤§è‡´æ˜ç¡®å¸ƒå±€å®¹å™¨çš„éœ€æ±‚ï¼Œåˆæ­¥å®šä¹‰å¸ƒå±€å±æ€§"><a href="#â‘ -å¤§è‡´æ˜ç¡®å¸ƒå±€å®¹å™¨çš„éœ€æ±‚ï¼Œåˆæ­¥å®šä¹‰å¸ƒå±€å±æ€§" class="headerlink" title="â‘ . å¤§è‡´æ˜ç¡®å¸ƒå±€å®¹å™¨çš„éœ€æ±‚ï¼Œåˆæ­¥å®šä¹‰å¸ƒå±€å±æ€§"></a>â‘ . å¤§è‡´æ˜ç¡®å¸ƒå±€å®¹å™¨çš„éœ€æ±‚ï¼Œåˆæ­¥å®šä¹‰å¸ƒå±€å±æ€§</h5><p>åœ¨å®šä¹‰å±æ€§ä¹‹å‰è¦å¼„æ¸…æ¥šï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å¸ƒå±€å®¹å™¨éœ€è¦æ»¡è¶³é‚£äº›éœ€æ±‚ï¼Œéœ€è¦å“ªäº›å±æ€§ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬ç°åœ¨è¦å®ç°åƒç›¸å¯¹å¸ƒå±€ä¸€æ ·ï¼Œä¸ºå­æ§ä»¶è®¾ç½®ä¸€ä¸ªä½ç½®å±æ€§layout_position=â€â€œï¼Œæ¥æ§åˆ¶å­æ§ä»¶åœ¨å¸ƒå±€ä¸­æ˜¾ç¤ºçš„ä½ç½®ã€‚æš‚å®šä½ç½®æœ‰äº”ç§ï¼šå·¦ä¸Šã€å·¦ä¸‹ã€å³ä¸Šã€å³ä¸‹ã€å±…ä¸­ã€‚æœ‰äº†éœ€æ±‚ï¼Œæˆ‘ä»¬å°±åœ¨attr.xmlå®šä¹‰è‡ªå·±çš„å¸ƒå±€å±æ€§ï¼ˆå’Œä¹‹å‰è®²çš„è‡ªå®šä¹‰å±æ€§ä¸€æ ·çš„æ“ä½œ)ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding= &quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt; </span><br><span class="line">&lt;declare-styleable name =&quot;CustomLayout&quot;&gt;</span><br><span class="line">&lt;attr name =&quot;layout_position&quot;&gt;</span><br><span class="line">&lt;enum name =&quot;center&quot; value=&quot;0&quot; /&gt;</span><br><span class="line">&lt;enum name =&quot;left&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">&lt;enum name =&quot;right&quot; value=&quot;2&quot; /&gt;</span><br><span class="line">&lt;enum name =&quot;bottom&quot; value=&quot;3&quot; /&gt;</span><br><span class="line">&lt;enum name =&quot;rightAndBottom&quot; value=&quot;4&quot; /&gt;</span><br><span class="line">&lt;/attr &gt;</span><br><span class="line">&lt;/declare-styleable&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>leftå°±ä»£è¡¨æ˜¯å·¦ä¸Šï¼ˆæŒ‰å¸¸ç†é»˜è®¤å°±æ˜¯å·¦ä¸Šæ–¹å¼€å§‹ï¼Œå°±ä¸ç”¨å†™leftTopäº†ï¼Œç®€æ´ä¸€ç‚¹ï¼‰ï¼Œbottomå·¦ä¸‹ï¼Œright å³ä¸Šï¼ŒrightAndBottomå³ä¸‹ï¼Œcenterå±…ä¸­ã€‚å±æ€§ç±»å‹æ˜¯æšä¸¾ï¼ŒåŒæ—¶åªèƒ½è®¾ç½®ä¸€ä¸ªå€¼ã€‚ </p><h5 id="â‘¡-ç»§æ‰¿LayoutParamsï¼Œå®šä¹‰å¸ƒå±€å‚æ•°ç±»"><a href="#â‘¡-ç»§æ‰¿LayoutParamsï¼Œå®šä¹‰å¸ƒå±€å‚æ•°ç±»" class="headerlink" title="â‘¡. ç»§æ‰¿LayoutParamsï¼Œå®šä¹‰å¸ƒå±€å‚æ•°ç±»"></a>â‘¡. ç»§æ‰¿LayoutParamsï¼Œå®šä¹‰å¸ƒå±€å‚æ•°ç±»</h5><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç»§æ‰¿ViewGroup.LayoutParamsï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬çš„å¸ƒå±€åªæ˜¯ç®€å•çš„æ”¯æŒlayout_widthå’Œlayout_heightï¼›ä¹Ÿå¯ä»¥ç»§æ‰¿MarginLayoutParamsï¼Œå°±èƒ½ä½¿ç”¨layout_marginxxxå±æ€§äº†ã€‚å› ä¸ºåé¢æˆ‘ä»¬è¿˜è¦ç”¨åˆ°marginå±æ€§ï¼Œæ‰€ä»¥è¿™é‡Œæ–¹ä¾¿èµ·è§å°±ç›´æ¥ç»§æ‰¿MarginLayoutParamsäº†ã€‚<br>è¦†ç›–æ„é€ æ–¹æ³•ï¼Œç„¶ååœ¨æœ‰AttributeSetå‚æ•°çš„æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–å‚æ•°å€¼ï¼Œè¿™ä¸ªæ„é€ æ–¹æ³•æ‰æ˜¯å¸ƒå±€æ–‡ä»¶è¢«æ˜ å°„ä¸ºå¯¹è±¡çš„æ—¶å€™è¢«è°ƒç”¨çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public static class CustomLayoutParams extends MarginLayoutParams &#123;</span><br><span class="line">public static final int POSITION_MIDDLE = 0; // ä¸­é—´</span><br><span class="line">public static final int POSITION_LEFT = 1; // å·¦ä¸Šæ–¹</span><br><span class="line">public static final int POSITION_RIGHT = 2; // å³ä¸Šæ–¹</span><br><span class="line">public static final int POSITION_BOTTOM = 3; // å·¦ä¸‹è§’</span><br><span class="line">public static final int POSITION_RIGHTANDBOTTOM = 4; // å³ä¸‹è§’</span><br><span class="line"></span><br><span class="line">public int position = POSITION_LEFT;  // é»˜è®¤æˆ‘ä»¬çš„ä½ç½®å°±æ˜¯å·¦ä¸Šè§’</span><br><span class="line"></span><br><span class="line">public CustomLayoutParams(Context c, AttributeSet attrs) &#123;</span><br><span class="line">super(c, attrs);</span><br><span class="line">TypedArray a = c.obtainStyledAttributes(attrs,R.styleable.CustomLayout );</span><br><span class="line">//è·å–è®¾ç½®åœ¨å­æ§ä»¶ä¸Šçš„ä½ç½®å±æ€§</span><br><span class="line">position = a.getInt(R.styleable.CustomLayout_layout_position ,position );</span><br><span class="line"></span><br><span class="line">a.recycle();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public CustomLayoutParams( int width, int height) &#123;</span><br><span class="line">super(width, height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public CustomLayoutParams(ViewGroup.LayoutParams source) &#123;</span><br><span class="line">super(source);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="â‘¢-é‡å†™generateLayoutParams"><a href="#â‘¢-é‡å†™generateLayoutParams" class="headerlink" title="â‘¢. é‡å†™generateLayoutParams()"></a>â‘¢. é‡å†™generateLayoutParams()</h5><p>åœ¨ViewGroupä¸­æœ‰ä¸‹é¢å‡ ä¸ªå…³äºLayoutParamsçš„æ–¹æ³•ï¼ŒgenerateLayoutParams (AttributeSet attrs)æ˜¯åœ¨å¸ƒå±€æ–‡ä»¶è¢«å¡«å……ä¸ºå¯¹è±¡çš„æ—¶å€™è°ƒç”¨çš„ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸‹é¢å‡ ä¸ªæ–¹æ³•ä¸­æœ€é‡è¦çš„ï¼Œå¦‚æœä¸é‡å†™å®ƒï¼Œæˆ‘ä¹ˆå¸ƒå±€æ–‡ä»¶ä¸­è®¾ç½®çš„å¸ƒå±€å‚æ•°éƒ½ä¸èƒ½æ‹¿åˆ°ã€‚å…¶ä»–å‡ ä¸ªæ–¹æ³•æˆ‘ä»¬æœ€å¥½ä¹Ÿèƒ½é‡å†™ä¸€ä¸‹ï¼Œå°†é‡Œé¢çš„LayoutParamsæ¢æˆæˆ‘ä»¬è‡ªå®šä¹‰çš„CustomLayoutParamsç±»ï¼Œé¿å…ä»¥åä¼šé‡åˆ°å¸ƒå±€å‚æ•°ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public LayoutParams generateLayoutParams(AttributeSet attrs) &#123;</span><br><span class="line">return new CustomLayoutParams(getContext(), attrs);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected ViewGroup.LayoutParams generateLayoutParams(ViewGroup.LayoutParams p) &#123;</span><br><span class="line">return new CustomLayoutParams (p);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected LayoutParams generateDefaultLayoutParams() &#123;</span><br><span class="line">return new CustomLayoutParams (LayoutParams.MATCH_PARENT , LayoutParams.MATCH_PARENT);</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">protected boolean checkLayoutParams(ViewGroup.LayoutParams p) &#123;</span><br><span class="line">return p instanceof CustomLayoutParams ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="â‘£-åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨å¸ƒå±€å±æ€§"><a href="#â‘£-åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨å¸ƒå±€å±æ€§" class="headerlink" title="â‘£. åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨å¸ƒå±€å±æ€§"></a>â‘£. åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨å¸ƒå±€å±æ€§</h5><p>æ³¨æ„å¼•å…¥å‘½åç©ºé—´xmlns:openxu= â€œ<a href="http://schemas.android.com/apk/res/åŒ…å" target="_blank" rel="noopener">http://schemas.android.com/apk/res/åŒ…å</a>â€œ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding= &quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;com.openxu.costomlayout.CustomLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:openxu= &quot;http://schemas.android.com/apk/res/com.openxu.costomlayout&quot;</span><br><span class="line">android:background=&quot;#33000000&quot;</span><br><span class="line">android:layout_width= &quot;match_parent &quot;</span><br><span class="line">android:layout_height= &quot;match_parent&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;left&quot;</span><br><span class="line">android:background= &quot;#FF8247&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;20dip&quot;</span><br><span class="line">android:padding= &quot;20dip&quot;</span><br><span class="line">android:text= &quot;æŒ‰é’®1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;right&quot;</span><br><span class="line">android:background= &quot;#8B0A50&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize= &quot;18dip&quot;</span><br><span class="line">android:padding= &quot;10dip&quot;</span><br><span class="line">android:text= &quot;æŒ‰é’®2222222222222&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;bottom&quot;</span><br><span class="line">android:background= &quot;#7CFC00&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize= &quot;20dip&quot;</span><br><span class="line">android:padding= &quot;15dip&quot;</span><br><span class="line">android:text= &quot;æŒ‰é’®333333&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;rightAndBottom&quot;</span><br><span class="line">android:background= &quot;#1E90FF&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize= &quot;15dip&quot;</span><br><span class="line">android:padding= &quot;10dip&quot;</span><br><span class="line">android:text= &quot;æŒ‰é’®4&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;center&quot;</span><br><span class="line">android:background= &quot;#191970&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize= &quot;20dip&quot;</span><br><span class="line">android:padding= &quot;15dip&quot;</span><br><span class="line">android:text= &quot;æŒ‰é’®5&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/com.openxu.costomlayout.CustomLayout&gt;</span><br></pre></td></tr></table></figure></p><h5 id="â‘¤-åœ¨onMeasureå’ŒonLayoutä¸­ä½¿ç”¨å¸ƒå±€å‚æ•°"><a href="#â‘¤-åœ¨onMeasureå’ŒonLayoutä¸­ä½¿ç”¨å¸ƒå±€å‚æ•°" class="headerlink" title="â‘¤. åœ¨onMeasureå’ŒonLayoutä¸­ä½¿ç”¨å¸ƒå±€å‚æ•°"></a>â‘¤. åœ¨onMeasureå’ŒonLayoutä¸­ä½¿ç”¨å¸ƒå±€å‚æ•°</h5><p>ç»è¿‡ä¸Šé¢å‡ æ­¥ä¹‹åï¼Œæˆ‘ä»¬è¿è¡Œç¨‹åºï¼Œå°±èƒ½è·å–å­æ§ä»¶çš„å¸ƒå±€å‚æ•°äº†ï¼Œåœ¨onMeasureæ–¹æ³•å’ŒonLayoutæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§è‡ªå®šä¹‰å¸ƒå±€å®¹å™¨çš„ç‰¹æ®Šéœ€æ±‚ï¼Œå¯¹å®½åº¦å’Œä½ç½®åç‰¹æ®Šå¤„ç†ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœå¸ƒå±€å®¹å™¨è¢«è®¾ç½®ä¸ºåŒ…è£¹ç±»å®¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿è¯èƒ½å°†æœ€å¤§çš„å­æ§ä»¶åŒ…è£¹ä½å°±okï¼Œä»£ç æ³¨é‡Šæ¯”è¾ƒè¯¦ç»†ï¼Œå°±ä¸å¤šè¯´äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onMeasure( int widthMeasureSpec, int heightMeasureSpec) &#123; </span><br><span class="line">//è·å¾—æ­¤ViewGroupä¸Šçº§å®¹å™¨ä¸ºå…¶æ¨èçš„å®½å’Œé«˜ï¼Œä»¥åŠè®¡ç®—æ¨¡å¼  </span><br><span class="line">int widthMode = MeasureSpec. getMode(widthMeasureSpec); </span><br><span class="line">int heightMode = MeasureSpec. getMode(heightMeasureSpec); </span><br><span class="line">int sizeWidth = MeasureSpec. getSize(widthMeasureSpec); </span><br><span class="line">int sizeHeight = MeasureSpec. getSize(heightMeasureSpec); </span><br><span class="line">int layoutWidth = 0;</span><br><span class="line">int layoutHeight = 0;</span><br><span class="line">// è®¡ç®—å‡ºæ‰€æœ‰çš„childViewçš„å®½å’Œé«˜</span><br><span class="line">measureChildren(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">int cWidth = 0;</span><br><span class="line">int cHeight = 0;</span><br><span class="line">int count = getChildCount(); </span><br><span class="line"></span><br><span class="line">if(widthMode == MeasureSpec. EXACTLY)&#123;</span><br><span class="line">//å¦‚æœå¸ƒå±€å®¹å™¨çš„å®½åº¦æ¨¡å¼æ˜¯ç¡®å®šçš„ï¼ˆå…·ä½“çš„sizeæˆ–è€…match_parentï¼‰ï¼Œç›´æ¥ä½¿ç”¨çˆ¶çª—ä½“å»ºè®®çš„å®½åº¦</span><br><span class="line">layoutWidth = sizeWidth;</span><br><span class="line">&#125; else&#123;</span><br><span class="line">//å¦‚æœæ˜¯æœªæŒ‡å®šæˆ–è€…wrap_contentï¼Œæˆ‘ä»¬éƒ½æŒ‰ç…§åŒ…è£¹å†…å®¹åšï¼Œå®½åº¦æ–¹å‘ä¸Šåªéœ€è¦æ‹¿åˆ°æ‰€æœ‰å­æ§ä»¶ä¸­å®½åº¦åšå¤§çš„ä½œä¸ºå¸ƒå±€å®½åº¦</span><br><span class="line">for ( int i = 0; i &lt; count; i++)  &#123; </span><br><span class="line">View child = getChildAt(i); </span><br><span class="line">cWidth = child.getMeasuredWidth(); </span><br><span class="line">//è·å–å­æ§ä»¶æœ€å¤§å®½åº¦</span><br><span class="line">layoutWidth = cWidth &gt; layoutWidth ? cWidth : layoutWidth;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">//é«˜åº¦å¾ˆå®½åº¦å¤„ç†æ€æƒ³ä¸€æ ·</span><br><span class="line">if(heightMode == MeasureSpec. EXACTLY)&#123;</span><br><span class="line">layoutHeight = sizeHeight;</span><br><span class="line">&#125; else&#123;</span><br><span class="line">for ( int i = 0; i &lt; count; i++)  &#123; </span><br><span class="line">View child = getChildAt(i); </span><br><span class="line">cHeight = child.getMeasuredHeight();</span><br><span class="line">layoutHeight = cHeight &gt; layoutHeight ? cHeight : layoutHeight;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æµ‹é‡å¹¶ä¿å­˜layoutçš„å®½é«˜</span><br><span class="line">setMeasuredDimension(layoutWidth, layoutHeight);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onLayout( boolean changed, int left, int top, int right,</span><br><span class="line">int bottom) &#123;</span><br><span class="line">final int count = getChildCount();</span><br><span class="line">int childMeasureWidth = 0;</span><br><span class="line">int childMeasureHeight = 0;</span><br><span class="line">CustomLayoutParams params = null;</span><br><span class="line">for ( int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">View child = getChildAt(i);</span><br><span class="line">// æ³¨æ„æ­¤å¤„ä¸èƒ½ä½¿ç”¨getWidthå’ŒgetHeightï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¿…é¡»åœ¨onLayoutæ‰§è¡Œå®Œï¼Œæ‰èƒ½æ­£ç¡®è·å–å®½é«˜</span><br><span class="line">childMeasureWidth = child.getMeasuredWidth();</span><br><span class="line">childMeasureHeight = child.getMeasuredHeight();</span><br><span class="line"></span><br><span class="line">params = (CustomLayoutParams) child.getLayoutParams(); </span><br><span class="line">switch (params. position) &#123;</span><br><span class="line">case CustomLayoutParams. POSITION_MIDDLE:    // ä¸­é—´</span><br><span class="line">left = (getWidth()-childMeasureWidth)/2;</span><br><span class="line">top = (getHeight()-childMeasureHeight)/2;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_LEFT:      // å·¦ä¸Šæ–¹</span><br><span class="line">left = 0;</span><br><span class="line">top = 0;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_RIGHT:     // å³ä¸Šæ–¹</span><br><span class="line">left = getWidth()-childMeasureWidth;</span><br><span class="line">top = 0;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_BOTTOM:    // å·¦ä¸‹è§’</span><br><span class="line">left = 0;</span><br><span class="line">top = getHeight()-childMeasureHeight;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_RIGHTANDBOTTOM:// å³ä¸‹è§’</span><br><span class="line">left = getWidth()-childMeasureWidth;</span><br><span class="line">top = getHeight()-childMeasureHeight;</span><br><span class="line">break;</span><br><span class="line">default:</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç¡®å®šå­æ§ä»¶çš„ä½ç½®ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ï¼ˆå·¦ä¸Šå³ä¸‹ï¼‰ç‚¹çš„åæ ‡å€¼</span><br><span class="line">child.layout(left, top, left+childMeasureWidth, top+childMeasureHeight);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="3-æ”¯æŒlayout-marginå±æ€§"><a href="#3-æ”¯æŒlayout-marginå±æ€§" class="headerlink" title="3. æ”¯æŒlayout_marginå±æ€§"></a>3. æ”¯æŒlayout_marginå±æ€§</h4><p>å¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰çš„å¸ƒå±€å‚æ•°ç±»ç»§æ‰¿è‡ªMarginLayoutParamsï¼Œå°±è‡ªåŠ¨æ”¯æŒäº†layout_marginå±æ€§äº†ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ç›´æ¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½¿ç”¨layout_marginå±æ€§ï¼Œç„¶åå†onMeasureå’ŒonLayoutä¸­ä½¿ç”¨marginå±æ€§å€¼æµ‹é‡å’Œæ‘†æ”¾å­æ§ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬æµ‹é‡å­æ§ä»¶çš„æ—¶å€™åº”è¯¥è°ƒç”¨measureChildWithMargin()æ–¹æ³•ã€‚<br>å¸ƒå±€æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding= &quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;com.openxu.costomlayout.CustomLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:openxu= &quot;http://schemas.android.com/apk/res/com.openxu.costomlayout&quot;</span><br><span class="line">android:background=&quot;#33000000&quot;</span><br><span class="line">android:layout_width= &quot;match_parent&quot;</span><br><span class="line">android:layout_height= &quot;match_parent&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;left&quot;</span><br><span class="line">android:layout_marginLeft = &quot;20dip&quot;</span><br><span class="line">android:background= &quot;#FF8247&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;20dip&quot;</span><br><span class="line">android:padding= &quot;20dip&quot;</span><br><span class="line">android:text=&quot;æŒ‰é’®1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">android:layout_marginTop = &quot;30dip&quot;</span><br><span class="line">openxu:layout_position= &quot;right&quot;</span><br><span class="line">android:background= &quot;#8B0A50&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;18dip&quot;</span><br><span class="line">android:padding= &quot;10dip&quot;</span><br><span class="line">android:text=&quot;æŒ‰é’®2222222222222&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">android:layout_marginLeft = &quot;30dip&quot;</span><br><span class="line">android:layout_marginBottom = &quot;10dip&quot;</span><br><span class="line">openxu:layout_position= &quot;bottom&quot;</span><br><span class="line">android:background= &quot;#7CFC00&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;20dip&quot;</span><br><span class="line">android:padding= &quot;15dip&quot;</span><br><span class="line">android:text=&quot;æŒ‰é’®333333&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;rightAndBottom&quot;</span><br><span class="line">android:layout_marginBottom = &quot;30dip&quot;</span><br><span class="line">android:background= &quot;#1E90FF&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;15dip&quot;</span><br><span class="line">android:padding= &quot;10dip&quot;</span><br><span class="line">android:text=&quot;æŒ‰é’®4&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;Button</span><br><span class="line">android:layout_width= &quot;wrap_content&quot;</span><br><span class="line">android:layout_height= &quot;wrap_content&quot;</span><br><span class="line">openxu:layout_position= &quot;center&quot;</span><br><span class="line">android:layout_marginBottom = &quot;30dip&quot;</span><br><span class="line">android:layout_marginRight = &quot;30dip&quot;</span><br><span class="line">android:background= &quot;#191970&quot;</span><br><span class="line">android:textColor= &quot;#ffffff&quot;</span><br><span class="line">android:textSize=&quot;20dip&quot;</span><br><span class="line">android:padding= &quot;15dip&quot;</span><br><span class="line">android:text=&quot;æŒ‰é’®5&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/com.openxu.costomlayout.CustomLayout&gt;</span><br></pre></td></tr></table></figure></p><p>onMeasureå’ŒonLayoutï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; </span><br><span class="line">// è·å¾—æ­¤ViewGroupä¸Šçº§å®¹å™¨ä¸ºå…¶æ¨èçš„å®½å’Œé«˜ï¼Œä»¥åŠè®¡ç®—æ¨¡å¼   </span><br><span class="line">int widthMode = MeasureSpec. getMode(widthMeasureSpec); </span><br><span class="line">int heightMode = MeasureSpec. getMode(heightMeasureSpec); </span><br><span class="line">int sizeWidth = MeasureSpec. getSize(widthMeasureSpec); </span><br><span class="line">int sizeHeight = MeasureSpec. getSize(heightMeasureSpec); </span><br><span class="line">int layoutWidth = 0;</span><br><span class="line">int layoutHeight = 0;</span><br><span class="line">int cWidth = 0;</span><br><span class="line">int cHeight = 0;</span><br><span class="line">int count = getChildCount(); </span><br><span class="line"></span><br><span class="line">// è®¡ç®—å‡ºæ‰€æœ‰çš„childViewçš„å®½å’Œé«˜</span><br><span class="line">for( int i = 0; i &lt; count; i++)&#123;</span><br><span class="line">View child = getChildAt(i); </span><br><span class="line">measureChildWithMargins(child, widthMeasureSpec, 0, heightMeasureSpec, 0);</span><br><span class="line">&#125;</span><br><span class="line">CustomLayoutParams params = null;</span><br><span class="line">if(widthMode == MeasureSpec. EXACTLY)&#123;</span><br><span class="line">//å¦‚æœå¸ƒå±€å®¹å™¨çš„å®½åº¦æ¨¡å¼æ—¶ç¡®å®šçš„ï¼ˆå…·ä½“çš„sizeæˆ–è€…match_parentï¼‰</span><br><span class="line">layoutWidth = sizeWidth;</span><br><span class="line">&#125; else&#123;</span><br><span class="line">//å¦‚æœæ˜¯æœªæŒ‡å®šæˆ–è€…wrap_contentï¼Œæˆ‘ä»¬éƒ½æŒ‰ç…§åŒ…è£¹å†…å®¹åšï¼Œå®½åº¦æ–¹å‘ä¸Šåªéœ€è¦æ‹¿åˆ°æ‰€æœ‰å­æ§ä»¶ä¸­å®½åº¦åšå¤§çš„ä½œä¸ºå¸ƒå±€å®½åº¦</span><br><span class="line">for ( int i = 0; i &lt; count; i++)  &#123; </span><br><span class="line">View child = getChildAt(i); </span><br><span class="line">cWidth = child.getMeasuredWidth(); </span><br><span class="line">params = (CustomLayoutParams) child.getLayoutParams(); </span><br><span class="line">//è·å–å­æ§ä»¶å®½åº¦å’Œå·¦å³è¾¹è·ä¹‹å’Œï¼Œä½œä¸ºè¿™ä¸ªæ§ä»¶éœ€è¦å æ®çš„å®½åº¦</span><br><span class="line">int marginWidth = cWidth+params.leftMargin+params.rightMargin ;</span><br><span class="line">layoutWidth = marginWidth &gt; layoutWidth ? marginWidth : layoutWidth;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">//é«˜åº¦å¾ˆå®½åº¦å¤„ç†æ€æƒ³ä¸€æ ·</span><br><span class="line">if(heightMode == MeasureSpec. EXACTLY)&#123;</span><br><span class="line">layoutHeight = sizeHeight;</span><br><span class="line">&#125; else&#123;</span><br><span class="line">for ( int i = 0; i &lt; count; i++)  &#123; </span><br><span class="line">View child = getChildAt(i); </span><br><span class="line">cHeight = child.getMeasuredHeight();</span><br><span class="line">params = (CustomLayoutParams) child.getLayoutParams(); </span><br><span class="line">int marginHeight = cHeight+params.topMargin+params.bottomMargin ;</span><br><span class="line">layoutHeight = marginHeight &gt; layoutHeight ? marginHeight : layoutHeight;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æµ‹é‡å¹¶ä¿å­˜layoutçš„å®½é«˜</span><br><span class="line">setMeasuredDimension(layoutWidth, layoutHeight);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onLayout( boolean changed, int left, int top, int right,</span><br><span class="line">int bottom) &#123;</span><br><span class="line">final int count = getChildCount();</span><br><span class="line">int childMeasureWidth = 0;</span><br><span class="line">int childMeasureHeight = 0;</span><br><span class="line">CustomLayoutParams params = null;</span><br><span class="line">for ( int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">View child = getChildAt(i);</span><br><span class="line">childMeasureWidth = child.getMeasuredWidth();</span><br><span class="line">childMeasureHeight = child.getMeasuredHeight();</span><br><span class="line">params = (CustomLayoutParams) child.getLayoutParams(); </span><br><span class="line">switch (params. position) &#123;</span><br><span class="line">case CustomLayoutParams. POSITION_MIDDLE:    // ä¸­é—´</span><br><span class="line">left = (getWidth()-childMeasureWidth)/2 - params.rightMargin + params.leftMargin ;</span><br><span class="line">top = (getHeight()-childMeasureHeight)/2 + params.topMargin - params.bottomMargin ;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_LEFT:      // å·¦ä¸Šæ–¹</span><br><span class="line">left = 0 + params. leftMargin;</span><br><span class="line">top = 0 + params. topMargin;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_RIGHT:     // å³ä¸Šæ–¹</span><br><span class="line">left = getWidth()-childMeasureWidth - params.rightMargin;</span><br><span class="line">top = 0 + params. topMargin;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_BOTTOM:    // å·¦ä¸‹è§’</span><br><span class="line">left = 0 + params. leftMargin;</span><br><span class="line">top = getHeight()-childMeasureHeight-params.bottomMargin ;</span><br><span class="line">break;</span><br><span class="line">case CustomLayoutParams. POSITION_RIGHTANDBOTTOM:// å³ä¸‹è§’</span><br><span class="line">left = getWidth()-childMeasureWidth - params.rightMargin;</span><br><span class="line">top = getHeight()-childMeasureHeight-params.bottomMargin ;</span><br><span class="line">break;</span><br><span class="line">default:</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç¡®å®šå­æ§ä»¶çš„ä½ç½®ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ï¼ˆå·¦ä¸Šå³ä¸‹ï¼‰ç‚¹çš„åæ ‡å€¼</span><br><span class="line">child.layout(left, top, left+childMeasureWidth, top+childMeasureHeight);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œæ•ˆæœï¼š<br><img src="/2017/10/09/Androidè‡ªå®šä¹‰Viewè¯¦ç»†æ•™ç¨‹/5.jpg"></p><p>å¥½äº†ï¼Œå°±å†™åˆ°è¿™é‡Œï¼Œå¦‚æœæƒ³å°è¯•è®¾ç½®å…¶ä»–å±æ€§ï¼Œæ¯”å¦‚aboveã€belowç­‰ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br>æœ€åï¼Œè¦éš†é‡æ¨èä¸€ä¸‹<code>ä½œè€…ï¼šæ‰”ç‰©çº¿</code>å†™çš„å…³äº<a href="http://hencoder.com/ui-1-1/" target="_blank" rel="noopener">è‡ªå®šä¹‰Viewç»˜åˆ¶</a>çš„ä¸€ç³»åˆ—æ–‡ç« ï¼Œå†™çš„çœŸçš„å¾ˆç”¨å¿ƒï¼Œå¤§èµã€‚</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="http://blog.csdn.net/xmxkf/article/details/51454685" target="_blank" rel="noopener">è‡ªå®šä¹‰Viewæ•™ç¨‹1</a><br><a href="https://www.jianshu.com/p/c84693096e41" target="_blank" rel="noopener">è‡ªå®šä¹‰Viewæ•™ç¨‹2</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è‡ªå®šä¹‰Viewä¸€ç›´éƒ½æ˜¯Androidå¼€å‘çš„ä¸€ä¸ªé‡è¦æ¨¡å—ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¹Ÿæ— æ³•é¿å…åœ°ä¼šç”¨åˆ°å®ƒã€‚é‚£ä¹ˆä»Šå¤©å°±æ¥è¯¦ç»†çš„æ¢³ç†ä¸€ä¸‹è¿™ä¸€å—çš„çŸ¥è¯†ç‚¹å§ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="è‡ªå®šä¹‰View" scheme="http://yoursite.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89View/"/>
    
  </entry>
  
  <entry>
    <title>Retrofitä½¿ç”¨è¯¦è§£åŠæºç åˆ†æ</title>
    <link href="http://yoursite.com/2017/09/06/Retrofit%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3%E5%8F%8A%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2017/09/06/Retrofitä½¿ç”¨è¯¦è§£åŠæºç åˆ†æ/</id>
    <published>2017-09-06T12:24:20.000Z</published>
    <updated>2018-03-07T12:22:22.042Z</updated>
    
    <content type="html"><![CDATA[<p>Retrofitæ˜¯Squareå›¢é˜Ÿæ——ä¸‹ä¸€ä¸ªçŸ¥åçš„Androidç½‘ç»œè¯·æ±‚åº“ï¼Œå‡†ç¡®çš„è¯´ï¼Œå®ƒæ˜¯ç”±Squareå¯¹okhttpå†æ¬¡å°è£…æ‰€æˆã€‚æœ¬ç« åœ¨è¯¦ç»†çš„ä»‹ç»Retrofitç”¨æ³•çš„åŒæ—¶ï¼Œè¿˜ä¼šåˆ†æå®ƒçš„å‰ä¸–ä»Šç”Ÿï¼ŒåŒ…æ‹¬okhttpä»‹ç»ã€æºç åˆ†æã€javaæ³¨è§£çš„æŒæ¡ä»¥åŠRetrofitçš„äºŒæ¬¡å°è£…çŸ¥è¯†ã€‚<a id="more"></a></p><h1 id="ä»okhttpçš„ä½¿ç”¨è®²èµ·"><a href="#ä»okhttpçš„ä½¿ç”¨è®²èµ·" class="headerlink" title="ä»okhttpçš„ä½¿ç”¨è®²èµ·"></a>ä»okhttpçš„ä½¿ç”¨è®²èµ·</h1><p>å‰é¢è¯´äº†Retrofitæ˜¯åœ¨Okhttpçš„åŸºç¡€ä¹‹ä¸Šå‘å±•èµ·æ¥ï¼Œé‚£ä¹ˆè¦æƒ³å…¨é¢çš„ç†è§£ä¹‹ï¼Œè¿˜æ˜¯è¦æŠŠokhttpè¿™å—çš„ç”¨æ³•ææ‡‚çš„ï¼ˆä¸æ¶‰åŠæºç ï¼‰ï¼Œä¸‹é¢å°±ä»okhttpå¼€å§‹å§ï½</p><h2 id="okHttpä¸»è¦ç±»"><a href="#okHttpä¸»è¦ç±»" class="headerlink" title="okHttpä¸»è¦ç±»"></a>okHttpä¸»è¦ç±»</h2><p>ä¸‹é¢æ˜¯okhttpçš„å‡ å¤§ä¸»è¦ç±»ï¼Œè¿™ä¸€éƒ¨åˆ†çš„å†…å®¹å°±å›´ç»•å®ƒä»¬è¿›è¡Œã€‚<br>OkHttpClient.java<br>Request.java<br>Call.java<br>RequestBody.java<br>Response.java</p><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><h4 id="HTTP-GET"><a href="#HTTP-GET" class="headerlink" title="HTTP GET"></a>HTTP GET</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package okhttp3.guide;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import okhttp3.OkHttpClient;</span><br><span class="line">import okhttp3.Request;</span><br><span class="line">import okhttp3.Response;</span><br><span class="line"></span><br><span class="line">public class GetExample &#123;</span><br><span class="line">OkHttpClient client = new OkHttpClient();</span><br><span class="line"></span><br><span class="line">String run(String url) throws IOException &#123;</span><br><span class="line">Request request = new Request.Builder()</span><br><span class="line">.url(url)</span><br><span class="line">.build();</span><br><span class="line"></span><br><span class="line">Response response = client.newCall(request).execute();</span><br><span class="line">return response.body().string();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws IOException &#123;</span><br><span class="line">GetExample example = new GetExample();</span><br><span class="line">String response = example.run(&quot;https://raw.github.com/square/okhttp/master/README.md&quot;);</span><br><span class="line">System.out.println(response);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸Šé¢æ‰§è¡Œçš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</strong><br>ç¬¬ä¸€æ­¥ï¼Œåœ¨ç¨‹åºç¬¬9è¡Œå¤„è·å–äº†okhttpclientçš„å®ä¾‹ï¼›<br>ç¬¬äºŒæ­¥ï¼Œåœ¨ç¨‹åºç¬¬12è¡Œå¤„ï¼Œé€šè¿‡<code>Request.Builder()</code>æ„å»ºä¸€ä¸ªrequestè¯·æ±‚å¯¹è±¡ï¼Œè¿™é‡Œå¯ä»¥é…ç½®è®¸å¤šç½‘ç»œè¯·æ±‚æ‰€éœ€çš„å‚æ•°ï¼šurlã€headerã€postå¯¹è±¡ç­‰ã€‚<br>ç¬¬ä¸‰æ­¥ï¼Œåœ¨ç¨‹åºç¬¬16è¡Œå¤„ï¼Œé€šè¿‡Callç±»çš„<code>execute()</code>åŒæ­¥æ–¹æ³•è¿”å›ä¸€ä¸ªresponseå“åº”å¯¹è±¡ï¼Œå¯¹è±¡ä¸­åŒ…å«äº†æœåŠ¡ç«¯è¿”å›çš„å­—ç¬¦ä¸²ä¿¡æ¯ã€‚<br>è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„Http Getæµç¨‹ç®—æ˜¯å®Œæˆäº†ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯:<br>1ã€åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œæˆ‘ä»¬è¯´é€šè¿‡<code>Request.Builder()</code>å¯ä»¥é…ç½®è®¸å¤šç½‘ç»œè¯·æ±‚ç›¸å…³çš„ä¿¡æ¯ï¼Œå…¶å®æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>okHttpClient.newBuilder()</code>æ–¹æ³•é…ç½®ä¸€äº›æ›´åŠ å…¨å±€çš„ç½‘ç»œå‚æ•°ï¼Œæ¯”å¦‚ï¼šæ‹¦æˆªå™¨ã€è¶…æ—¶æ—¶é—´ç­‰ã€‚<br>2ã€åœ¨ç¬¬äºŒæ­¥ä¸­æåˆ°é…ç½®çš„å‚æ•°å¯ä»¥æ˜¯postå¯¹è±¡ï¼Œå®ƒå¯¹åº”çš„æ–¹æ³•æ˜¯<code>post(RequestBody body)</code>ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰æä¾›ç±»ä¼¼get(T params)çš„æ–¹æ³•ä¾›è¯·æ±‚å‚æ•°çš„é…ç½®å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ²¡æœ‰ã€‚æ‰€ä»¥å¦‚æœéœ€è¦åœ¨urlä¸­é…ç½®è¯·æ±‚å‚æ•°ï¼Œè¿˜éœ€è¦ä»¥æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹å¼å®Œæˆã€‚<br>3ã€åœ¨ç¬¬ä¸‰æ­¥ä¸­é™¤äº†èƒ½ç”¨Callç±»çš„execute()åŒæ­¥æ–¹æ³•è¿”å›å“åº”ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®ƒçš„<code>enqueue()</code>æ–¹æ³•å¼‚æ­¥è¿”å›å“åº”ä¿¡æ¯ï¼Œè¿™é‡Œè¦çœ‹å…·ä½“çš„ä½¿ç”¨åœºæ™¯äº†ã€‚</p><h4 id="HTTP-POST"><a href="#HTTP-POST" class="headerlink" title="HTTP POST"></a>HTTP POST</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public class PostExample &#123;</span><br><span class="line">public static final MediaType JSON</span><br><span class="line">= MediaType.parse(&quot;application/json; charset=utf-8&quot;);</span><br><span class="line"></span><br><span class="line">OkHttpClient client = new OkHttpClient();</span><br><span class="line"></span><br><span class="line">String post(String url, String json) throws IOException &#123;</span><br><span class="line">RequestBody body = RequestBody.create(JSON, json);</span><br><span class="line">Request request = new Request.Builder()</span><br><span class="line">.url(url)</span><br><span class="line">.post(body)</span><br><span class="line">.build();</span><br><span class="line">try (Response response = client.newCall(request).execute()) &#123;</span><br><span class="line">return response.body().string();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String bowlingJson(String player1, String player2) &#123;</span><br><span class="line">return &quot;&#123;&apos;winCondition&apos;:&apos;HIGH_SCORE&apos;,&quot;</span><br><span class="line">+ &quot;&apos;name&apos;:&apos;Bowling&apos;,&quot;</span><br><span class="line">+ &quot;&apos;round&apos;:4,&quot;</span><br><span class="line">+ &quot;&apos;lastSaved&apos;:1367702411696,&quot;</span><br><span class="line">+ &quot;&apos;dateStarted&apos;:1367702378785,&quot;</span><br><span class="line">+ &quot;&apos;players&apos;:[&quot;</span><br><span class="line">+ &quot;&#123;&apos;name&apos;:&apos;&quot; + player1 + &quot;&apos;,&apos;history&apos;:[10,8,6,7,8],&apos;color&apos;:-13388315,&apos;total&apos;:39&#125;,&quot;</span><br><span class="line">+ &quot;&#123;&apos;name&apos;:&apos;&quot; + player2 + &quot;&apos;,&apos;history&apos;:[6,10,5,10,10],&apos;color&apos;:-48060,&apos;total&apos;:41&#125;&quot;</span><br><span class="line">+ &quot;]&#125;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) throws IOException &#123;</span><br><span class="line">PostExample example = new PostExample();</span><br><span class="line">String json = example.bowlingJson(&quot;Jesse&quot;, &quot;Jake&quot;);</span><br><span class="line">String response = example.post(&quot;http://www.roundsapp.com/post&quot;, json);</span><br><span class="line">System.out.println(response);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯ä¸€ä¸ªå‘æœåŠ¡ç«¯å‘é€Postè¯·æ±‚çš„ä¾‹å­ï¼Œä»”ç»†è§‚å¯Ÿå‘ç°å®ƒå’ŒGetéƒ¨åˆ†çš„ä¸åŒä¹‹å¤„ä¸»è¦åœ¨äºç¬¬11è¡Œçš„<code>post(body)</code>é…ç½®æ–¹æ³•ã€‚å‚æ•°bodyæ˜¯æˆ‘ä»¬éœ€è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼Œä»–æ˜¯RequestBodyç±»å‹çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”±<code>RequestBody.create(MediaType contentType, T t)</code>æ–¹æ³•ç”Ÿæˆã€‚MediaTypeä»£è¡¨æ¶ˆæ¯å†…å®¹çš„ç±»å‹ï¼Œå…·ä½“å¯ç¿»é˜…<a href="https://www.iana.org/assignments/media-types/media-types.xhtml" target="_blank" rel="noopener">Media Types</a>ã€<a href="http://www.w3school.com.cn/media/media_mimeref.asp" target="_blank" rel="noopener">MIME å‚è€ƒæ‰‹å†Œ</a>è¿™ä¸¤ç¯‡æ–‡ç« ã€‚åé¢çš„Tå¯¹è±¡ç”±MediaTypeçš„ç±»å‹å†³å®šï¼Œå¯ä»¥çœ‹å‡ºRequestBody.createæ˜¯ä¸€ä¸ªé‡è½½æ–¹æ³•ã€‚<br>å¯¹äºRequestBodyï¼Œapiè¿˜æä¾›äº†å®ƒçš„ä¸¤ä¸ªå®ç°ç±»ï¼šFormBodyã€MultipartBodyï¼Œåˆ†åˆ«å¯¹åº”è¡¨å•å’Œæ–‡ä»¶çš„ä¸Šä¼ ã€‚<br>å½“ç„¶ï¼ŒOkHttpåœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½è¿˜ä¼šæ¶‰åŠåˆ°éœ€è¦é‡å¤éªŒè¯çš„é—®é¢˜ï¼Œå…·ä½“è¯·ç»“åˆ<a href="https://howtoprogram.xyz/2016/11/03/basic-authentication-okhttp-example/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ä»¥åŠæ˜é‡‘ç½‘çš„<a href="https://juejin.im/entry/584144d0128fe1006c3cfb8f" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>çœ‹çœ‹ã€‚</p><h1 id="Retrofitçš„ä½¿ç”¨"><a href="#Retrofitçš„ä½¿ç”¨" class="headerlink" title="Retrofitçš„ä½¿ç”¨"></a>Retrofitçš„ä½¿ç”¨</h1><p>æœ‰äº†å‰é¢okhttpçš„ä½¿ç”¨ç»éªŒï¼Œå†æ¥è¯´Retrofitçš„ä½¿ç”¨å°±ç®€å•äº†ã€‚Retrofitå…¶å®è´¨å°±æ˜¯å¯¹okHttpçš„å°è£…ï¼Œä½¿ç”¨é¢å‘æ¥å£çš„æ–¹å¼è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œåˆ©ç”¨åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»å°è£…äº†ç½‘ç»œæ¥å£ã€‚Retrofitéå¸¸é€‚åˆäº RESTful é£æ ¼çš„è¯·æ±‚ï¼Œä½¿ç”¨<a href="https://www.cnblogs.com/whoislcj/p/5671622.html" target="_blank" rel="noopener">æ³¨è§£çš„æ–¹å¼</a>æä¾›åŠŸèƒ½ï¼Œå¯¹äº<strong>æ³¨è§£</strong>ä¸äº†è§£çš„åŒå­¦ï¼Œè¿˜å¯ä»¥ç»“åˆ<a href="http://blog.csdn.net/yubotianxiao/article/details/51861663" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>çœ‹çœ‹ã€‚</p><blockquote><p><strong>RESTfulç‰¹å¾ï¼š</strong><br>URLå®šä½èµ„æºï¼Œç”¨HTTPåŠ¨è¯ï¼ˆGET,POST,DELETE,DETCï¼‰æè¿°æ“ä½œã€‚</p></blockquote><h2 id="ç”¨æ³•ä»‹ç»"><a href="#ç”¨æ³•ä»‹ç»" class="headerlink" title="ç”¨æ³•ä»‹ç»"></a>ç”¨æ³•ä»‹ç»</h2><h4 id="åˆ›å»ºAPIæ¥å£"><a href="#åˆ›å»ºAPIæ¥å£" class="headerlink" title="åˆ›å»ºAPIæ¥å£"></a>åˆ›å»ºAPIæ¥å£</h4><p>åœ¨retrofitä¸­é€šè¿‡ä¸€ä¸ªJavaæ¥å£ä½œä¸ºhttpè¯·æ±‚çš„apiæ¥å£ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//å®šä»¥æ¥å£</span><br><span class="line">public interface GitHubService &#123;</span><br><span class="line">@GET(&quot;users/&#123;user&#125;/repos&quot;)</span><br><span class="line">Call&lt;List&lt;Repo&gt;&gt; listRepos(@Path(&quot;user&quot;) String user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="åˆ›å»ºRetrofitå®ä¾‹"><a href="#åˆ›å»ºRetrofitå®ä¾‹" class="headerlink" title="åˆ›å»ºRetrofitå®ä¾‹"></a>åˆ›å»ºRetrofitå®ä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/**è·å–å®ä¾‹*/</span><br><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">//è®¾ç½®OKHttpClient,å¦‚æœä¸è®¾ç½®ä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„</span><br><span class="line">.client(new OkHttpClient())</span><br><span class="line">//è®¾ç½®baseUrl</span><br><span class="line">.baseUrl(&quot;https://api.github.com/&quot;)</span><br><span class="line">//æ·»åŠ Gsonè½¬æ¢å™¨</span><br><span class="line">.addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>1.retrofit2.0åï¼šBaseUrlè¦ä»¥/ç»“å°¾ï¼›@GET ç­‰è¯·æ±‚ä¸è¦ä»¥/å¼€å¤´ï¼›@Url: å¯ä»¥å®šä¹‰å®Œæ•´urlï¼Œä¸è¦ä»¥ / å¼€å¤´ã€‚<br>2.addConverterFactoryæä¾›Gsonæ”¯æŒï¼Œå¯ä»¥æ·»åŠ å¤šç§åºåˆ—åŒ–Factoryï¼Œä½†æ˜¯GsonConverterFactoryå¿…é¡»æ”¾åœ¨æœ€å,å¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p></blockquote><h4 id="è°ƒç”¨APIæ¥å£"><a href="#è°ƒç”¨APIæ¥å£" class="headerlink" title="è°ƒç”¨APIæ¥å£"></a>è°ƒç”¨APIæ¥å£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">GitHubService service = retrofit.create(GitHubService.class);</span><br><span class="line"></span><br><span class="line">//åŒæ­¥è¯·æ±‚</span><br><span class="line">//https://api.github.com/users/octocat/repos</span><br><span class="line">Call&lt;List&lt;Repo&gt;&gt; call = service.listRepos(&quot;octocat&quot;);</span><br><span class="line">try &#123;</span><br><span class="line">Response&lt;List&lt;Repo&gt;&gt; repos  = call.execute();</span><br><span class="line">&#125; catch (IOException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//ä¸ç®¡åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Œcallåªèƒ½æ‰§è¡Œä¸€æ¬¡ã€‚å¦åˆ™ä¼šæŠ› IllegalStateException</span><br><span class="line">Call&lt;List&lt;Repo&gt;&gt; clone = call.clone();</span><br><span class="line"></span><br><span class="line">//å¼‚æ­¥è¯·æ±‚</span><br><span class="line">clone.enqueue(new Callback&lt;List&lt;Repo&gt;&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onResponse(Response&lt;List&lt;Repo&gt;&gt; response, Retrofit retrofit) &#123;</span><br><span class="line">// Get result bean from response.body()</span><br><span class="line">List&lt;Repo&gt; repos = response.body();</span><br><span class="line">// Get header item from response</span><br><span class="line">String links = response.headers().get(&quot;Link&quot;);</span><br><span class="line">/**</span><br><span class="line">* ä¸åŒäºretrofit1 å¯ä»¥åŒæ—¶æ“ä½œåºåˆ—åŒ–æ•°æ®javabeanå’Œheader</span><br><span class="line">*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onFailure(Throwable throwable) &#123;</span><br><span class="line">showlog(throwable.getCause().toString());   </span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="å–æ¶ˆè¯·æ±‚"><a href="#å–æ¶ˆè¯·æ±‚" class="headerlink" title="å–æ¶ˆè¯·æ±‚"></a>å–æ¶ˆè¯·æ±‚</h4><p>æˆ‘ä»¬å¯ä»¥ç»ˆæ­¢ä¸€ä¸ªè¯·æ±‚ã€‚ç»ˆæ­¢æ“ä½œæ˜¯å¯¹åº•å±‚çš„httpclientæ‰§è¡Œcancelæ“ä½œã€‚å³ä½¿æ˜¯æ­£åœ¨æ‰§è¡Œçš„è¯·æ±‚ï¼Œä¹Ÿèƒ½å¤Ÿç«‹å³ç»ˆæ­¢ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call.cancel();</span><br></pre></td></tr></table></figure></p><h4 id="retrofitæ³¨è§£"><a href="#retrofitæ³¨è§£" class="headerlink" title="retrofitæ³¨è§£"></a>retrofitæ³¨è§£</h4><ul><li>æ–¹æ³•æ³¨è§£ï¼ŒåŒ…å«@GETã€@POSTã€@PUTã€@DELETEã€@PATHã€@HEADã€@OPTIONSã€@HTTPã€‚</li><li>æ ‡è®°æ³¨è§£ï¼ŒåŒ…å«@FormUrlEncodedã€@Multipartã€@Streamingã€‚</li><li>å‚æ•°æ³¨è§£ï¼ŒåŒ…å«@Queryã€@QueryMapã€@Bodyã€@Fieldï¼Œ@FieldMapã€@Partï¼Œ@PartMapã€‚</li><li>å…¶ä»–æ³¨è§£ï¼ŒåŒ…å«@Pathã€@Headerã€@Headersã€@Urlã€‚</li></ul><h5 id="1-ä¸€èˆ¬çš„getè¯·æ±‚"><a href="#1-ä¸€èˆ¬çš„getè¯·æ±‚" class="headerlink" title="(1)ä¸€èˆ¬çš„getè¯·æ±‚"></a>(1)ä¸€èˆ¬çš„getè¯·æ±‚</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface IWeatherGet &#123;</span><br><span class="line">@GET(&quot;GetMoreWeather?cityCode=101020100&amp;weatherType=0&quot;)</span><br><span class="line">Call&lt;Weather&gt; getWeather();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªgetWeather(ï¼‰æ–¹æ³•ï¼Œé€šè¿‡@GETæ³¨è§£æ ‡è¯†ä¸ºgetè¯·æ±‚ï¼Œ@GETä¸­æ‰€å¡«å†™çš„valueå’ŒbaseUrlç»„æˆå®Œæ•´çš„è·¯å¾„ï¼ŒbaseUrlåœ¨æ„é€ retrofitå¯¹è±¡æ—¶ç»™å‡ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">/**http://weather.51wnl.com/weatherinfo/GetMoreWeather?cityCode=101020100&amp;weatherType=0*/</span><br><span class="line">//æ³¨æ„baseurlè¦ä»¥/ç»“å°¾</span><br><span class="line">.baseUrl(&quot;http://weather.51wnl.com/weatherinfo/&quot;)</span><br><span class="line">.addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">.build();</span><br><span class="line">IWeatherGet weather = retrofit.create(IWeatherGet.class);</span><br><span class="line">Call&lt;Weather&gt; call = weather.getWeather();</span><br><span class="line">call.enqueue(new Callback&lt;Weather&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onResponse(Response&lt;Weather&gt; response, Retrofit retrofit) &#123;</span><br><span class="line">Weather weather = response.body();</span><br><span class="line">WeatherInfo weatherinfo = weather.weatherinfo;</span><br><span class="line">showlog(&quot;weather=&quot;+weatherinfo.toString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onFailure(Throwable throwable) &#123;</span><br><span class="line">showlog(throwable.getCause().toString());       </span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h5 id="ï¼ˆ2ï¼‰åŠ¨æ€urlè®¿é—®-PATH"><a href="#ï¼ˆ2ï¼‰åŠ¨æ€urlè®¿é—®-PATH" class="headerlink" title="ï¼ˆ2ï¼‰åŠ¨æ€urlè®¿é—®@PATH"></a>ï¼ˆ2ï¼‰åŠ¨æ€urlè®¿é—®@PATH</h5><p>ä¸Šé¢è¯´çš„@GETæ³¨è§£æ˜¯å°†baseUrlå’Œ@GETä¸­çš„valueç»„æˆå®Œæ•´çš„è·¯å¾„ã€‚æœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥å°†è·¯å¾„ä¸­æŸä¸ªå­—ç¬¦ä¸²è®¾ç½®ä¸ºä¸åŒçš„å€¼æ¥è¯·æ±‚ä¸åŒçš„æ•°æ®ï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>è­¬å¦‚ï¼š<br>å¯ä»¥é€šè¿‡retrofitæä¾›çš„@PATHæ³¨è§£éå¸¸æ–¹ä¾¿çš„å®Œæˆä¸Šè¿°éœ€æ±‚ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface IWeatherPath &#123;</span><br><span class="line">@GET(&quot;&#123;info&#125;?cityCode=101020100&amp;weatherType=0&quot;)</span><br><span class="line">Call&lt;Weather&gt; getWeather(@Path(&quot;info&quot;) String info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªgetWeatheræ–¹æ³•ï¼Œæ–¹æ³•æ¥æ”¶ä¸€ä¸ªinfoå‚æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„@GETæ³¨è§£ä¸­ä½¿ç”¨{info}?cityCode=101020100&amp;weatherType=0å£°æ˜äº†è®¿é—®è·¯å¾„ï¼Œè¿™é‡Œä½ å¯ä»¥æŠŠ{info}å½“åšå ä½ç¬¦ï¼Œè€Œå®é™…è¿è¡Œä¸­ä¼šé€šè¿‡@PATH(â€œinfoâ€)æ‰€æ ‡æ³¨çš„å‚æ•°è¿›è¡Œæ›¿æ¢ã€‚</p><h5 id="ï¼ˆ3ï¼‰æŸ¥è¯¢å‚æ•°çš„è®¾ç½®-Query-QueryMap"><a href="#ï¼ˆ3ï¼‰æŸ¥è¯¢å‚æ•°çš„è®¾ç½®-Query-QueryMap" class="headerlink" title="ï¼ˆ3ï¼‰æŸ¥è¯¢å‚æ•°çš„è®¾ç½®@Query@QueryMap"></a>ï¼ˆ3ï¼‰æŸ¥è¯¢å‚æ•°çš„è®¾ç½®@Query@QueryMap</h5><p>æ–‡ç« å¼€å¤´æè¿‡ï¼Œretrofitéå¸¸é€‚ç”¨äºrestful urlçš„æ ¼å¼ï¼Œé‚£ä¹ˆä¾‹å¦‚ä¸‹é¢è¿™æ ·çš„urlï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ç”¨äºè®¿é—®ä¸Šæµ·å¤©æ°”</span><br><span class="line">http://weather.51wnl.com/weatherinfo/GetMoreWeather?cityCode=101020100&amp;weatherType=0</span><br><span class="line"></span><br><span class="line">//ç”¨äºè®¿é—®åŒ—äº¬å¤©æ°”</span><br><span class="line">http://weather.51wnl.com/weatherinfo/GetMoreWeather?cityCode=101010100&amp;weatherType=0</span><br></pre></td></tr></table></figure></p><p>å³é€šè¿‡ä¼ å‚æ–¹å¼ä½¿ç”¨ä¸åŒçš„citycodeè®¿é—®ä¸åŒåŸå¸‚çš„å¤©æ°”ï¼Œè¿”å›æ•°æ®ä¸ºjsonå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡@Queryæ³¨è§£æ–¹ä¾¿çš„å®Œæˆï¼Œæˆ‘ä»¬å†æ¬¡åœ¨æ¥å£ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public interface IWeatherQuery &#123;</span><br><span class="line">@GET(&quot;GetMoreWeather&quot;)</span><br><span class="line">Call&lt;Weather&gt; getWeather(@Query(&quot;cityCode&quot;) String cityCode, @Query(&quot;weatherType&quot;) String weatherType);</span><br><span class="line">&#125;</span><br><span class="line">/**çœç•¥retrofitçš„æ„å»ºä»£ç */</span><br><span class="line">Call&lt;Weather&gt; call = weather.getWeather(&quot;101020100&quot;, &quot;0&quot;);</span><br><span class="line">//Call&lt;Weather&gt; call = weather.getWeather(&quot;101010100&quot;, &quot;0&quot;);</span><br><span class="line">/**çœç•¥callæ‰§è¡Œç›¸å…³ä»£ç */</span><br></pre></td></tr></table></figure></p><p>å½“æˆ‘ä»¬çš„å‚æ•°è¿‡å¤šçš„æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡@QueryMapæ³¨è§£å’Œmapå¯¹è±¡å‚æ•°æ¥æŒ‡å®šæ¯ä¸ªè¡¨å•é¡¹çš„Keyï¼Œvalueçš„å€¼ï¼ŒåŒæ ·æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œè¿˜å¯ä»¥è¿™æ ·å†™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface IWeatherQueryMap &#123;</span><br><span class="line">@GET(&quot;GetMoreWeather&quot;)</span><br><span class="line">Call&lt;Weather&gt; getWeather(@QueryMap Map&lt;String,String&gt; map);</span><br><span class="line">&#125;</span><br><span class="line">//çœç•¥retrofitçš„æ„å»ºä»£ç </span><br><span class="line">Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();</span><br><span class="line">map.put(&quot;cityCode&quot;, &quot;101020100&quot;);</span><br><span class="line">map.put(&quot;weatherType&quot;, &quot;0&quot;);</span><br><span class="line">Call&lt;Weather&gt; call = weather.getWeather(map);</span><br><span class="line">//çœç•¥callæ‰§è¡Œç›¸å…³ä»£ç </span><br></pre></td></tr></table></figure></p><h5 id="ï¼ˆ4ï¼‰POSTè¯·æ±‚ä½“æ–¹å¼å‘æœåŠ¡å™¨ä¼ å…¥jsonå­—ç¬¦ä¸²-Body"><a href="#ï¼ˆ4ï¼‰POSTè¯·æ±‚ä½“æ–¹å¼å‘æœåŠ¡å™¨ä¼ å…¥jsonå­—ç¬¦ä¸²-Body" class="headerlink" title="ï¼ˆ4ï¼‰POSTè¯·æ±‚ä½“æ–¹å¼å‘æœåŠ¡å™¨ä¼ å…¥jsonå­—ç¬¦ä¸²@Body"></a>ï¼ˆ4ï¼‰POSTè¯·æ±‚ä½“æ–¹å¼å‘æœåŠ¡å™¨ä¼ å…¥jsonå­—ç¬¦ä¸²@Body</h5><p>æˆ‘ä»¬appå¾ˆå¤šæ—¶å€™è·ŸæœåŠ¡å™¨é€šä¿¡ï¼Œä¼šé€‰æ‹©ç›´æ¥ä½¿ç”¨POSTæ–¹å¼å°†jsonå­—ç¬¦ä¸²ä½œä¸ºè¯·æ±‚ä½“å‘é€åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªéœ€æ±‚ä½¿ç”¨retrofitè¯¥å¦‚ä½•å®ç°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public interface IUser &#123;</span><br><span class="line">@POST(&quot;add&quot;)</span><br><span class="line">Call&lt;List&lt;User&gt;&gt; addUser(@Body User user);</span><br><span class="line">&#125;</span><br><span class="line">/çœç•¥retrofitçš„æ„å»ºä»£ç </span><br><span class="line">Call&lt;List&lt;User&gt;&gt; call = user.addUser(new User(&quot;watson&quot;, &quot;male&quot;, &quot;28&quot;));</span><br><span class="line">//çœç•¥callæ‰§è¡Œç›¸å…³ä»£ç </span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°å…¶å®å°±æ˜¯ä½¿ç”¨@Bodyè¿™ä¸ªæ³¨è§£æ ‡è¯†æˆ‘ä»¬çš„å‚æ•°å¯¹è±¡å³å¯ï¼Œé‚£ä¹ˆè¿™é‡Œéœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œretrofitæ˜¯å¦‚ä½•å°†userå¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å‘¢ï¼Ÿå°†å®ä¾‹å¯¹è±¡æ ¹æ®è½¬æ¢æ–¹å¼è½¬æ¢ä¸ºå¯¹åº”çš„jsonå­—ç¬¦ä¸²å‚æ•°ï¼Œè¿™ä¸ªè½¬åŒ–æ–¹å¼æ˜¯GsonConverterFactoryå®šä¹‰çš„ã€‚<br>å¯¹åº”okhttpï¼Œè¿˜æœ‰ä¸¤ç§requestBodyï¼Œä¸€ä¸ªæ˜¯FormBodyï¼Œä¸€ä¸ªæ˜¯MultipartBodyï¼Œå‰è€…ä»¥è¡¨å•çš„æ–¹å¼ä¼ é€’ç®€å•çš„é”®å€¼å¯¹ï¼Œåè€…ä»¥è¡¨å•çš„æ–¹å¼ä¸Šä¼ æ–‡ä»¶å¯ä»¥æºå¸¦å‚æ•°ï¼Œretrofitä¹ŸäºŒè€…ä¹Ÿæœ‰å¯¹åº”çš„æ³¨è§£ï¼Œä¸‹é¢ç»§ç»­~</p><h5 id="ï¼ˆ5ï¼‰è¡¨å•çš„æ–¹å¼ä¼ é€’é”®å€¼å¯¹-FormUrlEncoded-Field-FieldMap"><a href="#ï¼ˆ5ï¼‰è¡¨å•çš„æ–¹å¼ä¼ é€’é”®å€¼å¯¹-FormUrlEncoded-Field-FieldMap" class="headerlink" title="ï¼ˆ5ï¼‰è¡¨å•çš„æ–¹å¼ä¼ é€’é”®å€¼å¯¹@FormUrlEncoded + @Field@FieldMap"></a>ï¼ˆ5ï¼‰è¡¨å•çš„æ–¹å¼ä¼ é€’é”®å€¼å¯¹@FormUrlEncoded + @Field@FieldMap</h5><p>è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªç™»å½•çš„æ–¹æ³•ï¼Œæ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public interface IUser &#123;</span><br><span class="line">@FormUrlEncoded</span><br><span class="line">@POST(&quot;login&quot;)   </span><br><span class="line">Call&lt;User&gt; login(@Field(&quot;username&quot;) String username, @Field(&quot;password&quot;) String password);</span><br><span class="line">&#125;</span><br><span class="line">//çœç•¥retrofitçš„æ„å»ºä»£ç </span><br><span class="line">Call&lt;User&gt; call = user.login(&quot;watson&quot;, &quot;123&quot;);</span><br><span class="line">//çœç•¥callæ‰§è¡Œç›¸å…³ä»£ç </span><br></pre></td></tr></table></figure></p><p>çœ‹èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œé€šè¿‡@POSTæŒ‡æ˜urlï¼Œæ·»åŠ FormUrlEncodedï¼Œç„¶åé€šè¿‡@Fieldæ·»åŠ å‚æ•°å³å¯ã€‚<br>å½“æˆ‘ä»¬æœ‰å¾ˆå¤šä¸ªè¡¨å•å‚æ•°æ—¶ä¹Ÿå¯ä»¥é€šè¿‡@FieldMapæ³¨è§£å’ŒMapå¯¹è±¡å‚æ•°æ¥æŒ‡å®šæ¯ä¸ªè¡¨å•é¡¹çš„Keyï¼Œvalueçš„å€¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public interface IUser &#123;</span><br><span class="line">@FormUrlEncoded</span><br><span class="line">@POST(&quot;login&quot;)   </span><br><span class="line">Call&lt;User&gt; login(@FieldMap Map&lt;String,String&gt; fieldMap);</span><br><span class="line">&#125;</span><br><span class="line">//çœç•¥retrofitçš„æ„å»ºä»£ç </span><br><span class="line">Map&lt;String, String&gt; propertity = new HashMap&lt;String, String&gt;();</span><br><span class="line">positories.put(&quot;name&quot;, &quot;watson&quot;);</span><br><span class="line">positories.put(&quot;password&quot;, &quot;123&quot;);</span><br><span class="line">Call&lt;User&gt; call = user.login(propertity);</span><br><span class="line">//çœç•¥callæ‰§è¡Œç›¸å…³ä»£ç </span><br></pre></td></tr></table></figure></p><h5 id="ï¼ˆ6ï¼‰æ–‡ä»¶ä¸Šä¼ -Multipart-Part-PartMap"><a href="#ï¼ˆ6ï¼‰æ–‡ä»¶ä¸Šä¼ -Multipart-Part-PartMap" class="headerlink" title="ï¼ˆ6ï¼‰æ–‡ä»¶ä¸Šä¼ @Multipart + @Part@PartMap"></a>ï¼ˆ6ï¼‰æ–‡ä»¶ä¸Šä¼ @Multipart + @Part@PartMap</h5><p>1.ä¸‹é¢å…ˆçœ‹ä¸€ä¸‹å•æ–‡ä»¶ä¸Šä¼ ï¼Œä¾ç„¶æ˜¯å†æ¬¡æ·»åŠ ä¸ªæ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface IUser &#123;</span><br><span class="line">@Multipart</span><br><span class="line">@POST(&quot;register&quot;)</span><br><span class="line">Call&lt;User&gt; registerUser(@Part MultipartBody.Part photo, @Part(&quot;username&quot;) RequestBody username, @Part(&quot;password&quot;) RequestBody password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œ@MultiPartçš„æ„æ€å°±æ˜¯å…è®¸å¤šä¸ª@Partäº†ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†3ä¸ª@Partï¼Œç¬¬ä¸€ä¸ªæˆ‘ä»¬å‡†å¤‡ä¸Šä¼ ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨äº†MultipartBody.Partç±»å‹ï¼Œå…¶ä½™ä¸¤ä¸ªå‡ä¸ºç®€å•çš„é”®å€¼å¯¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">File file = new File(Environment.getExternalStorageDirectory(), &quot;icon.png&quot;);</span><br><span class="line">RequestBody photoRequestBody = RequestBody.create(MediaType.parse(&quot;image/png&quot;), file);</span><br><span class="line">MultipartBody.Part photo = MultipartBody.Part.createFormData(&quot;photos&quot;, &quot;icon.png&quot;, photoRequestBody);</span><br><span class="line"></span><br><span class="line">Call&lt;User&gt; call = user.registerUser(photo, RequestBody.create(null, &quot;abc&quot;), RequestBody.create(null, &quot;123&quot;));</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæ„Ÿè§‰ç•¥ä¸ºéº»çƒ¦ã€‚ä¸è¿‡è¿˜æ˜¯è›®å¥½ç†è§£~~å¤šä¸ª@Partï¼Œæ¯ä¸ªPartå¯¹åº”ä¸€ä¸ªRequestBodyã€‚<br>æ³¨ï¼šè¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªæ–¹æ¡ˆä¹Ÿæ˜¯å¯è¡Œçš„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface ApiInterface &#123;</span><br><span class="line">@Multipart</span><br><span class="line">@POST (&quot;/api/Accounts/editaccount&quot;)</span><br><span class="line">Call&lt;User&gt; editUser (@Header(&quot;Authorization&quot;) String authorization, @Part(&quot;photos\&quot;; filename=\&quot;icon.png&quot;) RequestBody file , @Part(&quot;FirstName&quot;) RequestBody fname, @Part(&quot;Id&quot;) RequestBody id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªvalueè®¾ç½®çš„å€¼ä¸ç”¨çœ‹å°±ä¼šè§‰å¾—ç‰¹åˆ«å¥‡æ€ªï¼Œç„¶è€Œå´å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼ŒåŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>å½“ä¸Šä¼ key-valueçš„æ—¶å€™ï¼Œå®é™…ä¸Šå¯¹åº”è¿™æ ·çš„ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.addPart(Headers.of(&quot;Content-Disposition&quot;, &quot;form-data; name=\&quot;&quot; + key + &quot;\&quot;&quot;), RequestBody.create(null, params.get(key)));</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„@Partè½¬åŒ–ä¸ºäº†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Headers.of(&quot;Content-Disposition&quot;, &quot;form-data; name=\&quot;&quot; + key + &quot;\&quot;&quot;)</span><br></pre></td></tr></table></figure></p><p>è¿™ä¹ˆä¸€çœ‹ï¼Œå¾ˆéšæ„ï¼Œåªè¦æŠŠkeyæ”¾è¿›å»å°±å¯ä»¥äº†ã€‚ä½†æ˜¯ï¼Œretrofit2å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶åšç‰¹æ®Šå¤„ç†ï¼Œæ–‡ä»¶çš„å¯¹åº”çš„å­—ç¬¦ä¸²åº”è¯¥æ˜¯è¿™æ ·çš„<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Headers.of(&quot;Content-Disposition&quot;, &quot;form-data; name=&quot;photos&quot;;filename=&quot;icon.png&quot;&quot;);</span><br></pre></td></tr></table></figure></p><p>ä¸é”®å€¼å¯¹å¯¹åº”çš„å­—ç¬¦ä¸²ç›¸æ¯”ï¼Œå¤šäº†ä¸ª\â€; filename=\â€icon.pngï¼Œå°±å› ä¸ºretrofitæ²¡æœ‰åšç‰¹æ®Šå¤„ç†ï¼Œæ‰€ä»¥ä½ ç°åœ¨çœ‹è¿™äº›hackçš„åšæ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Part(&quot;photos\&quot;; filename=\&quot;icon.png&quot;)</span><br><span class="line">==&gt; key = photos\&quot;; filename=\&quot;icon.png</span><br><span class="line"></span><br><span class="line">form-data; name=\&quot;&quot; + key + &quot;\&quot;</span><br><span class="line">æ‹¼æ¥ç»“æœï¼š==&gt;</span><br><span class="line">form-data; name=&quot;photos&quot;; filename=&quot;icon.png&quot;</span><br></pre></td></tr></table></figure></p><p>å› ä¸ºè¿™ç§æ–¹å¼æ–‡ä»¶åå†™æ­»äº†ï¼Œæˆ‘ä»¬ä¸Šæ–‡ä½¿ç”¨çš„çš„æ˜¯@Part MultipartBody.Part file,å¯ä»¥æ»¡è¶³æ–‡ä»¶ååŠ¨æ€è®¾ç½®ã€‚</p><p>2.å¦‚æœæ˜¯å¤šæ–‡ä»¶ä¸Šä¼ å‘¢ï¼Ÿ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface IUser &#123;</span><br><span class="line">@Multipart</span><br><span class="line">@POST(&quot;register&quot;)</span><br><span class="line">Call&lt;User&gt; registerUser(@PartMap Map&lt;String, RequestBody&gt; params, @Part(&quot;password&quot;) RequestBody password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„æ³¨è§£@PartMapï¼Œè¿™ä¸ªæ³¨è§£ç”¨äºæ ‡è¯†ä¸€ä¸ªMapï¼ŒMapçš„keyä¸ºStringç±»å‹ï¼Œä»£è¡¨ä¸Šä¼ çš„é”®å€¼å¯¹çš„key(ä¸æœåŠ¡å™¨æ¥å—çš„keyå¯¹åº”),valueå³ä¸ºRequestBodyï¼Œæœ‰ç‚¹ç±»ä¼¼@Partçš„å°è£…ç‰ˆæœ¬ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">File file = new File(Environment.getExternalStorageDirectory(), &quot;local.png&quot;);</span><br><span class="line">RequestBody photo = RequestBody.create(MediaType.parse(&quot;image/png&quot;, file);</span><br><span class="line">Map&lt;String, RequestBody&gt; map = new HashMap&lt;&gt;(String, RequestBody);</span><br><span class="line">map.put(&quot;photos\&quot;; filename=\&quot;icon.png&quot;, photo);</span><br><span class="line">map.put(&quot;username&quot;,  RequestBody.create(null, &quot;abc&quot;));</span><br><span class="line"></span><br><span class="line">Call&lt;User&gt; call = user.registerUser(map, RequestBody.create(null, &quot;123&quot;));</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯ä»¥åœ¨Mapä¸­putè¿›ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œé”®å€¼å¯¹ç­‰ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åˆ†å¼€ï¼Œå•ç‹¬çš„é”®å€¼å¯¹ä¹Ÿå¯ä»¥ä½¿ç”¨@Partï¼Œè¿™é‡Œåˆçœ‹åˆ°è®¾ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œç›¸å¯¹åº”çš„keyå¾ˆå¥‡æ€ªï¼Œä¾‹å¦‚ä¸Šä¾‹â€photos\â€; filename=\â€icon.pngâ€,å‰é¢çš„photoså°±æ˜¯ä¸æœåŠ¡å™¨å¯¹åº”çš„keyï¼Œåé¢filenameæ˜¯æœåŠ¡å™¨å¾—åˆ°çš„æ–‡ä»¶åï¼Œokï¼Œå‚æ•°è™½ç„¶å¥‡æ€ªï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥åŠ¨æ€çš„è®¾ç½®æ–‡ä»¶åï¼Œä¸å½±å“ä½¿ç”¨ã€‚</p><h5 id="ï¼ˆ7ï¼‰ä¸‹è½½æ–‡ä»¶"><a href="#ï¼ˆ7ï¼‰ä¸‹è½½æ–‡ä»¶" class="headerlink" title="ï¼ˆ7ï¼‰ä¸‹è½½æ–‡ä»¶"></a>ï¼ˆ7ï¼‰ä¸‹è½½æ–‡ä»¶</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@GET(&quot;download&quot;)</span><br><span class="line">Call&lt;ResponseBody&gt; downloadTest();</span><br><span class="line"></span><br><span class="line">Call&lt;ResponseBody&gt; call = user.downloadTest();</span><br><span class="line">call.enqueue(new Callback&lt;ResponseBody&gt;() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onResponse(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response) &#123;</span><br><span class="line">InputStream is = response.body().byteStream();</span><br><span class="line">//save file</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onFailure(Call&lt;ResponseBody&gt; call, Throwable t)&#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="ï¼ˆ8ï¼‰æ·»åŠ è¯·æ±‚å¤´-Header-Headers"><a href="#ï¼ˆ8ï¼‰æ·»åŠ è¯·æ±‚å¤´-Header-Headers" class="headerlink" title="ï¼ˆ8ï¼‰æ·»åŠ è¯·æ±‚å¤´@Header@Headers"></a>ï¼ˆ8ï¼‰æ·»åŠ è¯·æ±‚å¤´@Header@Headers</h5><p>@Headerï¼šheaderå¤„ç†ï¼Œä¸èƒ½è¢«äº’ç›¸è¦†ç›–ï¼Œæ‰€æœ‰å…·æœ‰ç›¸åŒåå­—çš„headerå°†ä¼šè¢«åŒ…å«åˆ°è¯·æ±‚ä¸­ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//é™æ€è®¾ç½®Headerå€¼</span><br><span class="line">@Headers(&quot;Authorization: authorization&quot;)</span><br><span class="line">@GET(&quot;widget/list&quot;)</span><br><span class="line">Call&lt;User&gt; getUser()</span><br></pre></td></tr></table></figure></p><p>@Headers ç”¨äºä¿®é¥°æ–¹æ³•,ç”¨äºè®¾ç½®å¤šä¸ªHeaderå€¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Headers(&#123;</span><br><span class="line">&quot;Accept: application/vnd.github.v3.full+json&quot;,</span><br><span class="line">&quot;User-Agent: Retrofit-Sample-App&quot;</span><br><span class="line">&#125;)</span><br><span class="line">@GET(&quot;users/&#123;username&#125;&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@Path(&quot;username&quot;) String username);</span><br></pre></td></tr></table></figure></p><p>è¿˜å¯ä»¥ä½¿ç”¨@Headeræ³¨è§£åŠ¨æ€çš„æ›´æ–°ä¸€ä¸ªè¯·æ±‚çš„<a href="https://kb.cnblogs.com/page/119118/" target="_blank" rel="noopener">header</a>ã€‚å¿…é¡»ç»™@Headeræä¾›ç›¸åº”çš„å‚æ•°ï¼Œå¦‚æœå‚æ•°çš„å€¼ä¸ºç©ºheaderå°†ä¼šè¢«å¿½ç•¥ï¼Œå¦åˆ™å°±è°ƒç”¨å‚æ•°å€¼çš„toString()æ–¹æ³•å¹¶ä½¿ç”¨è¿”å›ç»“æœã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//åŠ¨æ€è®¾ç½®Headerå€¼</span><br><span class="line">@GET(&quot;user&quot;)</span><br><span class="line">Call&lt;User&gt; getUser(@Header(&quot;Authorization&quot;) String authorization)</span><br></pre></td></tr></table></figure></p><h5 id="é…ç½®OkHttpClient"><a href="#é…ç½®OkHttpClient" class="headerlink" title="é…ç½®OkHttpClient"></a>é…ç½®OkHttpClient</h5><p>å¾ˆå¤šæ—¶å€™ï¼Œæ¯”å¦‚ä½ ä½¿ç”¨retrofitéœ€è¦ç»Ÿä¸€çš„logç®¡ç†ï¼Œç¼“å­˜ç®¡ç†ï¼Œç»™æ¯ä¸ªè¯·æ±‚æ·»åŠ ç»Ÿä¸€çš„headerç­‰ï¼Œè¿™äº›éƒ½åº”è¯¥é€šè¿‡okhttpclientå»æ“ä½œã€‚Retrofit 2.0 åº•å±‚ä¾èµ–äºokHttpï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨okHttpçš„<a href="https://www.jianshu.com/p/2710ed1e6b48" target="_blank" rel="noopener">Interceptors</a>æ¥å¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œæ‹¦æˆªã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">OkHttpClient client = new OkHttpClient();</span><br><span class="line">client.networkInterceptors().add(new Interceptor() &#123;</span><br><span class="line">@Override</span><br><span class="line">public com.squareup.okhttp.Response intercept(Chain chain) throws IOException &#123;</span><br><span class="line">com.squareup.okhttp.Response response = chain.proceed(chain.request());</span><br><span class="line"></span><br><span class="line">// Do anything with response here</span><br><span class="line"></span><br><span class="line">return response;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">.baseUrl(BASE_URL)</span><br><span class="line">...</span><br><span class="line">.client(client) //ä¼ å…¥è‡ªå·±å®šä¹‰çš„client</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p><p>æˆ–è®¸ä½ éœ€è¦æ›´å¤šçš„é…ç½®ï¼Œä½ å¯ä»¥å•ç‹¬å†™ä¸€ä¸ªOkhttpClientçš„å•ä¾‹ç”Ÿæˆç±»ï¼Œåœ¨è¿™ä¸ªé‡Œé¢å®Œæˆä½ æ‰€éœ€çš„æ‰€æœ‰çš„é…ç½®ï¼Œç„¶åå°†OkhttpClientå®ä¾‹é€šè¿‡æ–¹æ³•å…¬å¸ƒå‡ºæ¥ï¼Œè®¾ç½®ç»™retrofitã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Retrofit retrofit = new Retrofit.Builder()</span><br><span class="line">.callFactory(OkHttpUtils.getClient())</span><br><span class="line">.build();</span><br></pre></td></tr></table></figure></p><p>callFactoryæ–¹æ³•æ¥å—ä¸€ä¸ªokhttp3.Call.Factoryå¯¹è±¡ï¼ŒOkHttpClientå³ä¸ºä¸€ä¸ªå®ç°ç±»ã€‚</p><h1 id="Retrofit2-0æºç åˆ†æ"><a href="#Retrofit2-0æºç åˆ†æ" class="headerlink" title="Retrofit2.0æºç åˆ†æ"></a>Retrofit2.0æºç åˆ†æ</h1><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹retrofitçš„æºç åšç®€å•çš„åˆ†æï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹retrofitå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¥å£å®ç°å®ä¾‹ï¼›ç„¶åçœ‹æ•´ä½“çš„æ‰§è¡Œæµç¨‹ï¼›æœ€åå†çœ‹è¯¦ç»†çš„ç»†èŠ‚ï¼›</p><h4 id="ï¼ˆ1ï¼‰retrofitå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¥å£å®ç°å®ä¾‹"><a href="#ï¼ˆ1ï¼‰retrofitå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¥å£å®ç°å®ä¾‹" class="headerlink" title="ï¼ˆ1ï¼‰retrofitå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¥å£å®ç°å®ä¾‹"></a>ï¼ˆ1ï¼‰retrofitå¦‚ä½•ä¸ºæˆ‘ä»¬çš„æ¥å£å®ç°å®ä¾‹</h4><p>ä½¿ç”¨retrofitéœ€è¦å»å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç„¶åå¯ä»¥é€šè¿‡è°ƒç”¨retrofit.create(IUser.class)æ–¹æ³•ï¼Œå¾—åˆ°ä¸€ä¸ªæ¥å£çš„å®ä¾‹ï¼Œæœ€åé€šè¿‡è¯¥å®ä¾‹æ‰§è¡Œæˆ‘ä»¬çš„æ“ä½œï¼Œé‚£ä¹ˆretrofitå¦‚ä½•å®ç°æˆ‘ä»¬æŒ‡å®šæ¥å£çš„å®ä¾‹å‘¢ï¼Ÿ<br>å…¶å®åŸç†æ˜¯ï¼šåŠ¨æ€ä»£ç†ã€‚ä½†æ˜¯ä¸è¦è¢«åŠ¨æ€ä»£ç†è¿™å‡ ä¸ªè¯å“å”¬åˆ°ï¼ŒJavaä¸­å·²ç»æä¾›äº†éå¸¸ç®€å•çš„APIå¸®åŠ©æˆ‘ä»¬æ¥å®ç°åŠ¨æ€ä»£ç†ã€‚<br>çœ‹æºç å‰å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public interface ITest</span><br><span class="line">&#123;</span><br><span class="line">@GET(&quot;/heiheihei&quot;)</span><br><span class="line">public void add(int a, int b);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">public static void main(String[] args)</span><br><span class="line">&#123;</span><br><span class="line">ITest iTest = (ITest) Proxy.newProxyInstance(ITest.class.getClassLoader(), new Class&lt;?&gt;[]&#123;ITest.class&#125;, new InvocationHandler()</span><br><span class="line">&#123;</span><br><span class="line">@Override</span><br><span class="line">public Object invoke(Object proxy, Method method, Object[] args) throws Throwable</span><br><span class="line">&#123;</span><br><span class="line">Integer a = (Integer) args[0];</span><br><span class="line">Integer b = (Integer) args[1];</span><br><span class="line">System.out.println(&quot;æ–¹æ³•åï¼š&quot; + method.getName());</span><br><span class="line">System.out.println(&quot;å‚æ•°ï¼š&quot; + a + &quot; , &quot; + b);</span><br><span class="line"></span><br><span class="line">GET get = method.getAnnotation(GET.class);</span><br><span class="line">System.out.println(&quot;æ³¨è§£ï¼š&quot; + get.value());</span><br><span class="line">return null;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">iTest.add(3, 5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºç»“æœä¸ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•åï¼šadd</span><br><span class="line">å‚æ•°ï¼š3 , 5</span><br><span class="line">æ³¨è§£ï¼š/heiheihei</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡Proxy.newProxyInstanceäº§ç”Ÿçš„ä»£ç†ç±»ï¼Œå½“è°ƒç”¨æ¥å£çš„ä»»ä½•æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨InvocationHandler#invokeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥æ‹¿åˆ°ä¼ å…¥çš„å‚æ•°ï¼Œæ³¨è§£ç­‰ã€‚<br>å…¶å®retrofitä¹Ÿå¯ä»¥é€šè¿‡åŒæ ·çš„æ–¹å¼ï¼Œåœ¨invokeæ–¹æ³•é‡Œé¢ï¼Œæ‹¿åˆ°æ‰€æœ‰çš„å‚æ•°ï¼Œæ³¨è§£ä¿¡æ¯ç„¶åå°±å¯ä»¥å»æ„é€ RequestBodyï¼Œå†å»æ„å»ºRequestï¼Œå¾—åˆ°Callå¯¹è±¡å°è£…åè¿”å›ã€‚<br>ä¸‹é¢çœ‹retrofit#createçš„æºç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public &lt;T&gt; T create(final Class&lt;T&gt; service) &#123;</span><br><span class="line">return (T) Proxy.newProxyInstance(service.getClassLoader(), new Class&lt;?&gt;[] &#123; service &#125;,</span><br><span class="line">new InvocationHandler() &#123;</span><br><span class="line">@Override </span><br><span class="line">public Object invoke(Object proxy, Method method, Object... args) throws Throwable &#123;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å’Œä¸Šé¢å¯¹åº”ã€‚åˆ°è¿™é‡Œï¼Œä½ åº”è¯¥æ˜ç™½retrofitä¸ºæˆ‘ä»¬æ¥å£ç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶ä¸ç¥å¥‡ï¼Œä»…ä»…æ˜¯ä½¿ç”¨äº†Proxyè¿™ä¸ªç±»çš„APIè€Œå·²ï¼Œç„¶ååœ¨invokeæ–¹æ³•é‡Œé¢æ‹¿åˆ°è¶³å¤Ÿçš„ä¿¡æ¯å»æ„å»ºæœ€ç»ˆè¿”å›çš„Callè€Œå·²ã€‚</p><h4 id="ï¼ˆ2ï¼‰retrofitæ•´ä½“å®ç°æµç¨‹"><a href="#ï¼ˆ2ï¼‰retrofitæ•´ä½“å®ç°æµç¨‹" class="headerlink" title="ï¼ˆ2ï¼‰retrofitæ•´ä½“å®ç°æµç¨‹"></a>ï¼ˆ2ï¼‰retrofitæ•´ä½“å®ç°æµç¨‹</h4><p>Retrofitçš„æ„å»ºï¼šè¿™é‡Œä¾ç„¶æ˜¯é€šè¿‡æ„é€ è€…æ¨¡å¼è¿›è¡Œæ„å»ºretrofitå¯¹è±¡ï¼Œå¥½åœ¨å…¶å†…éƒ¨çš„æˆå‘˜å˜é‡æ¯”è¾ƒå°‘ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹build()æ–¹æ³•ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public Builder() &#123;</span><br><span class="line">this(Platform.get());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public Retrofit build() &#123;</span><br><span class="line">if (baseUrl == null) &#123;</span><br><span class="line">throw new IllegalStateException(&quot;Base URL required.&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">okhttp3.Call.Factory callFactory = this.callFactory;</span><br><span class="line">if (callFactory == null) &#123;</span><br><span class="line">callFactory = new OkHttpClient();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Executor callbackExecutor = this.callbackExecutor;</span><br><span class="line">if (callbackExecutor == null) &#123;</span><br><span class="line">callbackExecutor = platform.defaultCallbackExecutor();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Make a defensive copy of the adapters and add the default Call adapter.</span><br><span class="line">List&lt;CallAdapter.Factory&gt; adapterFactories = new ArrayList&lt;&gt;(this.adapterFactories);</span><br><span class="line">adapterFactories.add(platform.defaultCallAdapterFactory(callbackExecutor));</span><br><span class="line"></span><br><span class="line">// Make a defensive copy of the converters.</span><br><span class="line">List&lt;Converter.Factory&gt; converterFactories = new ArrayList&lt;&gt;(this.converterFactories);</span><br><span class="line"></span><br><span class="line">return new Retrofit(callFactory, baseUrl, converterFactories, adapterFactories,</span><br><span class="line">callbackExecutor, validateEagerly);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>baseUrlå¿…é¡»æŒ‡å®šï¼Œè¿™ä¸ªæ˜¯ç†æ‰€å½“ç„¶çš„ï¼›</p><p>ç„¶åå¯ä»¥çœ‹åˆ°å¦‚æœä¸ç€æ€¥è®¾ç½®callFactoryï¼Œåˆ™é»˜è®¤ç›´æ¥new OkHttpClient()ï¼Œå¯è§å¦‚æœä½ éœ€è¦å¯¹okhttpclientè¿›è¡Œè¯¦ç»†çš„è®¾ç½®ï¼Œéœ€è¦æ„å»ºOkHttpClientå¯¹è±¡ï¼Œç„¶åä¼ å…¥ï¼›<br>æ¥ä¸‹æ¥æ˜¯callbackExecutorï¼Œè¿™ä¸ªæƒ³ä¸€æƒ³å¤§æ¦‚æ˜¯ç”¨æ¥å°†å›è°ƒä¼ é€’åˆ°UIçº¿ç¨‹äº†ï¼Œå½“ç„¶è¿™é‡Œè®¾è®¡çš„æ¯”è¾ƒå·§å¦™ï¼Œåˆ©ç”¨platformå¯¹è±¡ï¼Œå¯¹å¹³å°è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­ä¸»è¦æ˜¯åˆ©ç”¨Class.forName(â€œâ€)è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœæ˜¯Androidå¹³å°ï¼Œä¼šè‡ªå®šä¹‰ä¸€ä¸ªExecutorå¯¹è±¡ï¼Œå¹¶ä¸”åˆ©ç”¨Looper.getMainLooper()å®ä¾‹åŒ–ä¸€ä¸ªhandlerå¯¹è±¡ï¼Œåœ¨Executorå†…éƒ¨é€šè¿‡handler.post(runnable)ï¼Œokï¼Œæ•´ç†å‡­å¤§è„‘åº”è¯¥èƒ½æ„æ€å‡ºæ¥ï¼Œæš‚ä¸è´´ä»£ç äº†ã€‚<br>æ¥ä¸‹æ¥æ˜¯adapterFactoriesï¼Œè¿™ä¸ªå¯¹è±¡ä¸»è¦ç”¨äºå¯¹Callè¿›è¡Œè½¬åŒ–ï¼ŒåŸºæœ¬ä¸Šä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å»è‡ªå®šä¹‰ã€‚<br>æœ€åæ˜¯converterFactoriesï¼Œè¯¥å¯¹è±¡ç”¨äºè½¬åŒ–æ•°æ®ï¼Œä¾‹å¦‚å°†è¿”å›çš„responseBodyè½¬åŒ–ä¸ºå¯¹è±¡ç­‰ï¼›å½“ç„¶ä¸ä»…ä»…æ˜¯é’ˆå¯¹è¿”å›çš„æ•°æ®ï¼Œè¿˜èƒ½ç”¨äºä¸€èˆ¬æ³¨è§£çš„å‚æ•°çš„è½¬åŒ–ï¼Œä¾‹å¦‚@Bodyæ ‡è¯†çš„å¯¹è±¡åšä¸€äº›æ“ä½œï¼Œåé¢é‡åˆ°æºç è¯¦ç»†å†æè¿°ã€‚<br>å…·ä½“Callæ„å»ºæµç¨‹ï¼šæˆ‘ä»¬æ„é€ å®Œæˆretrofitï¼Œå°±å¯ä»¥åˆ©ç”¨retrofit.createæ–¹æ³•å»æ„å»ºæ¥å£çš„å®ä¾‹äº†ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»åˆ†æäº†è¿™ä¸ªç¯èŠ‚åˆ©ç”¨äº†åŠ¨æ€ä»£ç†ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿåˆ†æäº†å…·ä½“çš„Callçš„æ„å»ºæµç¨‹åœ¨invokeæ–¹æ³•ä¸­ï¼Œä¸‹é¢çœ‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public &lt;T&gt; T create(final Class&lt;T&gt; service) &#123;</span><br><span class="line">Utils.validateServiceInterface(service);</span><br><span class="line">//...</span><br><span class="line">return (T) Proxy.newProxyInstance(service.getClassLoader(), new Class&lt;?&gt;[] &#123; service &#125;,</span><br><span class="line">new InvocationHandler() &#123;</span><br><span class="line">@Override </span><br><span class="line">public Object invoke(Object proxy, Method method, Object... args)&#123;</span><br><span class="line">//...</span><br><span class="line">ServiceMethod serviceMethod = loadServiceMethod(method);</span><br><span class="line">OkHttpCall okHttpCall = new OkHttpCall&lt;&gt;(serviceMethod, args);</span><br><span class="line">return serviceMethod.callAdapter.adapt(okHttpCall);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸»è¦ä¹Ÿå°±ä¸‰è¡Œä»£ç ï¼Œç¬¬ä¸€è¡Œæ˜¯æ ¹æ®æˆ‘ä»¬çš„methodå°†å…¶åŒ…è£…æˆServiceMethodï¼Œç¬¬äºŒè¡Œæ˜¯é€šè¿‡ServiceMethodå’Œæ–¹æ³•çš„å‚æ•°æ„é€ retrofit2.OkHttpCallå¯¹è±¡ï¼Œç¬¬ä¸‰è¡Œæ˜¯é€šè¿‡serviceMethod.callAdapter.adapt()æ–¹æ³•ï¼Œå°†OkHttpCallè¿›è¡Œä»£ç†åŒ…è£…ã€‚<br>æ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>é¦–å…ˆæ„é€ retrofitï¼Œå‡ ä¸ªæ ¸å¿ƒçš„å‚æ•°å‘¢ï¼Œä¸»è¦å°±æ˜¯baseurl,callFactory(é»˜è®¤okhttpclient),converterFactories,adapterFactories,excallbackExecutorã€‚</li><li>ç„¶åé€šè¿‡createæ–¹æ³•æ‹¿åˆ°æ¥å£çš„å®ç°ç±»ï¼Œè¿™é‡Œåˆ©ç”¨Javaçš„Proxyç±»å®ŒæˆåŠ¨æ€ä»£ç†çš„ç›¸å…³ä»£ç†ã€‚</li><li>åœ¨invokeæ–¹æ³•å†…éƒ¨ï¼Œæ‹¿åˆ°æˆ‘ä»¬æ‰€å£°æ˜çš„æ³¨è§£ä»¥åŠå®å‚ç­‰ï¼Œæ„é€ ServiceMethodï¼ŒServiceMethodä¸­è§£æäº†å¤§é‡çš„ä¿¡æ¯ï¼Œæœ€ç»ˆå¯ä»¥é€šè¿‡toRequestæ„é€ å‡ºokhttp3.Requestå¯¹è±¡ã€‚æœ‰äº†okhttp3.Requestå¯¹è±¡å°±å¯ä»¥å¾ˆè‡ªç„¶çš„æ„å»ºå‡ºokhttp3.callï¼Œæœ€åcalladapterå¯¹Callè¿›è¡Œè£…é¥°è¿”å›ã€‚</li><li>æ‹¿åˆ°Callå°±å¯ä»¥æ‰§è¡Œenqueueæˆ–è€…executeæ–¹æ³•äº†ã€‚</li></ul><h1 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h1><p>æœ€ååœ¨æ¨èä¸€ä¸ªéå¸¸ç«çš„ç½‘ç»œè°ƒè¯•å·¥å…·ï¼š<a href="https://github.com/facebook/stetho" target="_blank" rel="noopener">stetho</a>ã€‚åˆ©ç”¨å®ƒä½ å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æŸ¥çœ‹åº”ç”¨çš„æœ¬åœ°æ•°æ®åº“ã€SharePerenceã€ç½‘ç»œè¯·æ±‚ç­‰æ•°æ®ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡å…³äºå®ƒçš„<a href="https://www.jianshu.com/p/c03a8959d1a5" target="_blank" rel="noopener">ä½¿ç”¨æŒ‡å—</a>ã€‚</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="http://square.github.io/okhttp/" target="_blank" rel="noopener">OkHttp</a><br><a href="http://www.androidchina.net/5758.html" target="_blank" rel="noopener">Android Retrofitæ¡†æ¶è§£æ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Retrofitæ˜¯Squareå›¢é˜Ÿæ——ä¸‹ä¸€ä¸ªçŸ¥åçš„Androidç½‘ç»œè¯·æ±‚åº“ï¼Œå‡†ç¡®çš„è¯´ï¼Œå®ƒæ˜¯ç”±Squareå¯¹okhttpå†æ¬¡å°è£…æ‰€æˆã€‚æœ¬ç« åœ¨è¯¦ç»†çš„ä»‹ç»Retrofitç”¨æ³•çš„åŒæ—¶ï¼Œè¿˜ä¼šåˆ†æå®ƒçš„å‰ä¸–ä»Šç”Ÿï¼ŒåŒ…æ‹¬okhttpä»‹ç»ã€æºç åˆ†æã€javaæ³¨è§£çš„æŒæ¡ä»¥åŠRetrofitçš„äºŒæ¬¡å°è£…çŸ¥è¯†ã€‚
    
    </summary>
    
      <category term="Androidæ¡†æ¶" scheme="http://yoursite.com/categories/Android%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="Retrofit" scheme="http://yoursite.com/tags/Retrofit/"/>
    
  </entry>
  
  <entry>
    <title>Androidå±å¹•é€‚é…æ–¹æ¡ˆ</title>
    <link href="http://yoursite.com/2017/08/03/Android%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/"/>
    <id>http://yoursite.com/2017/08/03/Androidå±å¹•é€‚é…/</id>
    <published>2017-08-03T12:36:37.000Z</published>
    <updated>2018-06-16T12:56:17.137Z</updated>
    
    <content type="html"><![CDATA[<p>Androidçš„å±å¹•é€‚é…ä¸€ç›´ä»¥æ¥éƒ½åœ¨æŠ˜ç£¨ç€æˆ‘ä»¬è¿™äº›å¼€å‘è€…ï¼Œæœ¬ç¯‡æ–‡ç« å°†ä»¥Googleçš„å®˜æ–¹æ–‡æ¡£ä¸ºåŸºç¡€ï¼Œå…¨é¢è€Œæ·±å…¥çš„è®²è§£Androidå±å¹•é€‚é…çš„åŸå› ã€é‡è¦æ¦‚å¿µã€è§£å†³æ–¹æ¡ˆåŠæœ€ä½³å®è·µã€‚<a id="more"></a></p><h1 id="Androidå±å¹•é€‚é…å‡ºç°çš„åŸå› "><a href="#Androidå±å¹•é€‚é…å‡ºç°çš„åŸå› " class="headerlink" title="Androidå±å¹•é€‚é…å‡ºç°çš„åŸå› "></a>Androidå±å¹•é€‚é…å‡ºç°çš„åŸå› </h1><p><a href="http://opensignal.com/reports/2014/android-fragmentation/" target="_blank" rel="noopener">Androidçš„å±å¹•å°ºå¯¸å¾ˆå¤š</a>ï¼Œä¸ºäº†è®©æˆ‘ä»¬å¼€å‘çš„ç¨‹åºèƒ½å¤Ÿæ¯”è¾ƒç¾è§‚çš„æ˜¾ç¤ºåœ¨ä¸åŒå°ºå¯¸ã€åˆ†è¾¨ç‡ã€åƒç´ å¯†åº¦(è¿™äº›æ¦‚å¿µæˆ‘ä¼šåœ¨ä¸‹é¢è¯¦ç»†è®²è§£)çš„è®¾å¤‡ä¸Šï¼Œé‚£å°±è¦åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œè‡³äºå¦‚ä½•å»è¿›è¡Œå¤„ç†ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä»Šå¤©çš„ä¸»é¢˜äº†ã€‚</p><h1 id="é‡è¦æ¦‚å¿µ"><a href="#é‡è¦æ¦‚å¿µ" class="headerlink" title="é‡è¦æ¦‚å¿µ"></a>é‡è¦æ¦‚å¿µ</h1><p>ä»€ä¹ˆæ˜¯å±å¹•å°ºå¯¸ã€å±å¹•åˆ†è¾¨ç‡ã€å±å¹•åƒç´ å¯†åº¦ï¼Ÿ<br>ä»€ä¹ˆæ˜¯dpã€dipã€dpiã€spã€pxï¼Ÿä»–ä»¬ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ<br>ä»€ä¹ˆæ˜¯mdpiã€hdpiã€xdpiã€xxdpiï¼Ÿå¦‚ä½•è®¡ç®—å’ŒåŒºåˆ†ï¼Ÿ<br>åœ¨ä¸‹é¢çš„å†…å®¹ä¸­æˆ‘ä»¬å°†ä»‹ç»è¿™äº›æ¦‚å¿µã€‚</p><h4 id="å±å¹•å°ºå¯¸"><a href="#å±å¹•å°ºå¯¸" class="headerlink" title="å±å¹•å°ºå¯¸"></a>å±å¹•å°ºå¯¸</h4><p>å±å¹•å°ºå¯¸æŒ‡å±å¹•çš„å¯¹è§’çº¿çš„é•¿åº¦ï¼Œå•ä½æ˜¯è‹±å¯¸ï¼Œ1è‹±å¯¸=2.54å˜ç±³ã€‚<br>æ¯”å¦‚å¸¸è§çš„å±å¹•å°ºå¯¸æœ‰2.4ã€2.8ã€3.5ã€3.7ã€4.2ã€5.0ã€5.5ã€6.0ç­‰ã€‚</p><h4 id="å±å¹•åˆ†è¾¨ç‡"><a href="#å±å¹•åˆ†è¾¨ç‡" class="headerlink" title="å±å¹•åˆ†è¾¨ç‡"></a>å±å¹•åˆ†è¾¨ç‡</h4><p>å±å¹•åˆ†è¾¨ç‡æ˜¯æŒ‡åœ¨æ¨ªçºµå‘ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯pxï¼Œ1px=1ä¸ªåƒç´ ç‚¹ã€‚ä¸€èˆ¬ä»¥çºµå‘åƒç´ *æ¨ªå‘åƒç´ ï¼Œå¦‚1960*1080ã€‚</p><h4 id="å±å¹•åƒç´ å¯†åº¦"><a href="#å±å¹•åƒç´ å¯†åº¦" class="headerlink" title="å±å¹•åƒç´ å¯†åº¦"></a>å±å¹•åƒç´ å¯†åº¦</h4><p>å±å¹•åƒç´ å¯†åº¦æ˜¯æŒ‡æ¯è‹±å¯¸ä¸Šçš„åƒç´ ç‚¹æ•°ï¼Œå•ä½æ˜¯dpiï¼Œå³â€œdot per inchâ€çš„ç¼©å†™ã€‚å±å¹•åƒç´ å¯†åº¦ä¸å±å¹•å°ºå¯¸å’Œå±å¹•åˆ†è¾¨ç‡æœ‰å…³ï¼Œåœ¨å•ä¸€å˜åŒ–æ¡ä»¶ä¸‹ï¼Œå±å¹•å°ºå¯¸è¶Šå°ã€åˆ†è¾¨ç‡è¶Šé«˜ï¼Œåƒç´ å¯†åº¦è¶Šå¤§ï¼Œåä¹‹è¶Šå°ã€‚</p><h4 id="dpã€dipã€dpiã€spã€px"><a href="#dpã€dipã€dpiã€spã€px" class="headerlink" title="dpã€dipã€dpiã€spã€px"></a>dpã€dipã€dpiã€spã€px</h4><p>pxæˆ‘ä»¬åº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰çš„ï¼Œå‰é¢çš„åˆ†è¾¨ç‡å°±æ˜¯ç”¨çš„åƒç´ ä¸ºå•ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¯”å¦‚UIè®¾è®¡ã€AndroidåŸç”ŸAPIéƒ½ä¼šä»¥pxä½œä¸ºç»Ÿä¸€çš„è®¡é‡å•ä½ï¼Œåƒæ˜¯è·å–å±å¹•å®½é«˜ç­‰ã€‚<br>dipå’Œdpæ˜¯ä¸€ä¸ªæ„æ€ï¼Œéƒ½æ˜¯Density Independent Pixelsçš„ç¼©å†™ï¼Œå³å¯†åº¦æ— å…³åƒç´ ï¼Œä¸Šé¢æˆ‘ä»¬è¯´è¿‡ï¼Œdpiæ˜¯å±å¹•åƒç´ å¯†åº¦ï¼Œå‡å¦‚ä¸€è‹±å¯¸é‡Œé¢æœ‰160ä¸ªåƒç´ ï¼Œè¿™ä¸ªå±å¹•çš„åƒç´ å¯†åº¦å°±æ˜¯160dpiï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œdpå’Œpxå¦‚ä½•æ¢ç®—å‘¢ï¼Ÿåœ¨Androidä¸­ï¼Œè§„å®šä»¥160dpiä¸ºåŸºå‡†ï¼Œ1dip=1pxï¼Œå¦‚æœå¯†åº¦æ˜¯320dpiï¼Œåˆ™1dip=2pxï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>å‡å¦‚åŒæ ·éƒ½æ˜¯ç”»ä¸€æ¡320pxçš„çº¿ï¼Œåœ¨480*800åˆ†è¾¨ç‡æ‰‹æœºä¸Šæ˜¾ç¤ºä¸º2/3å±å¹•å®½åº¦ï¼Œåœ¨320*480çš„æ‰‹æœºä¸Šåˆ™å æ»¡äº†å…¨å±ï¼Œå¦‚æœä½¿ç”¨dpä¸ºå•ä½ï¼Œåœ¨è¿™ä¸¤ç§åˆ†è¾¨ç‡ä¸‹ï¼Œ160dpéƒ½æ˜¾ç¤ºä¸ºå±å¹•ä¸€åŠçš„é•¿åº¦ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Androidå¼€å‘ä¸­ï¼Œå†™å¸ƒå±€çš„æ—¶å€™è¦å°½é‡ä½¿ç”¨dpè€Œä¸æ˜¯pxçš„åŸå› ã€‚<br>è€Œspï¼Œå³scale-independent pixelsï¼Œé™¤äº†æ‹¥æœ‰dpçš„ç‰¹æ€§ï¼Œ<strong>è¿˜ä¼šéšç€ç³»ç»Ÿçš„å­—ä½“å¤§å°æ”¹å˜è€Œæ”¹å˜ï¼Œå»ºè®®åœ¨è®¾ç½®å­—ä½“å¤§å°çš„æ•°å€¼è¦ä½¿ç”¨spä½œä¸ºå•ä½ï¼Œ</strong><a href="https://blog.csdn.net/donkor_/article/details/77680042" target="_blank" rel="noopener">å…·ä½“å¯å‚è€ƒè¿™ç¯‡æ–‡ç« </a>ã€‚<br>spä¸dpä¹‹é—´çš„è½¬æ¢æ–¹æ³•å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public static int px2dip(Context context, float pxValue) &#123;  </span><br><span class="line">final float scale = context.getResources().getDisplayMetrics().density;  </span><br><span class="line">return (int) (pxValue / scale + 0.5f);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public static int dip2px(Context context, float dipValue) &#123;  </span><br><span class="line">final float scale = context.getResources().getDisplayMetrics().density;  </span><br><span class="line">return (int) (dipValue * scale + 0.5f);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int px2sp(Context context, float pxValue) &#123;  </span><br><span class="line">final float fontScale = context.getResources().getDisplayMetrics().scaledDensity;  </span><br><span class="line">return (int) (pxValue / fontScale + 0.5f);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">public static int sp2px(Context context, float spValue) &#123;  </span><br><span class="line">final float fontScale = context.getResources().getDisplayMetrics().scaledDensity;  </span><br><span class="line">return (int) (spValue * fontScale + 0.5f);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="mdpiã€hdpiã€xdpiã€xxdpi"><a href="#mdpiã€hdpiã€xdpiã€xxdpi" class="headerlink" title="mdpiã€hdpiã€xdpiã€xxdpi"></a>mdpiã€hdpiã€xdpiã€xxdpi</h4><p>å…¶å®ä¹‹å‰è¿˜æœ‰ä¸ªldpiï¼Œä½†æ˜¯éšç€ç§»åŠ¨è®¾å¤‡é…ç½®çš„ä¸æ–­å‡çº§ï¼Œè¿™ä¸ªåƒç´ å¯†åº¦çš„è®¾å¤‡å·²ç»å¾ˆç½•è§äº†ï¼Œæ‰€åœ¨ç°åœ¨é€‚é…æ—¶ä¸éœ€è€ƒè™‘ã€‚<br>mdpiã€hdpiã€xdpiã€xxdpiç”¨æ¥ä¿®é¥°Androidä¸­çš„drawableæ–‡ä»¶å¤¹åŠvaluesæ–‡ä»¶å¤¹ï¼Œç”¨æ¥åŒºåˆ†ä¸åŒåƒç´ å¯†åº¦ä¸‹çš„å›¾ç‰‡å’Œdimenå€¼ã€‚<br>é‚£ä¹ˆå¦‚ä½•åŒºåˆ†å‘¢ï¼ŸGoogleå®˜æ–¹æŒ‡å®šæŒ‰ç…§ä¸‹åˆ—æ ‡å‡†è¿›è¡ŒåŒºåˆ†ï¼š</p><table><thead><tr><th>åç§°</th><th style="text-align:center">åƒç´ å¯†åº¦èŒƒå›´</th></tr></thead><tbody><tr><td>mdpi</td><td style="text-align:center">120dpi~160dpi</td></tr><tr><td>hdpi</td><td style="text-align:center">160dpi~240dpi</td></tr><tr><td>xhdpi</td><td style="text-align:center">240dpi~320dpi</td></tr><tr><td>xxhdpi</td><td style="text-align:center">320dpi~480dpi</td></tr><tr><td>xxxhdpi</td><td style="text-align:center">480dpi~640dpi</td></tr></tbody></table><p>åœ¨è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŠŠåˆé€‚å¤§å°çš„å›¾ç‰‡æ”¾åœ¨åˆé€‚çš„æ–‡ä»¶å¤¹é‡Œé¢ã€‚ä¸‹é¢ä»¥å›¾æ ‡è®¾è®¡ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚<br>åœ¨è®¾è®¡å›¾æ ‡æ—¶ï¼Œå¯¹äºäº”ç§ä¸»æµçš„åƒç´ å¯†åº¦ï¼ˆMDPIã€HDPIã€XHDPIã€XXHDPI å’Œ XXXHDPIï¼‰åº”æŒ‰ç…§ 2:3:4:6:8 çš„æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯åŠ¨å›¾æ ‡çš„å°ºå¯¸ä¸º48x48 dpï¼Œè¿™è¡¨ç¤ºåœ¨ MDPI çš„å±å¹•ä¸Šå…¶å®é™…å°ºå¯¸åº”ä¸º 48x48 pxï¼Œåœ¨ HDPI çš„å±å¹•ä¸Šå…¶å®é™…å¤§å°æ˜¯ MDPI çš„ 1.5 å€ (72x72 px)ï¼Œåœ¨ XDPI çš„å±å¹•ä¸Šå…¶å®é™…å¤§å°æ˜¯ MDPI çš„ 2 å€ (96x96 px)ï¼Œä¾æ­¤ç±»æ¨ã€‚<br>è™½ç„¶ Android ä¹Ÿæ”¯æŒä½åƒç´ å¯†åº¦ (LDPI) çš„å±å¹•ï¼Œä½†æ— éœ€ä¸ºæ­¤è´¹ç¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°† HDPI å°ºå¯¸çš„å›¾æ ‡ç¼©å°åˆ° 1/2 è¿›è¡ŒåŒ¹é…ã€‚<br>ä¸‹å›¾ä¸ºå›¾æ ‡çš„å„ä¸ªå±å¹•å¯†åº¦çš„å¯¹åº”å°ºå¯¸:</p><table><thead><tr><th>å±å¹•å¯†åº¦</th><th style="text-align:center">å›¾æ ‡å°ºå¯¸</th></tr></thead><tbody><tr><td>mdpi</td><td style="text-align:center">48x48px</td></tr><tr><td>hdpi</td><td style="text-align:center">72x72px</td></tr><tr><td>xhdpi</td><td style="text-align:center">96x96px</td></tr><tr><td>xxhdpi</td><td style="text-align:center">144x144px</td></tr><tr><td>xxxhdpi</td><td style="text-align:center">192x192px</td></tr></tbody></table><h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><h2 id="æ”¯æŒå„ç§å±å¹•å°ºå¯¸"><a href="#æ”¯æŒå„ç§å±å¹•å°ºå¯¸" class="headerlink" title="æ”¯æŒå„ç§å±å¹•å°ºå¯¸"></a>æ”¯æŒå„ç§å±å¹•å°ºå¯¸</h2><h4 id="ä½¿ç”¨wrap-contentã€match-parentã€weight"><a href="#ä½¿ç”¨wrap-contentã€match-parentã€weight" class="headerlink" title="ä½¿ç”¨wrap_contentã€match_parentã€weight"></a>ä½¿ç”¨wrap_contentã€match_parentã€weight</h4><p>ä¸ºäº†ç¡®ä¿å¸ƒå±€çš„çµæ´»æ€§å¹¶é€‚åº”å„ç§å°ºå¯¸çš„å±å¹•ï¼Œåº”å°½é‡ä½¿ç”¨ â€œwrap_contentâ€ å’Œ â€œmatch_parentâ€ æ§åˆ¶æŸäº›è§†å›¾ç»„ä»¶çš„å®½åº¦å’Œé«˜åº¦ã€‚ä½¿ç”¨ â€œwrap_contentâ€ï¼Œç³»ç»Ÿå°±ä¼šå°†è§†å›¾çš„å®½åº¦æˆ–é«˜åº¦è®¾ç½®æˆæ‰€éœ€çš„æœ€å°å°ºå¯¸ä»¥é€‚åº”è§†å›¾ä¸­çš„å†…å®¹ï¼Œè€Œ â€œmatch_parentâ€ï¼ˆåœ¨ä½äº API çº§åˆ« 8 çš„çº§åˆ«ä¸­ç§°ä¸º â€œfill_parentâ€ï¼‰åˆ™ä¼šå±•å¼€ç»„ä»¶ä»¥åŒ¹é…å…¶çˆ¶è§†å›¾çš„å°ºå¯¸ã€‚<br>weightæ˜¯çº¿æ€§å¸ƒå±€çš„ä¸€ä¸ªç‹¬ç‰¹çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå±æ€§æ¥æŒ‰ç…§æ¯”ä¾‹å¯¹ç•Œé¢è¿›è¡Œåˆ†é…ï¼Œå®Œæˆä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸ªå±æ€§çš„è®¡ç®—åº”è¯¥å¦‚ä½•ç†è§£å‘¢ï¼Ÿ<br>é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¸ƒå±€è®¾ç½®ä¸ºçº¿æ€§å¸ƒå±€ï¼Œæ¨ªå‘æ’åˆ—ï¼Œç„¶åæ”¾ç½®ä¸¤ä¸ªå®½åº¦ä¸º0dpçš„æŒ‰é’®ï¼Œåˆ†åˆ«è®¾ç½®weightä¸º1å’Œ2ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡åˆ°ä¸¤ä¸ªæŒ‰é’®æŒ‰ç…§1ï¼š2çš„å®½åº¦æ¯”ä¾‹æ­£å¸¸æ’åˆ—äº†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨åˆ°çš„åœºæ™¯ã€‚ä½†æ˜¯å‡å¦‚æˆ‘ä»¬çš„å®½åº¦ä¸æ˜¯0dp(wrap_contentå’Œ0dpçš„æ•ˆæœç›¸åŒ)ï¼Œè€Œæ˜¯match_parentå‘¢ï¼Ÿ<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå æ¯”å’Œä¸Šé¢æ­£å¥½ç›¸åï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿè¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸æä¸€ä¸‹weightçš„è®¡ç®—æ–¹æ³•äº†ã€‚android:layout_weightçš„çœŸå®å«ä¹‰æ˜¯:å¦‚æœViewè®¾ç½®äº†è¯¥å±æ€§å¹¶ä¸”æœ‰æ•ˆï¼Œé‚£ä¹ˆè¯¥ Viewçš„å®½åº¦ç­‰äºåŸæœ‰å®½åº¦+<strong>å‰©ä½™ç©ºé—´</strong>çš„å æ¯”ã€‚ä»è¿™ä¸ªè§’åº¦æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ç°è±¡ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®æ¯ä¸ªButtonçš„å®½åº¦éƒ½æ˜¯match_parentï¼Œå‡è®¾å±å¹•å®½åº¦ä¸ºLï¼Œé‚£ä¹ˆæ¯ä¸ªButtonçš„å®½åº¦ä¹Ÿåº”è¯¥éƒ½ä¸ºLï¼Œå‰©ä½™å®½åº¦å°±ç­‰äºL-ï¼ˆL+Lï¼‰= -Lã€‚<br>Button1çš„weight=1ï¼Œæ‰€ä»¥æœ€ç»ˆå®½åº¦ä¸ºL+1/3*(-L)=2/3Lï¼ŒButton2çš„è®¡ç®—ç±»ä¼¼ï¼Œæœ€ç»ˆå®½åº¦ä¸ºL+2/3(-L)=1/3Lã€‚<br>åŒæ—¶ï¼Œå‚ç›´æ–¹å‘ä¸Šçš„ç»“è®ºå’Œæ°´å¹³æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚è™½ç„¶è¯´æˆ‘ä»¬æ¼”ç¤ºäº†match_parentçš„æ˜¾ç¤ºæ•ˆæœï¼Œå¹¶è¯´æ˜äº†åŸå› ï¼Œä½†æ˜¯åœ¨çœŸæ­£ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯è®¾ç½®æŸä¸€ä¸ªå±æ€§ä¸º0dpï¼Œç„¶åæŒ‰ç…§æƒé‡è®¡ç®—æ‰€å ç™¾åˆ†æ¯”ã€‚</p><h4 id="ä½¿ç”¨ç›¸å¯¹å¸ƒå±€ï¼Œç¦ç”¨ç»å¯¹å¸ƒå±€"><a href="#ä½¿ç”¨ç›¸å¯¹å¸ƒå±€ï¼Œç¦ç”¨ç»å¯¹å¸ƒå±€" class="headerlink" title="ä½¿ç”¨ç›¸å¯¹å¸ƒå±€ï¼Œç¦ç”¨ç»å¯¹å¸ƒå±€"></a>ä½¿ç”¨ç›¸å¯¹å¸ƒå±€ï¼Œç¦ç”¨ç»å¯¹å¸ƒå±€</h4><p>åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†æ—¶å€™ä½¿ç”¨çš„éƒ½æ˜¯çº¿æ€§å¸ƒå±€ã€ç›¸å¯¹å¸ƒå±€å’Œå¸§å¸ƒå±€ï¼Œç»å¯¹å¸ƒå±€ç”±äºé€‚é…æ€§æå·®ï¼Œæ‰€ä»¥æå°‘ä½¿ç”¨ã€‚<br>ç”±äºå„ç§å¸ƒå±€çš„ç‰¹ç‚¹ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸èƒ½è¯´å“ªä¸ªå¸ƒå±€å¥½ç”¨ï¼Œåˆ°åº•åº”è¯¥ä½¿ç”¨ä»€ä¹ˆå¸ƒå±€åªèƒ½æ ¹æ®å®é™…éœ€æ±‚æ¥ç¡®å®šã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ LinearLayout çš„åµŒå¥—å®ä¾‹å¹¶ç»“åˆ â€œwrap_contentâ€ å’Œ â€œmatch_parentâ€ï¼Œä»¥ä¾¿æ„å»ºç›¸å½“å¤æ‚çš„å¸ƒå±€ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ LinearLayout ç²¾ç¡®æ§åˆ¶å­è§†å›¾çš„ç‰¹æ®Šå…³ç³»ï¼›ç³»ç»Ÿä¼šå°† LinearLayout ä¸­çš„è§†å›¾ç›´æ¥å¹¶æ’åˆ—å‡ºã€‚<br>å¦‚æœæˆ‘ä»¬éœ€è¦å°†å­è§†å›¾æ’åˆ—å‡ºå„ç§æ•ˆæœè€Œä¸æ˜¯ä¸€æ¡ç›´çº¿ï¼Œé€šå¸¸æ›´åˆé€‚çš„è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ RelativeLayoutï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ç»„ä»¶ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»æŒ‡å®šå¸ƒå±€äº†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŸä¸ªå­è§†å›¾å¯¹é½åˆ°å±å¹•å·¦ä¾§ï¼ŒåŒæ—¶å°†å¦ä¸€ä¸ªè§†å›¾å¯¹é½åˆ°å±å¹•å³ä¾§ã€‚</p><h2 id="ä½¿ç”¨é™å®šç¬¦"><a href="#ä½¿ç”¨é™å®šç¬¦" class="headerlink" title="ä½¿ç”¨é™å®šç¬¦"></a>ä½¿ç”¨é™å®šç¬¦</h2><h4 id="ä½¿ç”¨å°ºå¯¸é™å®šç¬¦"><a href="#ä½¿ç”¨å°ºå¯¸é™å®šç¬¦" class="headerlink" title="ä½¿ç”¨å°ºå¯¸é™å®šç¬¦"></a>ä½¿ç”¨å°ºå¯¸é™å®šç¬¦</h4><p>ä¸Šé¢æ‰€æåˆ°çš„çµæ´»å¸ƒå±€æˆ–è€…æ˜¯ç›¸å¯¹å¸ƒå±€ï¼Œå¯ä»¥ä¸ºæˆ‘ä»¬å¸¦æ¥çš„ä¼˜åŠ¿å°±åªæœ‰è¿™ä¹ˆå¤šäº†ã€‚è™½ç„¶è¿™äº›å¸ƒå±€å¯ä»¥æ‹‰ä¼¸ç»„ä»¶å†…å¤–çš„ç©ºé—´ä»¥é€‚åº”å„ç§å±å¹•ï¼Œä½†å®ƒä»¬ä¸ä¸€å®šèƒ½ä¸ºæ¯ç§å±å¹•éƒ½æä¾›æœ€ä½³çš„ç”¨æˆ·ä½“éªŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„åº”ç”¨ä¸ä»…ä»…åªå®æ–½çµæ´»å¸ƒå±€ï¼Œè¿˜åº”è¯¥åº”é’ˆå¯¹å„ç§å±å¹•é…ç½®æä¾›ä¸€äº›å¤‡ç”¨å¸ƒå±€ã€‚<br>å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨é…ç½®é™å®šç¬¦ï¼Œåœ¨è¿è¡Œæ—¶æ ¹æ®å½“å‰çš„è®¾å¤‡é…ç½®è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„èµ„æºäº†ï¼Œä¾‹å¦‚æ ¹æ®å„ç§å±å¹•å°ºå¯¸é€‰æ‹©ä¸åŒçš„å¸ƒå±€ã€‚<br>å¾ˆå¤šåº”ç”¨ä¼šåœ¨è¾ƒå¤§çš„å±å¹•ä¸Šå®æ–½â€œåŒé¢æ¿â€æ¨¡å¼ï¼Œå³åœ¨ä¸€ä¸ªé¢æ¿ä¸Šæ˜¾ç¤ºé¡¹ç›®åˆ—è¡¨ï¼Œè€Œåœ¨å¦ä¸€é¢æ¿ä¸Šæ˜¾ç¤ºå¯¹åº”å†…å®¹ã€‚å¹³æ¿ç”µè„‘å’Œç”µè§†çš„å±å¹•å·²ç»å¤§åˆ°å¯ä»¥åŒæ—¶å®¹çº³è¿™ä¸¤ä¸ªé¢æ¿äº†ï¼Œä½†æ‰‹æœºå±å¹•å°±éœ€è¦åˆ†åˆ«æ˜¾ç¤ºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–‡ä»¶ä»¥ä¾¿å®æ–½è¿™äº›å¸ƒå±€ï¼š<br>res/layout/main.xmlï¼Œå•é¢æ¿ï¼ˆé»˜è®¤ï¼‰å¸ƒå±€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:orientation=&quot;vertical&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>res/layout-large/main.xmlï¼ŒåŒé¢æ¿å¸ƒå±€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;400dp&quot;</span><br><span class="line">android:layout_marginRight=&quot;10dp&quot;/&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/article&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.ArticleFragment&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>è¯·æ³¨æ„ç¬¬äºŒç§å¸ƒå±€åç§°ç›®å½•ä¸­çš„ large é™å®šç¬¦ã€‚ç³»ç»Ÿä¼šåœ¨å±äºè¾ƒå¤§å±å¹•ï¼ˆä¾‹å¦‚ 7 è‹±å¯¸æˆ–æ›´å¤§çš„å¹³æ¿ç”µè„‘ï¼‰çš„è®¾å¤‡ä¸Šé€‰æ‹©æ­¤å¸ƒå±€ã€‚ç³»ç»Ÿä¼šåœ¨è¾ƒå°çš„å±å¹•ä¸Šé€‰æ‹©å…¶ä»–å¸ƒå±€ï¼ˆæ— é™å®šç¬¦ï¼‰ã€‚</p><h4 id="ä½¿ç”¨æœ€å°å®½åº¦é™å®šç¬¦"><a href="#ä½¿ç”¨æœ€å°å®½åº¦é™å®šç¬¦" class="headerlink" title="ä½¿ç”¨æœ€å°å®½åº¦é™å®šç¬¦"></a>ä½¿ç”¨æœ€å°å®½åº¦é™å®šç¬¦</h4><p>åœ¨ç‰ˆæœ¬ä½äº 3.2 çš„ Android è®¾å¤‡ä¸Šï¼Œå¼€å‘äººå‘˜é‡åˆ°çš„é—®é¢˜ä¹‹ä¸€æ˜¯â€œè¾ƒå¤§â€å±å¹•çš„å°ºå¯¸èŒƒå›´ï¼Œè¯¥é—®é¢˜ä¼šå½±å“æˆ´å°” Streakã€æ—©æœŸçš„ Galaxy Tab ä»¥åŠå¤§éƒ¨åˆ† 7 è‹±å¯¸å¹³æ¿ç”µè„‘ã€‚å³ä½¿è¿™äº›è®¾å¤‡çš„å±å¹•å±äºâ€œè¾ƒå¤§â€çš„å°ºå¯¸ï¼Œä½†å¾ˆå¤šåº”ç”¨å¯èƒ½ä¼šé’ˆå¯¹æ­¤ç±»åˆ«ä¸­çš„å„ç§è®¾å¤‡æ˜¾ç¤ºä¸åŒçš„å¸ƒå±€ï¼ˆâ€œè¾ƒå¤§â€çš„æ¦‚å¿µä¸æ¸…æ™°å¯¼è‡´çš„ï¼‰ã€‚è¿™å°±æ˜¯ Android 3.2 ç‰ˆåœ¨å¼•å…¥å…¶ä»–é™å®šç¬¦çš„åŒæ—¶å¼•å…¥â€œæœ€å°å®½åº¦â€é™å®šç¬¦çš„åŸå› ã€‚<br>æœ€å°å®½åº¦é™å®šç¬¦å¯è®©æ‚¨é€šè¿‡æŒ‡å®šæŸä¸ªæœ€å°å®½åº¦ï¼ˆä»¥ dp ä¸ºå•ä½ï¼‰æ¥å®šä½å±å¹•ã€‚ä¾‹å¦‚ï¼Œæ ‡å‡† 7 è‹±å¯¸å¹³æ¿ç”µè„‘çš„æœ€å°å®½åº¦ä¸º 600 dpï¼Œå› æ­¤å¦‚æœæ‚¨è¦åœ¨æ­¤ç±»å±å¹•ä¸Šçš„ç”¨æˆ·ç•Œé¢ä¸­ä½¿ç”¨åŒé¢æ¿ï¼ˆä½†åœ¨è¾ƒå°çš„å±å¹•ä¸Šåªæ˜¾ç¤ºåˆ—è¡¨ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸Šæ–‡ä¸­æ‰€è¿°çš„å•é¢æ¿å’ŒåŒé¢æ¿è¿™ä¸¤ç§å¸ƒå±€ï¼Œä½†æ‚¨åº”ä½¿ç”¨ sw600dp æŒ‡æ˜åŒé¢æ¿å¸ƒå±€ä»…é€‚ç”¨äºæœ€å°å®½åº¦ä¸º 600 dp çš„å±å¹•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ large å°ºå¯¸é™å®šç¬¦ã€‚<br>res/layout/main.xmlï¼Œå•é¢æ¿ï¼ˆé»˜è®¤ï¼‰å¸ƒå±€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:orientation=&quot;vertical&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>res/layout-sw600dp/main.xmlï¼ŒåŒé¢æ¿å¸ƒå±€ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;400dp&quot;</span><br><span class="line">android:layout_marginRight=&quot;10dp&quot;/&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/article&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.ArticleFragment&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæœ€å°å®½åº¦å¤§äºç­‰äº 600 dp çš„è®¾å¤‡ï¼Œç³»ç»Ÿä¼šé€‰æ‹© layout-sw600dp/main.xmlï¼ˆåŒé¢æ¿ï¼‰å¸ƒå±€ï¼Œå¦åˆ™ç³»ç»Ÿå°±ä¼šé€‰æ‹© layout/main.xmlï¼ˆå•é¢æ¿ï¼‰å¸ƒå±€ã€‚<br>ä½† Android ç‰ˆæœ¬ä½äº 3.2 çš„è®¾å¤‡ä¸æ”¯æŒæ­¤æŠ€æœ¯ï¼ŒåŸå› æ˜¯è¿™äº›è®¾å¤‡æ— æ³•å°† sw600dp è¯†åˆ«ä¸ºå°ºå¯¸é™å®šç¬¦ï¼Œå› æ­¤æˆ‘ä»¬ä»éœ€ä½¿ç”¨ large é™å®šç¬¦ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªåç§°ä¸º res/layout-large/main.xml çš„æ–‡ä»¶ï¼ˆä¸ res/layout-sw600dp/main.xml ä¸€æ ·ï¼‰ã€‚ä½†æ˜¯æ²¡æœ‰å¤ªå¤§å…³ç³»ï¼Œæˆ‘ä»¬å°†é©¬ä¸Šå­¦ä¹ å¦‚ä½•é¿å…æ­¤ç±»å¸ƒå±€æ–‡ä»¶å‡ºç°çš„é‡å¤ã€‚</p><h4 id="ä½¿ç”¨å¸ƒå±€åˆ«å"><a href="#ä½¿ç”¨å¸ƒå±€åˆ«å" class="headerlink" title="ä½¿ç”¨å¸ƒå±€åˆ«å"></a>ä½¿ç”¨å¸ƒå±€åˆ«å</h4><p>æœ€å°å®½åº¦é™å®šç¬¦ä»…é€‚ç”¨äº Android 3.2 åŠæ›´é«˜ç‰ˆæœ¬ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ä»éœ€ä½¿ç”¨ä¸è¾ƒä½ç‰ˆæœ¬å…¼å®¹çš„æ¦‚æ‹¬å°ºå¯¸èŒƒå›´ï¼ˆå°ã€æ­£å¸¸ã€å¤§å’Œç‰¹å¤§ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦å°†ç”¨æˆ·ç•Œé¢è®¾è®¡æˆåœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºå•é¢æ¿ï¼Œä½†åœ¨ 7 è‹±å¯¸å¹³æ¿ç”µè„‘ã€ç”µè§†å’Œå…¶ä»–è¾ƒå¤§çš„è®¾å¤‡ä¸Šæ˜¾ç¤ºå¤šé¢æ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æä¾›ä»¥ä¸‹æ–‡ä»¶ï¼š</p><ul><li>res/layout/main.xml: å•é¢æ¿å¸ƒå±€</li><li>res/layout-large: å¤šé¢æ¿å¸ƒå±€</li><li>res/layout-sw600dp: å¤šé¢æ¿å¸ƒå±€</li></ul><p>åä¸¤ä¸ªæ–‡ä»¶æ˜¯ç›¸åŒçš„ï¼Œå› ä¸ºå…¶ä¸­ä¸€ä¸ªç”¨äºå’Œ Android 3.2 è®¾å¤‡åŒ¹é…ï¼Œè€Œå¦ä¸€ä¸ªåˆ™æ˜¯ä¸ºä½¿ç”¨è¾ƒä½ç‰ˆæœ¬ Android çš„å¹³æ¿ç”µè„‘å’Œç”µè§†å‡†å¤‡çš„ã€‚<br>è¦é¿å…å¹³æ¿ç”µè„‘å’Œç”µè§†çš„æ–‡ä»¶å‡ºç°é‡å¤ï¼ˆä»¥åŠç”±æ­¤å¸¦æ¥çš„ç»´æŠ¤é—®é¢˜ï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åˆ«åæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å®šä¹‰ä»¥ä¸‹å¸ƒå±€ï¼š</p><ul><li>res/layout/main.xmlï¼Œå•é¢æ¿å¸ƒå±€</li><li>res/layout/main_twopanes.xmlï¼ŒåŒé¢æ¿å¸ƒå±€</li></ul><p>ç„¶åæ·»åŠ è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š<br>res/values-large/layout.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main&quot; type=&quot;layout&quot;&gt;@layout/main_twopanes&lt;/item&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>res/values-sw600dp/layout.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main&quot; type=&quot;layout&quot;&gt;@layout/main_twopanes&lt;/item&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>åä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹ç›¸åŒï¼Œä½†å®ƒä»¬å¹¶æœªå®é™…å®šä¹‰å¸ƒå±€ã€‚å®ƒä»¬åªæ˜¯å°† main è®¾ç½®æˆäº† main_twopanes çš„åˆ«åã€‚ç”±äºè¿™äº›æ–‡ä»¶åŒ…å« large å’Œ sw600dp é€‰æ‹©å™¨ï¼Œå› æ­¤æ— è®º Android ç‰ˆæœ¬å¦‚ä½•ï¼Œç³»ç»Ÿéƒ½ä¼šå°†è¿™äº›æ–‡ä»¶åº”ç”¨åˆ°å¹³æ¿ç”µè„‘å’Œç”µè§†ä¸Šï¼ˆç‰ˆæœ¬ä½äº 3.2 çš„å¹³æ¿ç”µè„‘å’Œç”µè§†ä¼šåŒ¹é… largeï¼Œç‰ˆæœ¬é«˜äº 3.2 çš„å¹³æ¿ç”µè„‘å’Œç”µè§†åˆ™ä¼šåŒ¹é… sw600dpï¼‰ã€‚</p><h4 id="ä½¿ç”¨å±å¹•æ–¹å‘é™å®šç¬¦"><a href="#ä½¿ç”¨å±å¹•æ–¹å‘é™å®šç¬¦" class="headerlink" title="ä½¿ç”¨å±å¹•æ–¹å‘é™å®šç¬¦"></a>ä½¿ç”¨å±å¹•æ–¹å‘é™å®šç¬¦</h4><p>æŸäº›å¸ƒå±€ä¼šåŒæ—¶æ”¯æŒæ¨ªå‘æ¨¡å¼å’Œçºµå‘æ¨¡å¼ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´ä¼˜åŒ–å…¶ä¸­å¤§éƒ¨åˆ†å¸ƒå±€çš„æ•ˆæœã€‚åœ¨æ–°é—»é˜…è¯»å™¨ç¤ºä¾‹åº”ç”¨ä¸­ï¼Œæ¯ç§å±å¹•å°ºå¯¸å’Œå±å¹•æ–¹å‘ä¸‹çš„å¸ƒå±€è¡Œä¸ºæ–¹å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>å°å±å¹•ï¼Œçºµå‘ï¼šå•é¢æ¿ï¼Œå¸¦å¾½æ ‡</li><li>å°å±å¹•ï¼Œæ¨ªå‘ï¼šå•é¢æ¿ï¼Œå¸¦å¾½æ ‡</li><li>7 è‹±å¯¸å¹³æ¿ç”µè„‘ï¼Œçºµå‘ï¼šå•é¢æ¿ï¼Œå¸¦æ“ä½œæ </li><li>7 è‹±å¯¸å¹³æ¿ç”µè„‘ï¼Œæ¨ªå‘ï¼šåŒé¢æ¿ï¼Œå®½ï¼Œå¸¦æ“ä½œæ </li><li>10 è‹±å¯¸å¹³æ¿ç”µè„‘ï¼Œçºµå‘ï¼šåŒé¢æ¿ï¼Œçª„ï¼Œå¸¦æ“ä½œæ </li><li>10 è‹±å¯¸å¹³æ¿ç”µè„‘ï¼Œæ¨ªå‘ï¼šåŒé¢æ¿ï¼Œå®½ï¼Œå¸¦æ“ä½œæ </li><li>ç”µè§†ï¼Œæ¨ªå‘ï¼šåŒé¢æ¿ï¼Œå®½ï¼Œå¸¦æ“ä½œæ </li></ul><p>å› æ­¤ï¼Œè¿™äº›å¸ƒå±€ä¸­çš„æ¯ä¸€ç§éƒ½å®šä¹‰åœ¨äº† res/layout/ ç›®å½•ä¸‹çš„æŸä¸ª XML æ–‡ä»¶ä¸­ã€‚ä¸ºäº†ç»§ç»­å°†æ¯ä¸ªå¸ƒå±€åˆ†é…ç»™å„ç§å±å¹•é…ç½®ï¼Œè¯¥åº”ç”¨ä¼šä½¿ç”¨å¸ƒå±€åˆ«åå°†ä¸¤è€…ç›¸åŒ¹é…ï¼š<br>res/layout/onepane.xml:(å•é¢æ¿)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:orientation=&quot;vertical&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>res/layout/onepane_with_bar.xml:(å•é¢æ¿å¸¦æ“ä½œæ )<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:orientation=&quot;vertical&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line">&lt;LinearLayout android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:id=&quot;@+id/linearLayout1&quot;  </span><br><span class="line">android:gravity=&quot;center&quot;</span><br><span class="line">android:layout_height=&quot;50dp&quot;&gt;</span><br><span class="line">&lt;ImageView android:id=&quot;@+id/imageView1&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:src=&quot;@drawable/logo&quot;</span><br><span class="line">android:paddingRight=&quot;30dp&quot;</span><br><span class="line">android:layout_gravity=&quot;left&quot;</span><br><span class="line">android:layout_weight=&quot;0&quot; /&gt;</span><br><span class="line">&lt;View android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:id=&quot;@+id/view1&quot;</span><br><span class="line">android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_weight=&quot;1&quot; /&gt;</span><br><span class="line">&lt;Button android:id=&quot;@+id/categorybutton&quot;</span><br><span class="line">android:background=&quot;@drawable/button_bg&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">android:layout_weight=&quot;0&quot;</span><br><span class="line">android:layout_width=&quot;120dp&quot;</span><br><span class="line">style=&quot;@style/CategoryButtonStyle&quot;/&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br><span class="line"></span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>res/layout/twopanes.xml:(åŒé¢æ¿ï¼Œå®½å¸ƒå±€)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;400dp&quot;</span><br><span class="line">android:layout_marginRight=&quot;10dp&quot;/&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/article&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.ArticleFragment&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>res/layout/twopanes_narrow.xml:(åŒé¢æ¿ï¼Œçª„å¸ƒå±€)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/headlines&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.HeadlinesFragment&quot;</span><br><span class="line">android:layout_width=&quot;200dp&quot;</span><br><span class="line">android:layout_marginRight=&quot;10dp&quot;/&gt;</span><br><span class="line">&lt;fragment android:id=&quot;@+id/article&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">android:name=&quot;com.example.android.newsreader.ArticleFragment&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot; /&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p><p>æ—¢ç„¶æˆ‘ä»¬å·²å®šä¹‰äº†æ‰€æœ‰å¯èƒ½çš„å¸ƒå±€ï¼Œé‚£å°±åªéœ€ä½¿ç”¨é…ç½®é™å®šç¬¦å°†æ­£ç¡®çš„å¸ƒå±€æ˜ å°„åˆ°å„ç§é…ç½®å³å¯ã€‚<br>ç°åœ¨åªéœ€ä½¿ç”¨å¸ƒå±€åˆ«åæŠ€æœ¯å³å¯åšåˆ°è¿™ä¸€ç‚¹ï¼š<br>res/values/layouts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main_layout&quot; type=&quot;layout&quot;&gt;@layout/onepane_with_bar&lt;/item&gt;</span><br><span class="line">&lt;bool name=&quot;has_two_panes&quot;&gt;false&lt;/bool&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>res/values-sw600dp-land/layouts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main_layout&quot; type=&quot;layout&quot;&gt;@layout/twopanes&lt;/item&gt;</span><br><span class="line">&lt;bool name=&quot;has_two_panes&quot;&gt;true&lt;/bool&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>res/values-sw600dp-port/layouts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main_layout&quot; type=&quot;layout&quot;&gt;@layout/onepane&lt;/item&gt;</span><br><span class="line">&lt;bool name=&quot;has_two_panes&quot;&gt;false&lt;/bool&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>res/values-large-land/layouts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main_layout&quot; type=&quot;layout&quot;&gt;@layout/twopanes&lt;/item&gt;</span><br><span class="line">&lt;bool name=&quot;has_two_panes&quot;&gt;true&lt;/bool&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><p>res/values-large-port/layouts.xml:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;resources&gt;</span><br><span class="line">&lt;item name=&quot;main_layout&quot; type=&quot;layout&quot;&gt;@layout/twopanes_narrow&lt;/item&gt;</span><br><span class="line">&lt;bool name=&quot;has_two_panes&quot;&gt;true&lt;/bool&gt;</span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure></p><h2 id="ä½¿ç”¨è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾-9å›¾"><a href="#ä½¿ç”¨è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾-9å›¾" class="headerlink" title="ä½¿ç”¨è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾(.9å›¾)"></a>ä½¿ç”¨è‡ªåŠ¨æ‹‰ä¼¸ä½å›¾(.9å›¾)</h2><p>åœ¨Androidçš„è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†é€‚é…ä¸åŒçš„æ‰‹æœºåˆ†è¾¨ç‡ï¼Œå›¾ç‰‡å¤§å¤šéœ€è¦æ‹‰ä¼¸æˆ–è€…å‹ç¼©ï¼Œè¿™æ ·å°±å‡ºç°äº†å¯ä»¥ä»»æ„è°ƒæ•´å¤§å°çš„ä¸€ç§å›¾ç‰‡æ ¼å¼â€œ.9.pngâ€ã€‚<a href="http://blog.csdn.net/lastwarmth/article/details/49991445" target="_blank" rel="noopener">è¯¦ç»†æ•™ç¨‹è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« </a>ã€‚</p><h2 id="æ”¯æŒå„ç§å±å¹•å¯†åº¦"><a href="#æ”¯æŒå„ç§å±å¹•å¯†åº¦" class="headerlink" title="æ”¯æŒå„ç§å±å¹•å¯†åº¦"></a>æ”¯æŒå„ç§å±å¹•å¯†åº¦</h2><h4 id="ä½¿ç”¨å¯†åº¦æ— å…³åƒç´ "><a href="#ä½¿ç”¨å¯†åº¦æ— å…³åƒç´ " class="headerlink" title="ä½¿ç”¨å¯†åº¦æ— å…³åƒç´ "></a>ä½¿ç”¨å¯†åº¦æ— å…³åƒç´ </h4><p>ç”±äºå„ç§å±å¹•çš„åƒç´ å¯†åº¦éƒ½æœ‰æ‰€ä¸åŒï¼Œå› æ­¤ç›¸åŒæ•°é‡çš„åƒç´ åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„å®é™…å¤§å°ä¹Ÿæœ‰æ‰€å·®å¼‚ï¼Œè¿™æ ·ä½¿ç”¨åƒç´ å®šä¹‰å¸ƒå±€å°ºå¯¸å°±ä¼šäº§ç”Ÿé—®é¢˜ã€‚å› æ­¤ï¼Œè¯·åŠ¡å¿…ä½¿ç”¨ dp æˆ– sp å•ä½æŒ‡å®šå°ºå¯¸ã€‚<br>ä¾‹å¦‚ï¼Œè¯·ä½¿ç”¨ dpï¼ˆè€Œé pxï¼‰æŒ‡å®šä¸¤ä¸ªè§†å›¾é—´çš„é—´è·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:text=&quot;@string/clickme&quot;</span><br><span class="line">android:layout_marginTop=&quot;20dp&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>è¯·åŠ¡å¿…ä½¿ç”¨ sp æŒ‡å®šæ–‡å­—å¤§å°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">android:textSize=&quot;20sp&quot; /&gt;</span><br></pre></td></tr></table></figure><p>é™¤äº†ä»‹ç»è¿™äº›æœ€åŸºç¡€çš„çŸ¥è¯†ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¸‹é¢å†æ¥è®¨è®ºä¸€ä¸‹å¦å¤–ä¸€ä¸ªé—®é¢˜ã€‚<br>ç»è¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬éƒ½æ¸…æ¥šï¼Œä¸ºäº†èƒ½å¤Ÿè§„é¿ä¸åŒåƒç´ å¯†åº¦çš„é™·é˜±ï¼ŒGoogleæ¨èä½¿ç”¨dpæ¥ä»£æ›¿pxä½œä¸ºæ§ä»¶é•¿åº¦çš„åº¦é‡å•ä½ï¼Œä½†æ˜¯æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¸€ä¸ªåœºæ™¯ã€‚<br>å‡å¦‚æˆ‘ä»¬ä»¥Nexus5ä½œä¸ºä¹¦å†™ä»£ç æ—¶æŸ¥çœ‹æ•ˆæœçš„æµ‹è¯•æœºå‹ï¼ŒNexus5çš„æ€»å®½åº¦ä¸º360dpï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦åœ¨æ°´å¹³æ–¹å‘ä¸Šæ”¾ç½®ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªæ˜¯150dpå·¦å¯¹é½ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯200dpå³å¯¹é½ï¼Œæœ€åä¸­é—´ç•™æœ‰10dpé—´éš”ã€‚<br>ä½†æ˜¯å¦‚æœåœ¨Nexus Sæˆ–è€…æ˜¯Nexus Oneè¿è¡Œï¼Œä¸¤ä¸ªæŒ‰é’®å°±å‘ç”Ÿäº†é‡å ã€‚æˆ‘ä»¬éƒ½å·²ç»ç”¨äº†dpäº†ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿ<br>è™½ç„¶è¯´dpå¯ä»¥å»é™¤ä¸åŒåƒç´ å¯†åº¦çš„é—®é¢˜ï¼Œä½¿å¾—1dpåœ¨ä¸åŒåƒç´ å¯†åº¦ä¸Šé¢çš„ç‰©ç†é•¿åº¦åŸºæœ¬ç›¸åŒ(å¦‚æœxdpiï¼Œydpiä¸densityDpiä¸ä¸€æ ·ï¼Œåˆ™ç‰©ç†é•¿åº¦ä¼šæœ‰åå·®)ï¼Œä½†æ˜¯è¿˜æ˜¯ç”±äºAndroidå±å¹•è®¾å¤‡çš„å¤šæ ·æ€§ï¼Œå¦‚æœä½¿ç”¨dpæ¥ä½œä¸ºåº¦é‡å•ä½ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å±å¹•çš„å®½åº¦éƒ½æ˜¯ç›¸åŒçš„dpé•¿åº¦ï¼Œæ¯”å¦‚è¯´ï¼ŒNexus Så’ŒNexus Oneå±äºhdpiï¼Œå±å¹•å®½åº¦æ˜¯320dpï¼Œè€ŒNexus 5å±äºxxhdpiï¼Œå±å¹•å®½åº¦æ˜¯360dpï¼ŒGalaxy Nexuså±äºxhdpiï¼Œå±å¹•å®½åº¦æ˜¯384dpï¼ŒNexus 6 å±äºxxxhdpiï¼Œå±å¹•å®½åº¦æ˜¯410dpã€‚æ‰€ä»¥è¯´ï¼Œå…‰Googleè‡ªå·±ä¸€å®¶çš„äº§å“å°±å·²ç»æœ‰è¿™ä¹ˆå¤šçš„æ ‡å‡†ï¼Œè€Œä¸”å±å¹•å®½åº¦å’Œåƒç´ å¯†åº¦æ²¡æœ‰ä»»ä½•å…³è”å…³ç³»ï¼Œå³ä½¿æˆ‘ä»¬ä½¿ç”¨dpï¼Œåœ¨320dpå®½åº¦çš„è®¾å¤‡å’Œ410dpçš„è®¾å¤‡ä¸Šï¼Œè¿˜æ˜¯ä¼šæœ‰90dpçš„å·®åˆ«ã€‚<br>æ‰€ä»¥æ€»ç»“çš„ç»“æœæ˜¯ï¼Œ<strong>æˆ‘ä»¬è¦å°½é‡ä½¿ç”¨match_parentå’Œwrap_contentï¼Œå°½å¯èƒ½å°‘çš„ç”¨dpæ¥æŒ‡å®šæ§ä»¶çš„å…·ä½“é•¿å®½ï¼Œå†ç»“åˆä¸Šæƒé‡ï¼Œå¤§éƒ¨åˆ†çš„æƒ…å†µæˆ‘ä»¬éƒ½æ˜¯å¯ä»¥åšåˆ°é€‚é…çš„ã€‚</strong>å¦‚æœé‡åˆ°ä¸Šè¿°æƒ…å†µçš„è¯ï¼Œè¿™é‡Œæœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯ï¼Œæˆ‘ä»¬å‡è®¾æ‰‹æœºå±å¹•çš„å®½åº¦éƒ½æ˜¯320æŸå•ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä¸€ä¸ªå±å¹•å®½åº¦çš„æ€»åƒç´ æ•°å¹³å‡åˆ†æˆ320ä»½ï¼Œæ¯ä¸€ä»½å¯¹åº”å…·ä½“çš„åƒç´ å°±å¯ä»¥äº†ã€‚<a href="http://blog.csdn.net/lmj623565791/article/details/45460089" target="_blank" rel="noopener">å…·ä½“ä»‹ç»å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚</a></p><h4 id="æä¾›å¤‡ç”¨ä½å›¾"><a href="#æä¾›å¤‡ç”¨ä½å›¾" class="headerlink" title="æä¾›å¤‡ç”¨ä½å›¾"></a>æä¾›å¤‡ç”¨ä½å›¾</h4><p>ç”±äº Android å¯åœ¨å…·æœ‰å„ç§å±å¹•å¯†åº¦çš„è®¾å¤‡ä¸Šè¿è¡Œï¼Œå› æ­¤æˆ‘ä»¬æä¾›çš„ä½å›¾èµ„æºåº”å§‹ç»ˆå¯ä»¥æ»¡è¶³å„ç±»æ™®éå¯†åº¦èŒƒå›´çš„è¦æ±‚ï¼šä½å¯†åº¦ã€ä¸­ç­‰å¯†åº¦ã€é«˜å¯†åº¦ä»¥åŠè¶…é«˜å¯†åº¦ã€‚è¿™å°†æœ‰åŠ©äºæˆ‘ä»¬çš„å›¾ç‰‡åœ¨æ‰€æœ‰å±å¹•å¯†åº¦ä¸Šéƒ½èƒ½å¾—åˆ°å‡ºè‰²çš„è´¨é‡å’Œæ•ˆæœã€‚<br>è¦ç”Ÿæˆè¿™äº›å›¾ç‰‡ï¼Œæˆ‘ä»¬åº”å…ˆæå–çŸ¢é‡æ ¼å¼çš„åŸå§‹èµ„æºï¼Œç„¶åæ ¹æ®ä»¥ä¸‹å°ºå¯¸èŒƒå›´é’ˆå¯¹å„å¯†åº¦ç”Ÿæˆç›¸åº”çš„å›¾ç‰‡ã€‚</p><ul><li>xhdpiï¼š2.0</li><li>hdpiï¼š1.5</li><li>mdpiï¼š1.0ï¼ˆæœ€ä½è¦æ±‚ï¼‰</li><li>ldpiï¼š0.75</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ä¸º xhdpi è®¾å¤‡ç”Ÿæˆäº† 200x200 pxå°ºå¯¸çš„å›¾ç‰‡ï¼Œå°±åº”è¯¥ä½¿ç”¨åŒä¸€èµ„æºä¸º hdpiã€mdpi å’Œ ldpi è®¾å¤‡åˆ†åˆ«ç”Ÿæˆ 150x150ã€100x100 å’Œ 75x75 å°ºå¯¸çš„å›¾ç‰‡ã€‚ç„¶åï¼Œå°†ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶æ”¾åœ¨ res/ ä¸‹çš„ç›¸åº”å­ç›®å½•ä¸­(mdpiã€hdpiã€xhdpiã€xxhdpi)ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ®è¿è¡Œæ‚¨åº”ç”¨çš„è®¾å¤‡çš„å±å¹•å¯†åº¦è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å›¾ç‰‡ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>å®é™…å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸éƒ½ä¼šåšä¸‰å¥—é…å›¾ï¼Œå¯¹åº”ç€drawable-hdpiã€drawable-xhdpiã€drawable-xxhdpiä¸‰ä¸ªæ–‡ä»¶å¤¹ã€‚å½“ç„¶æ—¶é—´èµ¶çš„è¯ï¼Œåšä¸€å¥—ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å…·ä½“å¯ä»¥å‚è€ƒ<a href="https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&amp;mid=2650235875&amp;idx=1&amp;sn=add1f85f961b2e70164900cc287b1e66&amp;scene=38#wechat_redirect" target="_blank" rel="noopener">ç‹æœˆåŠå­çš„æ–‡ç« </a>å’Œ<a href="http://www.imooc.com/article/7265" target="_blank" rel="noopener">æ…•è¯¾ç½‘çš„è¿™ç¯‡æ–‡ç« </a>ã€‚å¯¹äºæ…•è¯¾ç½‘çš„è¿™ç¯‡ï¼Œå…¶ä¸­å¯¹èµ„æºçš„åŠ è½½ç­–ç•¥åšäº†è¯¦ç»†çš„è®²è§£ï¼Œå€¼å¾—ä¸€çœ‹ï¼ŒåŒæ—¶ï¼Œæ…•è¯¾ç½‘ä¸€æ–‡æ‰€æåŠçš„èµ„æºåŠ è½½ç­–ç•¥åŒæ ·é€‚ç”¨äºvaluesæ–‡ä»¶å¤¹ã€‚å¯¹äºç‹æœˆåŠå­çš„æ–‡ç« ä¸­æœ‰æåŠè¿‡mipmapå’Œdrawableçš„åŒºåˆ«ï¼Œæˆ‘åœ¨æ­¤åŸºç¡€ä¸Šçš„æ€»ç»“æ˜¯APPçš„æ¡Œé¢å›¾æ ‡åšå†³ç”¨mipmap-[<em>]dpiï¼Œå…¶å®ƒçš„èµ„æºé™¤æ‰€æåŠçš„å¿…é¡»æ”¾åœ¨drawableæ–‡ä»¶å¤¹ä¸­çš„å¤–ï¼Œgoogleå¹¶æ²¡æœ‰ç»™å‡ºæ˜ç¡®çš„æŒ‡ç¤ºï¼Œæ‰€ä»¥æ”¾mipmap-[</em>]dpiä¸­å’Œdrawable-[*]dpiéƒ½å¯ä»¥ã€‚æœ€åè¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœæœ‰çš„æ‰‹æœºå°ºå¯¸æ¯”è¾ƒå¥‡è‘©ï¼Œå¯ä»¥è¯•è¯•w<n>dpé™å®šç¬¦ï¼Œè¿˜æ˜¯ä¸è¡Œçš„è¯ï¼Œå°±å»ºè®®åŠ¨æ€è®¾ç½®äº†ã€‚</n></p></blockquote><p>è¿™æ ·ä¸€æ¥ï¼Œåªè¦æˆ‘ä»¬å¼•ç”¨ @drawable/idï¼Œç³»ç»Ÿéƒ½èƒ½æ ¹æ®ç›¸åº”å±å¹•çš„ dpi é€‰å–åˆé€‚çš„ä½å›¾ã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢æåˆ°çš„å›¾æ ‡è®¾è®¡å°ºå¯¸å—ï¼Ÿå’Œè¿™ä¸ªå…¶å®æ˜¯ä¸€ä¸ªæ„æ€ã€‚ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ä¸‹ï¼Œ<strong>å¦‚æœæ˜¯.9å›¾æˆ–è€…æ˜¯ä¸éœ€è¦å¤šä¸ªåˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œå°±æ”¾åœ¨drawableæ–‡ä»¶å¤¹å³å¯ã€‚</strong></p><blockquote><p>drawableå¯¹åº”çš„dpiæ˜¯160dpiï¼Œç›¸å½“äºdrawable-mdpiï¼Œä½†æ˜¯ä¸ä¼šä½œä¸ºä¸€ä¸ªç‰¹å®šdpiçš„æ–‡ä»¶å¤¹ä½¿ç”¨ã€‚å®ƒçš„ä½œç”¨æ˜¯å­˜æ”¾ä¸€äº›xmlæ–‡ä»¶ã€.9å›¾ä»¥åŠä¸€äº›ä¸éœ€è¦é€‚é…å¤šä¸ªåˆ†è¾¨ç‡çš„å›¾ç‰‡ã€‚</p></blockquote><h1 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h1><h2 id="å…³äºé«˜æ¸…è®¾è®¡å›¾å°ºå¯¸"><a href="#å…³äºé«˜æ¸…è®¾è®¡å›¾å°ºå¯¸" class="headerlink" title="å…³äºé«˜æ¸…è®¾è®¡å›¾å°ºå¯¸"></a>å…³äºé«˜æ¸…è®¾è®¡å›¾å°ºå¯¸</h2><p>Googleå®˜æ–¹ç»™å‡ºçš„é«˜æ¸…è®¾è®¡å›¾å°ºå¯¸æœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œä¸€ç§æ˜¯ä»¥mdpiè®¾è®¡ï¼Œç„¶åå¯¹åº”æ”¾å¤§å¾—åˆ°æ›´é«˜åˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯ä»¥é«˜åˆ†è¾¨ç‡ä½œä¸ºè®¾è®¡å¤§å°ï¼Œç„¶åæŒ‰ç…§å€æ•°å¯¹åº”ç¼©å°åˆ°å°åˆ†è¾¨ç‡çš„å›¾ç‰‡ã€‚<br>æ ¹æ®ç»éªŒï¼Œæˆ‘æ›´æ¨èç¬¬äºŒç§æ–¹æ³•ï¼Œå› ä¸ºå°åˆ†è¾¨ç‡åœ¨ç”Ÿæˆé«˜åˆ†è¾¨ç‡å›¾ç‰‡çš„æ—¶å€™ï¼Œä¼šå‡ºç°åƒç´ ä¸¢å¤±ï¼Œæˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯æœ‰æ–¹æ³•å¯ä»¥é˜»æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿã€‚<br>è€Œåˆ†è¾¨ç‡å¯ä»¥ä»¥1280*720æˆ–è€…æ˜¯1960*1080ä½œä¸ºä¸»è¦åˆ†è¾¨ç‡è¿›è¡Œè®¾è®¡ã€‚è¿™é‡Œæœ‰ä¸€ç¯‡å…³äº<a href="https://www.25xt.com/android" target="_blank" rel="noopener">UIè®¾è®¡çš„è§„èŒƒè¯´æ˜</a>,UIè®¾è®¡æ—¶å¯ä»¥å‚è€ƒã€‚</p><h2 id="ImageViewçš„ScaleTypeå±æ€§"><a href="#ImageViewçš„ScaleTypeå±æ€§" class="headerlink" title="ImageViewçš„ScaleTypeå±æ€§"></a>ImageViewçš„ScaleTypeå±æ€§</h2><p>è®¾ç½®ä¸åŒçš„ScaleTypeä¼šå¾—åˆ°ä¸åŒçš„æ˜¾ç¤ºæ•ˆæœï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè®¾ç½®ä¸ºcenterCropèƒ½è·å¾—è¾ƒå¥½çš„é€‚é…æ•ˆæœã€‚</p><h2 id="åŠ¨æ€è®¾ç½®"><a href="#åŠ¨æ€è®¾ç½®" class="headerlink" title="åŠ¨æ€è®¾ç½®"></a>åŠ¨æ€è®¾ç½®</h2><p>æœ‰ä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åŠ¨æ€çš„è®¾ç½®æ§ä»¶å¤§å°æˆ–è€…æ˜¯ä½ç½®ï¼Œæ¯”å¦‚è¯´popwindowçš„æ˜¾ç¤ºä½ç½®å’Œåç§»é‡ç­‰ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„è·å–å½“å‰çš„å±å¹•å±æ€§ï¼Œç„¶åè®¾ç½®åˆé€‚çš„æ•°å€¼ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class ScreenSizeUtil &#123;</span><br><span class="line"></span><br><span class="line">public static int getScreenWidth(Activity activity) &#123;</span><br><span class="line">return activity.getWindowManager().getDefaultDisplay().getWidth();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int getScreenHeight(Activity activity) &#123;</span><br><span class="line">return activity.getWindowManager().getDefaultDisplay().getHeight();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="http://blog.csdn.net/zhaokaiqiang1992/article/details/45419023" target="_blank" rel="noopener">Androidå±å¹•é€‚é…å…¨æ”»ç•¥(æœ€æƒå¨çš„å®˜æ–¹é€‚é…æŒ‡å¯¼)</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Androidçš„å±å¹•é€‚é…ä¸€ç›´ä»¥æ¥éƒ½åœ¨æŠ˜ç£¨ç€æˆ‘ä»¬è¿™äº›å¼€å‘è€…ï¼Œæœ¬ç¯‡æ–‡ç« å°†ä»¥Googleçš„å®˜æ–¹æ–‡æ¡£ä¸ºåŸºç¡€ï¼Œå…¨é¢è€Œæ·±å…¥çš„è®²è§£Androidå±å¹•é€‚é…çš„åŸå› ã€é‡è¦æ¦‚å¿µã€è§£å†³æ–¹æ¡ˆåŠæœ€ä½³å®è·µã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="å±å¹•é€‚é…" scheme="http://yoursite.com/tags/%E5%B1%8F%E5%B9%95%E9%80%82%E9%85%8D/"/>
    
  </entry>
  
  <entry>
    <title>Androidè½¯é”®ç›˜</title>
    <link href="http://yoursite.com/2017/07/01/Android%E8%BD%AF%E9%94%AE%E7%9B%98/"/>
    <id>http://yoursite.com/2017/07/01/Androidè½¯é”®ç›˜/</id>
    <published>2017-07-01T08:45:15.000Z</published>
    <updated>2018-06-14T14:13:18.237Z</updated>
    
    <content type="html"><![CDATA[<p>è¯´èµ·Androidè½¯é”®ç›˜ï¼Œè¿™é‡Œé‡åˆ°çš„å‘å¤šæ•°å°±æ˜¯å¯¹å®ƒç†è§£ä¸å¤Ÿå…¨é¢å¯¼è‡´çš„ï¼Œæ‰€ä»¥å†³å®šå¥½å¥½æ€»ç»“ä¸€ä¸‹å®ƒã€‚åœ¨é¿å…è‡ªå·±äºŒæ¬¡æ‰å‘çš„åŒæ—¶ï¼Œå¦‚æœèƒ½å¸®åŠ©åˆ°åœ¨è¿™ä¸ªçŸ¥è¯†åŒºæ­£ç–‘æƒ‘çš„ä½ ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚<a id="more"></a>æœ¬ç¯‡çš„è®²è§£å°†åˆ†ä»¥ä¸‹å‡ ä¸ªä¸»é¢˜ï¼š<br>1ã€æ“ä½œè½¯é”®ç›˜<br>2ã€ç›‘å¬é”®ç›˜çš„å¼¹èµ·ä¸éšè—<br>3ã€å¦‚ä½•é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†</p><h1 id="æ“ä½œè½¯é”®ç›˜"><a href="#æ“ä½œè½¯é”®ç›˜" class="headerlink" title="æ“ä½œè½¯é”®ç›˜"></a>æ“ä½œè½¯é”®ç›˜</h1><p>æƒ³è¦æ“ä½œè½¯é”®ç›˜ï¼Œéœ€è¦ä½¿ç”¨åˆ° InputMethodManager ï¼Œå®ƒæ˜¯ä¸€ä¸ªç³»ç»ŸæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ Context.getSystemService() è·å–åˆ°å®ƒã€‚</p><h4 id="æ˜¾ç¤ºè½¯é”®ç›˜"><a href="#æ˜¾ç¤ºè½¯é”®ç›˜" class="headerlink" title="æ˜¾ç¤ºè½¯é”®ç›˜"></a>æ˜¾ç¤ºè½¯é”®ç›˜</h4><p>åœ¨ InputMethodManagerä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•showSoftInput()å’ŒshowSoftInputFromInputMethod()ï¼Œè€Œå®é™…ä¸Šï¼Œåªæœ‰showSoftInput()æ˜¯æœ‰æ•ˆçš„ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/1.jpeg"><br>è¿™é‡Œæˆ‘ä»¬åªéœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•°ã€‚å®ƒé¦–å…ˆéœ€è¦ä¸€ä¸ªView ï¼Œä½¿ç”¨è½¯é”®ç›˜å°±æ˜¯ä¸ºäº†è¾“å…¥ï¼Œè€Œè¾“å…¥å°±éœ€è¦æœ‰æ¥æ”¶è¾“å…¥å†…å®¹çš„View ï¼Œè¿™é‡Œæ¥æ”¶è¾“å…¥çš„View ï¼Œæœ€å¥½æ˜¯ä¸€ä¸ªEditTextï¼ˆä½†è¿™ä¸æ˜¯å¿…é¡»çš„ï¼‰ã€‚<br>è€Œç¬¬äºŒä¸ªå‚æ•°flagså°±æ˜¯ä¸ªæ ‡å¿—ä½ï¼Œä»ä¸Šé¢æˆªå›¾çš„æ–¹æ³•ç­¾åä¸Šçš„æ–‡æ¡£ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ¥æ”¶0æˆ–è€…SHOW_INPYT_IMPLICIT ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒæœ‰ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯SHOW_FORCEDã€‚ä¸€èˆ¬æ²¡æœ‰ç‰¹åˆ«éœ€è¦çš„è¯ï¼Œæˆ‘ä»¬ç›´æ¥ä¼ é€’0å°±å¥½äº†(å®é™…ä¸ŠSHOW_INPYT_IMPLICITã€SHOW_FORCEDå¹¶ä¸å½±å“æ˜¾ç¤ºï¼Œåªæ˜¯åœ¨éšè—çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›é™åˆ¶ã€‚è€Œä¸”æˆ‘ä»¬ä¸€èˆ¬çš„è¯ï¼Œä¸ç®¡æ˜¾ç¤ºæˆ–è€…éšè—éƒ½å°†flagè®¾ç½®ä¸º0ï¼Œç‰¹æ®Šæƒ…å†µé‡åˆ°å†åšåˆ†æ)ã€‚<br>ç°åœ¨ï¼Œç®€å•æ€»ç»“ä¸€ä¸‹è°ƒç”¨showSoftInput()ä¼šç”Ÿæ•ˆçš„å…³é”®ç‚¹ï¼š<br>1ã€ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæœ€å¥½æ˜¯EditTextæˆ–è€…å®ƒçš„å­ç±»ã€‚<br>è€ƒè™‘åˆ°è½¯é”®ç›˜å°±æ˜¯ä¸ºäº†è¾“å…¥ï¼ŒEditTextå°±æ˜¯ä¸€ä¸ªæ¥æ”¶è¾“å…¥çš„æ§ä»¶ã€‚è€Œè¿™ä¸æ˜¯ç»å¯¹çš„ï¼Œå¦‚æœä¸æ˜¯ä¸€ä¸ªEditText ï¼Œå°±å¿…é¡»è¦æ±‚è¿™ä¸ªViewæœ‰ä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯ï¼šandroid:focusable=â€trueâ€ å’Œandroid:focusableInTouchMode=â€trueâ€ã€‚<br>2ã€ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¿…é¡»æ˜¯å¯è·å–ç„¦ç‚¹çš„ï¼Œå¹¶ä¸”å½“å‰å·²ç»è·å–åˆ°ç„¦ç‚¹ã€‚<br>EditTexté»˜è®¤æ˜¯å…è®¸è·å–ç„¦ç‚¹çš„ï¼Œä½†æ˜¯å‡å¦‚å¸ƒå±€ä¸­ï¼Œå­˜åœ¨å¤šä¸ªå¯è·å–ç„¦ç‚¹çš„æ§ä»¶ï¼Œå°±éœ€è¦æå‰è®©æˆ‘ä»¬ä¼ é€’è¿›å»çš„Viewè·å–åˆ°ç„¦ç‚¹ã€‚è·å–ç„¦ç‚¹å¯ä»¥ä½¿ç”¨requestFocus()æ–¹æ³•ã€‚<br>3ã€å¸ƒå±€å¿…é¡»åŠ è½½å®Œæˆã€‚<br>åœ¨onCreate()ä¸­ï¼Œå¦‚æœç«‹å³è°ƒç”¨showSoftInput()æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚æƒ³è¦åœ¨é¡µé¢ä¸€å¯åŠ¨çš„æ—¶å€™å°±å¼¹å‡ºé”®ç›˜ï¼Œå¯ä»¥åœ¨Activityä¸Šï¼Œè®¾ç½® android:windowSoftInputModeå±æ€§æ¥å®Œæˆï¼Œæˆ–è€…åšä¸€ä¸ªå»¶è¿ŸåŠ è½½ï¼ŒView.postDelayed()ä¹Ÿæ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚<br>æ‰€ä»¥æœ€ç»ˆï¼Œå®Œæ•´çš„æ˜¾ç¤ºè½¯é”®ç›˜çš„ä»£ç å°±å¦‚ä¸‹æ‰€ç¤ºäº†ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/2.jpeg"></p><h4 id="éšè—è½¯é”®ç›˜"><a href="#éšè—è½¯é”®ç›˜" class="headerlink" title="éšè—è½¯é”®ç›˜"></a>éšè—è½¯é”®ç›˜</h4><p>è™½ç„¶showSoftInput()æ–¹æ³•æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯æƒ³è¦éšè—è½¯é”®ç›˜ï¼Œå°±æ²¡æœ‰æä¾›å¯¹åº”çš„hideSoftInput()æ–¹æ³•ï¼Œä½†æ˜¯å´æœ‰ä¸€ä¸ªhideSoftInputFromWindow()æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥éšè—è½¯é”®ç›˜ã€‚<br>å…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„ç­¾åï¼Œå®ƒåŒæ ·æœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥è°ƒç”¨ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/3.jpeg"><br>å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªIBinder ï¼Œå¯ä»¥ç›´æ¥ä¼ é€’ä¸€ä¸ª View.getWindowToken()çš„windowTokenå¯¹è±¡å°±å¯ä»¥äº†ã€‚è€Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯éšè—è½¯é”®ç›˜çš„æ ‡å¿—ä½ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯ï¼Œç›´æ¥ä¼ é€’0å°±å¥½äº†ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong>è¿™é‡Œè™½ç„¶åŸåˆ™ä¸Šéœ€è¦ä¼ é€’ä¸€ä¸ªä¹‹å‰å¼¹å‡ºé”®ç›˜ä¼ é€’çš„æ—¶å€™ï¼Œä¼ é€’çš„Viewçš„windowTokenï¼Œä½†æ˜¯å®é™…æƒ…å†µæ˜¯ä½ åªéœ€è¦ä¼ é€’ä¸€ä¸ªå­˜åœ¨äºå½“å‰å¸ƒå±€ViewTreeä¸­ï¼Œéšæ„ä¸€ä¸ªViewçš„windowTokenå°±å¯ä»¥äº†ã€‚</p></blockquote><p>æœ€ç»ˆéšè—è½¯ä»¶çš„ä»£ç å°±æ˜¯è¿™æ ·çš„ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/4.jpeg"></p><h4 id="åˆ‡æ¢é”®ç›˜çš„å¼¹å‡ºå’Œéšè—"><a href="#åˆ‡æ¢é”®ç›˜çš„å¼¹å‡ºå’Œéšè—" class="headerlink" title="åˆ‡æ¢é”®ç›˜çš„å¼¹å‡ºå’Œéšè—"></a>åˆ‡æ¢é”®ç›˜çš„å¼¹å‡ºå’Œéšè—</h4><p>åœ¨InputMethodManagerä¸­ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªtoggleSoftInput()æ–¹æ³•ï¼Œå¦‚åŒå®ƒçš„åå­—ä¸€æ ·ï¼Œå®ƒå¯ä»¥è®©è½¯é”®ç›˜åœ¨æ˜¾ç¤ºå’Œéšè—ä¹‹é—´åˆ‡æ¢ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/5.jpeg"><br>è¯¥æ–¹æ³•ï¼Œæ¥æ”¶ä¸¤ä¸ªflags ï¼Œåˆ†åˆ«æ˜¯æ§åˆ¶showå’Œhideæ—¶å€™çš„æ ‡è¯†ï¼Œå®ƒä»¬çš„å«ä¹‰å’Œå‰é¢ä»‹ç»çš„showSoftInput()å’ŒhideSoftInputFromWindow()ä¸€è‡´ï¼Œæ‰€ä»¥æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œç›´æ¥ä¼ é€’0å°±å¥½äº†ã€‚<br>toggleSoftInput()æ–¹æ³•ä¸è¦æ±‚ä¼ é€’ä¸€ä¸ªViewæˆ–è€…windowTokenï¼Œæ‰€ä»¥å®ƒå¹¶æ²¡æœ‰showSoftInput()ä¸­çš„ä¸€äº›é™åˆ¶ï¼Œä½†æ˜¯ä¾ç„¶è¿˜æœ‰éœ€è¦åœ¨å¸ƒå±€ç»˜åˆ¶å®Œæˆä¹‹åè°ƒç”¨æ‰ä¼šæœ‰æ•ˆæœã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/6.jpeg"><br>è™½ç„¶è¿™ä¸ªæ–¹æ³•ï¼Œé™åˆ¶å¾ˆå°‘ï¼Œä½†æ˜¯æˆ‘ä»¬åŸºæœ¬ä¸Šä¸ä¼šä½¿ç”¨å®ƒã€‚ä¸»è¦åŸå› åœ¨äºï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€å…³çš„æ–¹æ³•ï¼Œä¼šæ ¹æ®å½“å‰çš„çŠ¶æ€åšç›¸åçš„æ“ä½œã€‚è¿™å°±å¯¼è‡´å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­ï¼Œæ— æ³•ç›´æ¥æ ¹æ®InputMethodManageræä¾›çš„æ–¹æ³•åˆ¤æ–­å½“å‰è½¯é”®ç›˜çš„æ˜¾ç¤ºçŠ¶æ€ï¼Œè¿™æ ·ä¹Ÿå°±æ— æ³•ç¡®å®šè°ƒç”¨å®ƒçš„æ—¶å€™çš„æ•ˆæœäº†ã€‚</p><h1 id="ç›‘å¬é”®ç›˜çš„å¼¹èµ·ä¸éšè—"><a href="#ç›‘å¬é”®ç›˜çš„å¼¹èµ·ä¸éšè—" class="headerlink" title="ç›‘å¬é”®ç›˜çš„å¼¹èµ·ä¸éšè—"></a>ç›‘å¬é”®ç›˜çš„å¼¹èµ·ä¸éšè—</h1><p>å¦‚æœæƒ³è¦ç›‘å¬é”®ç›˜çš„å¼¹å‡ºå’Œæ”¶èµ·ï¼Œå¯ä»¥ä½¿ç”¨<code>ViewTreeObserver.OnGlobalLayoutListener</code>è¿™ä¸ªç›‘å¬ï¼Œæ¥ç›‘å¬å¸ƒå±€çš„è°ƒæ•´ï¼Œä»è€Œåˆ¤æ–­å‡ºé”®ç›˜çš„å¼¹å‡ºå’Œéšè—ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ViewTreeObserver.OnGlobalLayoutListeneråè·å–å±å¹•ä¸­å„ä¸ªç±»å‹é«˜åº¦çš„ä¾‹å­ï¼Œè¯·æ³¨æ„ä»£ç ä¸­çš„æ³¨é‡Šï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">getWindow().getDecorView().getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onGlobalLayout() &#123;</span><br><span class="line">Log.d(&quot;sss_main&quot;, &quot;root.getHeight(): &quot; + root.getHeight());//å½“å‰æ‰€å¼•ç”¨è§†å›¾çš„é«˜åº¦</span><br><span class="line">Log.d(&quot;sss_main&quot;, &quot;root.getRootView().getHeight(): &quot; + root.getRootView().getHeight());//å±å¹•é«˜åº¦</span><br><span class="line">Log.d(&quot;sss_main&quot;, &quot;getWindow().getDecorView(): &quot; + getWindow().getDecorView().getHeight());//å±å¹•é«˜åº¦</span><br><span class="line">Rect r = new Rect();</span><br><span class="line">getWindow().getDecorView().getWindowVisibleDisplayFrame(r);</span><br><span class="line">Log.d(&quot;sss_main&quot;, &quot;r.top: &quot; + r.top);//çŠ¶æ€æ é«˜åº¦</span><br><span class="line">Log.d(&quot;sss_main&quot;, &quot;r.bottom-r.top: &quot; + (r.bottom - r.top));//ç”¨æˆ·ç•Œé¢çš„å¯è§†é«˜åº¦ï¼ˆé™¤å»çŠ¶æ€æ å’Œåº•éƒ¨å¯¼èˆªï¼‰</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ä»£ç ä¸­<code>r.bottom - r.top</code>ä»£è¡¨äº†é™¤å»çŠ¶æ€æ ã€åº•éƒ¨å¯¼èˆªæ åï¼Œæ‰‹æœºå±å¹•å‰©ä½™å¯è§†é«˜åº¦ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå‰©ä½™å¯è§†é«˜åº¦ä¹Ÿä¸åŒ…æ‹¬è¾“å…¥æ³•å¼¹çª—çš„é«˜åº¦ï¼ˆå¦‚æœå±å¹•ä¸­æœ‰è¾“å…¥æ³•å¼¹çª—çš„è¯ï¼‰ã€‚æœ‰äº†ä»¥ä¸Šçš„åŸºç¡€ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>getWindow().getDecorView().getHeight()-r.bottom&gt;100?é”®ç›˜å¼¹å‡ºï¼šé”®ç›˜éšè—</code>æ¥åˆ¤æ–­é”®ç›˜æ˜¯å¦éšè—äº†ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong>ä¸ºä»€ä¹ˆè¦å¤§äº100å‘¢ï¼Ÿå› ä¸ºå¦‚æœæ‰‹æœºå…·å¤‡åº•éƒ¨å¯¼èˆªåŒºåŸŸçš„è¯ï¼Œè¦æ’é™¤è¿™ä¸ªå€¼çš„å¹²æ‰°ã€‚å½“ç„¶äº†ï¼Œç›´æ¥é»˜è®¤åº•éƒ¨å¯¼èˆªåŒºåŸŸé«˜åº¦ä¸º100è‚¯å®šæ˜¯ä¸ç²¾ç¡®çš„ï¼Œå®é™…åº”ç”¨ä¸­æˆ‘ä»¬åº”è¯¥è·å–åˆ°çœŸå®çš„åº•éƒ¨å¯¼èˆªåŒºåŸŸé«˜åº¦ï¼Œå…·ä½“å¦‚ä½•è·å–åº•éƒ¨å¯¼èˆªåŒºåŸŸé«˜åº¦å¯ä»¥<a href="http://blog.csdn.net/u012764110/article/details/49783465" target="_blank" rel="noopener">å‚è€ƒè¿™ç¯‡æ–‡ç« </a>ã€‚</p></blockquote><h1 id="å¦‚ä½•é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†"><a href="#å¦‚ä½•é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†" class="headerlink" title="å¦‚ä½•é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†"></a>å¦‚ä½•é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†</h1><p>åœ¨å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°é”®ç›˜æŒ¡ä½è¾“å…¥æ¡†çš„æƒ…å†µï¼Œæ¯”å¦‚ç™»å½•ç•Œé¢æˆ–æ³¨å†Œç•Œé¢ï¼Œå¼¹å‡ºçš„è½¯é”®ç›˜æŠŠç™»å½•æˆ–æ³¨å†ŒæŒ‰é’®æŒ¡ä½äº†ï¼Œç”¨æˆ·å¿…é¡»æŠŠè½¯é”®ç›˜æ”¶èµ·ï¼Œæ‰èƒ½ç‚¹å‡»ç›¸åº”æŒ‰é’®ï¼Œè¿™æ ·çš„ç”¨æˆ·ä½“éªŒéå¸¸ä¸å¥½ã€‚ä¸‹é¢å¯¹å‡ ç§åœ¨å¼€å‘ä¸­å¸¸ç”¨çš„é¿å…é”®ç›˜é®æŒ¡è¾“å…¥æ¡†çš„æ–¹æ³•è¿›è¡Œæ€»ç»“ã€‚</p><h4 id="æ–¹æ³•ä¸€ï¼šwindowSoftInputMode-adjustResizeå’ŒadjustPan"><a href="#æ–¹æ³•ä¸€ï¼šwindowSoftInputMode-adjustResizeå’ŒadjustPan" class="headerlink" title="æ–¹æ³•ä¸€ï¼šwindowSoftInputMode:adjustResizeå’ŒadjustPan"></a>æ–¹æ³•ä¸€ï¼šwindowSoftInputMode:adjustResizeå’ŒadjustPan</h4><p>ä¸»è¦å®ç°æ–¹æ³•ï¼šåœ¨ AndroidManifest.xml å¯¹åº”çš„Activityé‡Œæ·»åŠ  android:windowSoftInputMode=â€adjustPanâ€ æˆ–æ˜¯ android:windowSoftInputMode=â€adjustResizeâ€å±æ€§<br>è¿™ä¸¤ç§å±æ€§çš„åŒºåˆ«ï¼Œå®˜æ–¹çš„è§£é‡Šæ˜¯ï¼š<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/7.png"><br>è¿™ä¸¤ä¸ªå±æ€§ä½œç”¨éƒ½æ˜¯ä¸ºäº†è°ƒæ•´ç•Œé¢ä½¿é”®ç›˜ä¸æŒ¡ä½è¾“å…¥æ¡†,è¿™é‡Œå¯¹è¿™ä¸¤ç§å±æ€§ä½¿ç”¨åœºæ™¯ã€ä¼˜ç¼ºç‚¹ã€æ³¨æ„äº‹é¡¹è¿›è¡Œäº†å…¨æ–¹é¢æ€»ç»“ã€‚å¯¹äº<code>fitsystemwindows</code>è¿˜æ¯”è¾ƒæ‡µé€¼çš„ä½ ï¼Œå¯ä»¥å‚è€ƒ<a href="http://blog.csdn.net/u012885461/article/details/51068553" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/8.jpg"><br>æœ€åé™„ä¸€å¼ å®˜æ–¹çš„æˆªå›¾ã€‚<br><img src="/2017/07/01/Androidè½¯é”®ç›˜/9.jpg" title="è¯¥å±æ€§æ˜¯åœ¨APIçº§åˆ«3å¼•å…¥çš„ã€‚"></p><blockquote><p><strong>æ’æ’­çŸ¥è¯†ï¼š</strong><br>è¿™é‡Œå†æä¸€ä¸‹clipToPaddingå’ŒclipChildrenè¿™ä¸¤ä¸ªå±æ€§å§ï¼Œè™½ç„¶å’Œæœ¬ç¯‡æ²¡æœ‰å…³ç³»ä½†æ˜¯åŒæ ·æ˜¯æœ‰ä¸€å®šæ¦‚ç‡å‡ºç°çš„ï¼Œæ‰€ä»¥è¦è®²ä¸€ä¸‹ã€‚clipToPaddingå°±æ˜¯è¯´æ§ä»¶çš„ç»˜åˆ¶åŒºåŸŸæ˜¯å¦åœ¨paddingé‡Œé¢çš„ï¼Œtrueçš„æƒ…å†µä¸‹å¦‚æœä½ è®¾ç½®äº†paddingé‚£ä¹ˆç»˜åˆ¶çš„åŒºåŸŸå°±å¾€é‡Œç¼©ï¼ŒclipToPaddingä¸»è¦åº”ç”¨åœ¨listviewå¤´éƒ¨å’Œå°¾éƒ¨è®¾ç½®paddingåå¸Œæœ›å¯ä»¥åœ¨æ»‘åŠ¨itemæ—¶èƒ½æ»‘åŠ¨åˆ°paddingåŒºåŸŸã€‚clipChildrenè¡¨ç¤ºæ˜¯å¦é™åˆ¶å­Viewåœ¨æ‰€å±çˆ¶Viewçš„èŒƒå›´å†…ï¼Œæˆ‘ä»¬å°†å…¶å€¼è®¾ç½®ä¸ºfalseåé‚£ä¹ˆå½“å­æ§ä»¶çš„é«˜åº¦é«˜äºçˆ¶æ§ä»¶æ—¶ä¹Ÿä¼šå®Œå…¨æ˜¾ç¤º,è€Œä¸ä¼šè¢«å‹ç¼©ã€‚æ³¨æ„clipChildrenä¸€å®šæ˜¯åœ¨å¸ƒå±€æ–‡ä»¶çš„æ ¹èŠ‚ç‚¹è®¾ç½®ï¼Œå¦åˆ™ä¸èµ·ä½œç”¨,å…·ä½“çš„ä½¿ç”¨è¯·çœ‹<a href="http://blog.csdn.net/flymoon1201/article/details/44646473" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ä»¥åŠ<a href="https://www.zybuluo.com/TryLoveCatch/note/706916" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚<strong>æ³¨æ„ï¼š</strong>æœ‰æ—¶å€™clipChildrenä¼šä¸èµ·ä½œç”¨ï¼Œå¦‚æœç¡®å®šè€ƒè™‘åˆ°äº†ä¹‹å‰ä¸¤ç¯‡æ–‡ç« æ‰€æåŠçš„å†…å®¹ï¼Œåˆ™åº”è¯¥æƒ³å…¶å®ƒçš„åŠæ³•æ›¿ä»£clipChildrenï¼Œè¿™å¯ä»¥è®¤ä¸ºæ˜¯clipChildrençš„BUGã€‚</p></blockquote><h4 id="æ–¹æ³•äºŒï¼šå½“é”®ç›˜å¼¹èµ·æ—¶ï¼Œè®©ç•Œé¢æ•´ä½“ä¸Šç§»ï¼›é”®ç›˜æ”¶èµ·ï¼Œè®©ç•Œé¢æ•´ä½“ä¸‹ç§»"><a href="#æ–¹æ³•äºŒï¼šå½“é”®ç›˜å¼¹èµ·æ—¶ï¼Œè®©ç•Œé¢æ•´ä½“ä¸Šç§»ï¼›é”®ç›˜æ”¶èµ·ï¼Œè®©ç•Œé¢æ•´ä½“ä¸‹ç§»" class="headerlink" title="æ–¹æ³•äºŒï¼šå½“é”®ç›˜å¼¹èµ·æ—¶ï¼Œè®©ç•Œé¢æ•´ä½“ä¸Šç§»ï¼›é”®ç›˜æ”¶èµ·ï¼Œè®©ç•Œé¢æ•´ä½“ä¸‹ç§»"></a>æ–¹æ³•äºŒï¼šå½“é”®ç›˜å¼¹èµ·æ—¶ï¼Œè®©ç•Œé¢æ•´ä½“ä¸Šç§»ï¼›é”®ç›˜æ”¶èµ·ï¼Œè®©ç•Œé¢æ•´ä½“ä¸‹ç§»</h4><p>ä½¿ç”¨åœºæ™¯ï¼šé’ˆå¯¹ç•Œé¢å…¨å±æ¨¡å¼ï¼Œè¾“å…¥æ¡†ä¸ä¼šè¢«é”®ç›˜é®æŒ¡ã€‚ä¸»è¦ç”¨äºä¸€äº›ç™»å½•ç•Œé¢ï¼Œæˆ–æ˜¯éœ€è¦æŠŠç•Œé¢æ•´ä½“éƒ½é¡¶ä¸Šå»çš„åœºæ™¯ã€‚</p><h5 id="1ï½¤ä¸»è¦å®ç°æ­¥éª¤"><a href="#1ï½¤ä¸»è¦å®ç°æ­¥éª¤" class="headerlink" title="1ï½¤ä¸»è¦å®ç°æ­¥éª¤"></a>1ï½¤ä¸»è¦å®ç°æ­¥éª¤</h5><p>(1). è·å–Activityå¸ƒå±€xmlçš„æœ€å¤–å±‚æ§ä»¶ï¼Œå¦‚xmlæ–‡ä»¶å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;match_parent&quot;</span><br><span class="line">android:id=&quot;@+id/main&quot;</span><br><span class="line">tools:context=&quot;com.example.liubin1.softkeyboardhelper.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;EditText</span><br><span class="line">android:id=&quot;@+id/name&quot;</span><br><span class="line">android:hint=&quot;è¯·è¾“å…¥ç”¨æˆ·åï¼š&quot;</span><br><span class="line">android:layout_centerInParent=&quot;true&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;50dp&quot;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;EditText</span><br><span class="line">android:id=&quot;@+id/pas&quot;</span><br><span class="line">android:layout_below=&quot;@id/name&quot;</span><br><span class="line">android:hint=&quot;è¯·è¾“å…¥å¯†ç ï¼š&quot;</span><br><span class="line">android:layout_centerInParent=&quot;true&quot;</span><br><span class="line">android:layout_width=&quot;match_parent&quot;</span><br><span class="line">android:layout_height=&quot;50dp&quot;</span><br><span class="line">/&gt;</span><br><span class="line">&lt;Button</span><br><span class="line">android:id=&quot;@+id/login_btn&quot;</span><br><span class="line">android:layout_below=&quot;@id/rpas&quot;</span><br><span class="line">android:layout_centerHorizontal=&quot;true&quot;</span><br><span class="line">android:text=&quot;ç™»å½•&quot;</span><br><span class="line">android:layout_width=&quot;180dp&quot;</span><br><span class="line">android:layout_height=&quot;50dp&quot; /&gt;</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure></p><p>å…ˆè·å–åˆ°æœ€å¤–å±‚æ§ä»¶:<br>RelativeLayout main = (RelativeLayout) findViewById(R.id.main);<br>(2). è·å–åˆ°æœ€åä¸€ä¸ªæ§ä»¶ï¼Œå¦‚ä¸Šé¢çš„xmlæ–‡ä»¶ï¼Œæœ€åä¸€ä¸ªæ§ä»¶æ˜¯Button:<br>Button login_btn = (Button) findViewById(R.id.login_btn);<br>(3). ç»™æœ€å¤–å±‚æ§ä»¶å’Œæœ€åä¸€ä¸ªæ§ä»¶æ·»åŠ ç›‘å¬äº‹ä»¶:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">//åœ¨Activityçš„onCreateé‡Œæ·»åŠ å¦‚ä¸‹æ–¹æ³•</span><br><span class="line">addLayoutListener(main,login_btn);</span><br><span class="line">/**   </span><br><span class="line">* addLayoutListeneræ–¹æ³•å¦‚ä¸‹</span><br><span class="line">* @param main æ ¹å¸ƒå±€</span><br><span class="line">* @param scroll éœ€è¦æ˜¾ç¤ºçš„æœ€ä¸‹æ–¹View</span><br><span class="line">*/</span><br><span class="line">public void addLayoutListener(final View main, final View scroll) &#123;</span><br><span class="line">main.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void onGlobalLayout() &#123;</span><br><span class="line">Rect rect = new Rect();</span><br><span class="line">//1ã€è·å–mainåœ¨çª—ä½“çš„å¯è§†åŒºåŸŸ</span><br><span class="line">main.getWindowVisibleDisplayFrame(rect);</span><br><span class="line">//2ã€è·å–mainåœ¨çª—ä½“çš„ä¸å¯è§†åŒºåŸŸé«˜åº¦ï¼Œåœ¨é”®ç›˜æ²¡æœ‰å¼¹èµ·æ—¶ï¼Œmain.getRootView().getHeight()è°ƒèŠ‚åº¦åº”è¯¥å’Œrect.bottomé«˜åº¦ä¸€æ ·</span><br><span class="line">int mainInvisibleHeight = main.getRootView().getHeight() - rect.bottom;</span><br><span class="line">int screenHeight = main.getRootView().getHeight();//å±å¹•é«˜åº¦</span><br><span class="line">//3ã€ä¸å¯è§åŒºåŸŸå¤§äºå±å¹•æœ¬èº«é«˜åº¦çš„1/4ï¼šè¯´æ˜é”®ç›˜å¼¹èµ·äº†</span><br><span class="line">if (mainInvisibleHeight &gt; screenHeight / 4) &#123;</span><br><span class="line">int[] location = new int[2];</span><br><span class="line">scroll.getLocationInWindow(location);</span><br><span class="line">// 4ï½¤è·å–Scrollçš„çª—ä½“åæ ‡ï¼Œç®—å‡ºmainéœ€è¦æ»šåŠ¨çš„é«˜åº¦</span><br><span class="line">int srollHeight = (location[1] + scroll.getHeight()) - rect.bottom;</span><br><span class="line">//5ï½¤è®©ç•Œé¢æ•´ä½“ä¸Šç§»é”®ç›˜çš„é«˜åº¦</span><br><span class="line">main.scrollTo(0, srollHeight);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">//3ã€ä¸å¯è§åŒºåŸŸå°äºå±å¹•é«˜åº¦1/4æ—¶,è¯´æ˜é”®ç›˜éšè—äº†ï¼ŒæŠŠç•Œé¢ä¸‹ç§»ï¼Œç§»å›åˆ°åŸæœ‰é«˜åº¦</span><br><span class="line">main.scrollTo(0, 0);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="2ï½¤å®ç°åŸç†"><a href="#2ï½¤å®ç°åŸç†" class="headerlink" title="2ï½¤å®ç°åŸç†"></a>2ï½¤å®ç°åŸç†</h5><p>æ­¤æ–¹æ³•é€šè¿‡ç›‘å¬ Activity æœ€å¤–å±‚å¸ƒå±€æ§ä»¶æ¥æ£€æµ‹è½¯é”®ç›˜æ˜¯å¦å¼¹å‡ºï¼Œç„¶åå»æ‰‹åŠ¨è°ƒç”¨æ§ä»¶çš„scrollToæ–¹æ³•è¾¾åˆ°è°ƒæ•´å¸ƒå±€ç›®çš„ã€‚</p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br>1.<a href="https://segmentfault.com/a/1190000012279204" target="_blank" rel="noopener">Androidè½¯é”®ç›˜çš„æ˜¾ç¤ºä¸éšè—</a><br>2.<a href="https://blog.csdn.net/smileiam/article/details/69055963" target="_blank" rel="noopener">Androidå„ç§é”®ç›˜æŒ¡ä½è¾“å…¥æ¡†è§£å†³åŠæ³•</a><br>3.<a href="https://developer.android.com/guide/topics/manifest/activity-element.html?hl=zh-cn" target="_blank" rel="noopener">APIæŒ‡å—</a><br>4.<a href="https://stackoverflow.com/questions/2150078/how-to-check-visibility-of-software-keyboard-in-android" target="_blank" rel="noopener">stackoverflow:ç›‘å¬è½¯ä»¶çš„å¼¹å‡ºä¸éšè—</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¯´èµ·Androidè½¯é”®ç›˜ï¼Œè¿™é‡Œé‡åˆ°çš„å‘å¤šæ•°å°±æ˜¯å¯¹å®ƒç†è§£ä¸å¤Ÿå…¨é¢å¯¼è‡´çš„ï¼Œæ‰€ä»¥å†³å®šå¥½å¥½æ€»ç»“ä¸€ä¸‹å®ƒã€‚åœ¨é¿å…è‡ªå·±äºŒæ¬¡æ‰å‘çš„åŒæ—¶ï¼Œå¦‚æœèƒ½å¸®åŠ©åˆ°åœ¨è¿™ä¸ªçŸ¥è¯†åŒºæ­£ç–‘æƒ‘çš„ä½ ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="è½¯é”®ç›˜" scheme="http://yoursite.com/tags/%E8%BD%AF%E9%94%AE%E7%9B%98/"/>
    
  </entry>
  
  <entry>
    <title>Androidä¸­é€€å‡ºAPPçš„è§£å†³æ–¹æ¡ˆ</title>
    <link href="http://yoursite.com/2017/06/20/Android%E4%B8%AD%E9%80%80%E5%87%BAAPP%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>http://yoursite.com/2017/06/20/Androidä¸­é€€å‡ºAPPçš„è§£å†³æ–¹æ¡ˆ/</id>
    <published>2017-06-20T03:23:06.000Z</published>
    <updated>2018-03-06T03:28:59.662Z</updated>
    
    <content type="html"><![CDATA[<p>å¯¹äºå•ä¸€Activityçš„åº”ç”¨æ¥è¯´ï¼Œé€€å‡ºå¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨<code>finishï¼ˆï¼‰</code>æ–¹æ³•å³å¯ã€‚ä½†æ˜¯å¯¹äºå¤šä¸ªactivityçš„åº”ç”¨æ¥è¯´ï¼Œå½“æ‰“å¼€å¤šä¸ªactivityåï¼Œæƒ³å†æœ€åä¸€ä¸ªactivityä¸­ç›´æ¥é€€å‡ºappï¼Œè¿™å°±éœ€è¦æ¯ä¸ªactivityéƒ½å…³æ‰ï¼Œç„¶åé€€å‡ºã€‚ä¸‹é¢ä»‹ç»å››ç§å®‰å…¨é€€å‡ºå·²è°ƒç”¨å¤šä¸ªactivityçš„applicationçš„æ–¹æ³•ã€‚<a id="more"></a></p><h1 id="æŠ›å‡ºå¼‚å¸¸é€€å‡º"><a href="#æŠ›å‡ºå¼‚å¸¸é€€å‡º" class="headerlink" title="æŠ›å‡ºå¼‚å¸¸é€€å‡º"></a>æŠ›å‡ºå¼‚å¸¸é€€å‡º</h1><p>è¯¥æ–¹æ³•é€šè¿‡æŠ›å‡ºå¼‚å¸¸ï¼Œä½¿ç¨‹åºå¼ºåˆ¶å…³é—­ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä¼šè®©ç¨‹åºå¼¹å‡ºForce closeçš„å¼¹çª—ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå·®ã€‚</p><h1 id="è®°å½•æ‰“å¼€çš„activityå¹¶é€ä¸€å…³é—­"><a href="#è®°å½•æ‰“å¼€çš„activityå¹¶é€ä¸€å…³é—­" class="headerlink" title="è®°å½•æ‰“å¼€çš„activityå¹¶é€ä¸€å…³é—­"></a>è®°å½•æ‰“å¼€çš„activityå¹¶é€ä¸€å…³é—­</h1><p>è¿™ç§æ–¹æ³•çš„æ“ä½œéœ€è¦æŠ½å–åˆ°Activityçš„çˆ¶ç±»ä¸­è¿›è¡Œï¼Œåœ¨çˆ¶ç±»çš„<code>onCreate()</code>ä¸­å°†æ¯ä¸ªæ‰“å¼€çš„ActivityåŠ è½½åˆ°ä¸€ä¸ªactivityçš„é›†åˆä¸­ã€‚å½“é€€å‡ºæ—¶ï¼Œéœ€è¦åœ¨çˆ¶ç±»å®šä¹‰ä¸€ä¸ªkillAll()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•å¤åˆ¶ä¸€ä¸ªActivityçš„é›†åˆï¼Œç„¶åéå†å¤åˆ¶åçš„é›†åˆå…³é—­æ‰€æœ‰æ‰“å¼€çš„Activityã€‚</p><h1 id="å‘é€ç‰¹å®šå¹¿æ’­å®ç°å®‰å…¨é€€å‡ºï¼ˆæ¨èï¼‰"><a href="#å‘é€ç‰¹å®šå¹¿æ’­å®ç°å®‰å…¨é€€å‡ºï¼ˆæ¨èï¼‰" class="headerlink" title="å‘é€ç‰¹å®šå¹¿æ’­å®ç°å®‰å…¨é€€å‡ºï¼ˆæ¨èï¼‰"></a>å‘é€ç‰¹å®šå¹¿æ’­å®ç°å®‰å…¨é€€å‡ºï¼ˆæ¨èï¼‰</h1><p>åœ¨éœ€è¦ç»“æŸåº”ç”¨æ—¶ï¼Œå‘é€ä¸€ä¸ªç‰¹å®šå¹¿æ’­ï¼Œæ¯ä¸ªActivityæ”¶åˆ°å¹¿æ’­åï¼Œå…³é—­å³å¯ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ³¨å†Œå¹¿æ’­æ¥å—è€…çš„é€»è¾‘å¯ä»¥æŠ½å–åˆ°çˆ¶ç±»ä¸­å®ç°ï¼Œéœ€è¦å®‰å…¨é€€å‡ºæ—¶ï¼Œå‘é€çš„actionä¸ºæ³¨å†Œæ—¶æŒ‡å®šçš„actionå³å¯ï¼Œæ‰€æœ‰å¼€å¯çš„activityéƒ½æ³¨å†Œæœ‰èƒ½å¤Ÿå“åº”æ”¹actionçš„å¹¿æ’­æ¥å—è€…ï¼Œå¹¿æ’­æ¥å—è€…æ¥å—åˆ°æ­¤ç±»å¹¿æ’­åï¼Œå°†ç›´æ¥è°ƒç”¨<code>finishï¼ˆï¼‰</code>æ–¹æ³•ï¼Œå…³é—­å½“å‰Activityã€‚</p><h1 id="é€’å½’é€€å‡ºæ¯ä¸ªActivity"><a href="#é€’å½’é€€å‡ºæ¯ä¸ªActivity" class="headerlink" title="é€’å½’é€€å‡ºæ¯ä¸ªActivity"></a>é€’å½’é€€å‡ºæ¯ä¸ªActivity</h1><p>å½“éœ€è¦æ‰“å¼€æ–°çš„activityæ—¶ï¼Œä½¿ç”¨<code>startActivityForResult()</code>æ–¹æ³•æ‰“å¼€Activity,éœ€è¦é€€å‡ºæ•´ä¸ªåº”ç”¨æ—¶ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªæ ‡å¿—é€€å‡ºçš„Flagï¼Œåœ¨å„ä¸ªactivityçš„<code>onActivityResult</code>æ–¹æ³•ä¸­å¤„ç†è¯¥Flayï¼Œæ¥å®ç°é€’å½’å…³é—­ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯¹äºå•ä¸€Activityçš„åº”ç”¨æ¥è¯´ï¼Œé€€å‡ºå¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨&lt;code&gt;finishï¼ˆï¼‰&lt;/code&gt;æ–¹æ³•å³å¯ã€‚ä½†æ˜¯å¯¹äºå¤šä¸ªactivityçš„åº”ç”¨æ¥è¯´ï¼Œå½“æ‰“å¼€å¤šä¸ªactivityåï¼Œæƒ³å†æœ€åä¸€ä¸ªactivityä¸­ç›´æ¥é€€å‡ºappï¼Œè¿™å°±éœ€è¦æ¯ä¸ªactivityéƒ½å…³æ‰ï¼Œç„¶åé€€å‡ºã€‚ä¸‹é¢ä»‹ç»å››ç§å®‰å…¨é€€å‡ºå·²è°ƒç”¨å¤šä¸ªactivityçš„applicationçš„æ–¹æ³•ã€‚
    
    </summary>
    
      <category term="å››å¤§ç»„ä»¶" scheme="http://yoursite.com/categories/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6/"/>
    
    
      <category term="é€€å‡ºAPP" scheme="http://yoursite.com/tags/%E9%80%80%E5%87%BAAPP/"/>
    
      <category term="å¹¿æ’­" scheme="http://yoursite.com/tags/%E5%B9%BF%E6%92%AD/"/>
    
  </entry>
  
  <entry>
    <title>GlobalDialogæ¡†æ¶ä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://yoursite.com/2017/06/10/GlobalDialog%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2017/06/10/GlobalDialogæ¡†æ¶ä½¿ç”¨æ•™ç¨‹/</id>
    <published>2017-06-10T00:37:54.000Z</published>
    <updated>2018-05-12T13:06:36.063Z</updated>
    
    <content type="html"><![CDATA[<img src="/2017/06/10/GlobalDialogæ¡†æ¶ä½¿ç”¨æ•™ç¨‹/1.jpg" title="è¯·å‹¿æ¨¡ä»¿ã€‚"><p>GlobalDialogæ˜¯ç”±<a href="http://italkyou.bmob.site" target="_blank" rel="noopener">ITalkåº”ç”¨</a>å¼€æºçš„ä¸€æ¬¾å…¨å±€å¯¹è¯æ¡†åº“ã€‚ç›¸æ¯”äºAndroidåŸç”Ÿå¯¹è¯æ¡†çš„ç¹çé…ç½®ï¼ŒGlobalDialogçš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¿«é€Ÿå®ç°<strong>å…¨å±€å¯¹è¯æ¡†</strong>çš„åŠŸèƒ½ï¼ˆé€šçŸ¥è´¦å·ä¸‹çº¿ã€é€šçŸ¥è´¦å·å¼‚å¸¸ç­‰ï¼‰ã€‚è¿›ä¸€æ­¥äº†è§£ï¼Œè¯·è®¿é—®ç¬”è€…çš„<a href="https://github.com/tangxianming/global-dialog" target="_blank" rel="noopener">Github</a>ã€‚<br><a id="more"></a> </p><p>#é›†æˆæ–¹æ³•<br>åœ¨Moduleçš„build.gradleæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–å³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile &apos;com.txm.topcodes.globaldialog:globaldialog:0.1.6&apos;</span><br></pre></td></tr></table></figure></p><p>#è°ƒç”¨æ–¹å¼<br>å¸¸è§„æ–¹å¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">new GlobalDialog.Builder()</span><br><span class="line">.setContext(context) </span><br><span class="line">.setDescription(&quot;hello world&quot;) //å¼¹å‡ºæ¡†çš„æç¤ºä¿¡æ¯ã€‚</span><br><span class="line">.setStyle(GlobalDialog.Style.SingleAlert) //å¼¹çª—çš„æ ·å¼ã€‚æœ‰DoubleAlertã€SingleAlertä¸¤ç§ï¼Œé»˜è®¤ä¸ºåè€…ã€‚</span><br><span class="line">.setForce(ture) //è®¾ç½®å¼¹æ¡†é”€æ¯çš„ç­–ç•¥ã€‚é»˜è®¤ä¸ºtrueã€‚</span><br><span class="line">.setDialogClickListener(new OnDialogClickListener() &#123; //è®¾ç½®å›è°ƒï¼Œä¹Ÿå¯ä»¥ä¸è®¾ç½®ã€‚</span><br><span class="line">@Override</span><br><span class="line">public void onSure() &#123;</span><br><span class="line">super.onSure();</span><br><span class="line">&#125;</span><br><span class="line">&#125;).build().show();</span><br></pre></td></tr></table></figure></p><p>ç²¾ç®€æ–¹å¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">new GlobalDialog.Builder()</span><br><span class="line">.setContext(context) </span><br><span class="line">.setDescription(&quot;hello world&quot;) </span><br><span class="line">.build().show();</span><br></pre></td></tr></table></figure></p><p>#FAQ</p><hr><p><strong>æˆ‘å‘ç°GlobalDialogè¿˜å­˜åœ¨BUGï¼Ÿ</strong><br>GlobalDialogæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æ¡†æ¶ï¼Œå¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°é—®é¢˜ï¼Œæ¬¢è¿åœ¨ç¬”è€…çš„GitHubåˆ›å»ºä¸€ä¸ª<a href="https://github.com/tangxianming/global-dialog/issues" target="_blank" rel="noopener">Issue</a>ã€‚</p><p><strong>æˆ‘æ˜¯Eclipseç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨GlobalDialogä¹ˆï¼Ÿ</strong><br>ä¸å¯ä»¥ã€‚</p><p><strong>æˆ‘åœ¨Android studioä¸­é“¾æ¥GlobalDialogåº“å¤±è´¥äº†ï¼Ÿ</strong><br>ç¡®ä¿æ‚¨çš„å·¥ç¨‹ä½¿ç”¨çš„è¿œç¨‹ä»“åº“ä¸ºjcenterã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">repositories &#123;</span><br><span class="line">jcenter()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;img src=&quot;/2017/06/10/GlobalDialogæ¡†æ¶ä½¿ç”¨æ•™ç¨‹/1.jpg&quot; title=&quot;è¯·å‹¿æ¨¡ä»¿ã€‚&quot;&gt;
&lt;p&gt;GlobalDialogæ˜¯ç”±&lt;a href=&quot;http://italkyou.bmob.site&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ITalkåº”ç”¨&lt;/a&gt;å¼€æºçš„ä¸€æ¬¾å…¨å±€å¯¹è¯æ¡†åº“ã€‚ç›¸æ¯”äºAndroidåŸç”Ÿå¯¹è¯æ¡†çš„ç¹çé…ç½®ï¼ŒGlobalDialogçš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¿«é€Ÿå®ç°&lt;strong&gt;å…¨å±€å¯¹è¯æ¡†&lt;/strong&gt;çš„åŠŸèƒ½ï¼ˆé€šçŸ¥è´¦å·ä¸‹çº¿ã€é€šçŸ¥è´¦å·å¼‚å¸¸ç­‰ï¼‰ã€‚è¿›ä¸€æ­¥äº†è§£ï¼Œè¯·è®¿é—®ç¬”è€…çš„&lt;a href=&quot;https://github.com/tangxianming/global-dialog&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Github&lt;/a&gt;ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="æˆ‘çš„Androidæ¡†æ¶" scheme="http://yoursite.com/categories/%E6%88%91%E7%9A%84Android%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="æ¡†æ¶" scheme="http://yoursite.com/tags/%E6%A1%86%E6%9E%B6/"/>
    
      <category term="View" scheme="http://yoursite.com/tags/View/"/>
    
  </entry>
  
  <entry>
    <title>Androidå®ç°é˜´å½±æ•ˆæœçš„ä¸‰ç§æ–¹å¼</title>
    <link href="http://yoursite.com/2017/05/20/Android%E5%AE%9E%E7%8E%B0%E9%98%B4%E5%BD%B1%E6%95%88%E6%9E%9C%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <id>http://yoursite.com/2017/05/20/Androidå®ç°é˜´å½±æ•ˆæœçš„ä¸‰ç§æ–¹å¼/</id>
    <published>2017-05-20T09:27:38.000Z</published>
    <updated>2018-05-12T13:17:25.273Z</updated>
    
    <content type="html"><![CDATA[<p>å®ç°Androidé˜´å½±å…±æœ‰ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨.9å›¾ï¼ˆç•¥ï¼‰ã€è®¾ç½®è§†å›¾çš„é«˜åº¦ã€åœ¨layer-listèµ„æºæ–‡ä»¶ä¸­æ¨¡æ‹Ÿé˜´å½±æ•ˆæœï¼Œæœ¬ç¯‡æ–‡ç« å°†å¯¹åä¸¤ç§æ–¹å¼åšä»‹ç»ã€‚<a id="more"></a></p><h1 id="è§†å›¾é«˜åº¦ï¼ˆZå€¼ï¼‰å®ç°é˜´å½±"><a href="#è§†å›¾é«˜åº¦ï¼ˆZå€¼ï¼‰å®ç°é˜´å½±" class="headerlink" title="è§†å›¾é«˜åº¦ï¼ˆZå€¼ï¼‰å®ç°é˜´å½±"></a>è§†å›¾é«˜åº¦ï¼ˆZå€¼ï¼‰å®ç°é˜´å½±</h1><p>Material Designä¸ºUIå…ƒç´ å¼•å…¥äº†é«˜åº¦ï¼ˆZå€¼ï¼‰æ¦‚å¿µï¼Œæ‹¥æœ‰è¾ƒé«˜ Z å€¼çš„è§†å›¾å°†æŠ•å°„æ›´å¤§ä¸”æ›´æŸ”å’Œçš„é˜´å½±ï¼Œå¹¶å°†æŒ¡ä½æ‹¥æœ‰è¾ƒä½Zå€¼çš„è§†å›¾ï¼Œä¸è¿‡è§†å›¾çš„Zå€¼å¹¶ä¸å½±å“è§†å›¾çš„å¤§å°ã€‚é˜´å½±çš„æ•ˆæœæ˜¯ç”±è¢«æå‡è§†å›¾çš„çˆ¶é¡¹æ‰€æä¾›çš„ï¼Œå› æ­¤é˜´å½±è£å‰ªä¹Ÿæ˜¯å—çˆ¶è§†å›¾å½±å“çš„ï¼Œ<strong>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœçˆ¶è§†å›¾æ²¡æœ‰æä¾›é¢å¤–çš„ç©ºé—´ç»™è¢«æå‡è§†å›¾ï¼Œåˆ™é˜´å½±æ•ˆæœä¸ä¼šè¢«å±•ç°ã€‚</strong></p><h4 id="æŒ‡å®šè§†å›¾é«˜åº¦"><a href="#æŒ‡å®šè§†å›¾é«˜åº¦" class="headerlink" title="æŒ‡å®šè§†å›¾é«˜åº¦"></a>æŒ‡å®šè§†å›¾é«˜åº¦</h4><p>è§†å›¾çš„Zå€¼åŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼š</p><ul><li>é«˜åº¦ï¼šé™æ€ç»„ä»¶ã€‚</li><li>è½¬æ¢ï¼šç”¨äºåŠ¨ç”»çš„åŠ¨æ€ç»„ä»¶ã€‚</li></ul><p>Z = elevation + translationZ<br><img src="/2017/05/20/Androidå®ç°é˜´å½±æ•ˆæœçš„ä¸‰ç§æ–¹å¼/1.png" title="ä¸åŒè§†å›¾é«˜åº¦çš„é˜´å½±ã€‚"><br>å¦‚æœè¦åœ¨å¸ƒå±€å®šä¹‰ä¸­è®¾ç½®è§†å›¾çš„é«˜åº¦ï¼Œè¯·ä½¿ç”¨ <code>android:elevation</code> å±æ€§ã€‚å¦‚æœè¦åœ¨Activityçš„ä»£ç ä¸­è®¾ç½®è§†å›¾é«˜åº¦ï¼Œè¯·ä½¿ç”¨ <code>View.setElevation()</code> æ–¹æ³•ã€‚<br>å¦‚æœè¦è®¾ç½®è§†å›¾è½¬æ¢ï¼Œè¯·ä½¿ç”¨ <code>View.setTranslationZ()</code> æ–¹æ³•ï¼ŒåŒæ—¶ï¼Œè¯¥æ–¹æ³•å¯ä»¥é€šè¿‡<strong>å±æ€§åŠ¨ç”»</strong>ä¸ºè§†å›¾é«˜åº¦æ·»åŠ åŠ¨ç”»ã€‚</p><h4 id="è‡ªå®šä¹‰è§†å›¾é˜´å½±"><a href="#è‡ªå®šä¹‰è§†å›¾é˜´å½±" class="headerlink" title="è‡ªå®šä¹‰è§†å›¾é˜´å½±"></a>è‡ªå®šä¹‰è§†å›¾é˜´å½±</h4><p>è§†å›¾çš„èƒŒæ™¯å°†å†³å®šå…¶é˜´å½±çš„é»˜è®¤å½¢çŠ¶ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">android:id=&quot;@+id/myview&quot;</span><br><span class="line">...</span><br><span class="line">android:elevation=&quot;2dp&quot;</span><br><span class="line">android:background=&quot;@drawable/myrect&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>èƒŒæ™¯è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ‹¥æœ‰åœ†è§’çš„çŸ©å½¢ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- res/drawable/myrect.xml --&gt;</span><br><span class="line">&lt;shape xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:shape=&quot;rectangle&quot;&gt;</span><br><span class="line">&lt;solid android:color=&quot;#42000000&quot; /&gt;</span><br><span class="line">&lt;corners android:radius=&quot;5dp&quot; /&gt;</span><br><span class="line">&lt;/shape&gt;</span><br></pre></td></tr></table></figure></p><p>è§†å›¾å°†æŠ•å°„ä¸€ä¸ªå¸¦æœ‰åœ†è§’çš„é˜´å½±ï¼Œå› ä¸ºèƒŒæ™¯å°†å®šä¹‰è§†å›¾çš„è½®å»“ã€‚ å¦‚æœæä¾›ä¸€ä¸ªè‡ªå®šä¹‰è½®å»“ï¼Œåˆ™æ­¤è½®å»“å°†æ›¿æ¢è§†å›¾é˜´å½±çš„é»˜è®¤å½¢çŠ¶ã€‚</p><h1 id="layer-listæ¨¡æ‹Ÿé˜´å½±æ•ˆæœ"><a href="#layer-listæ¨¡æ‹Ÿé˜´å½±æ•ˆæœ" class="headerlink" title="layer-listæ¨¡æ‹Ÿé˜´å½±æ•ˆæœ"></a>layer-listæ¨¡æ‹Ÿé˜´å½±æ•ˆæœ</h1><p>ä½¿ç”¨layer-listå¯ä»¥å°†å¤šä¸ªdrawableæŒ‰ç…§é¡ºåºå±‚å åœ¨ä¸€èµ·æ˜¾ç¤ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„itemä¸­çš„drawableéƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ‰€ä¾é™„viewçš„å¤§å°è€Œè¿›è¡Œç¼©æ”¾ï¼Œlayer-listä¸­çš„itemæ˜¯æŒ‰ç…§é¡ºåºä»ä¸‹å¾€ä¸Šå åŠ çš„ï¼Œå³å…ˆå®šä¹‰çš„itemåœ¨ä¸‹é¢ï¼Œåé¢çš„ä¾æ¬¡å¾€ä¸Šé¢å æ”¾ã€‚ä»¥ä¸‹æ˜¯å¸¦é˜´å½±çš„åœ†è§’çŸ©å½¢ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</span><br><span class="line">&lt;item</span><br><span class="line">android:left=&quot;2dp&quot;</span><br><span class="line">android:top=&quot;2dp&quot;&gt;</span><br><span class="line">&lt;shape&gt;</span><br><span class="line">&lt;corners android:radius=&quot;20dp&quot; /&gt;</span><br><span class="line">&lt;solid android:color=&quot;#acacac&quot; /&gt;</span><br><span class="line">&lt;/shape&gt;</span><br><span class="line">&lt;/item&gt;</span><br><span class="line">&lt;item</span><br><span class="line">android:right=&quot;2dp&quot;</span><br><span class="line">android:bottom=&quot;2dp&quot;&gt;</span><br><span class="line">&lt;shape&gt;</span><br><span class="line">&lt;corners android:radius=&quot;20dp&quot; /&gt;</span><br><span class="line">&lt;solid android:color=&quot;#FFFFFF&quot; /&gt;</span><br><span class="line">&lt;/shape&gt;</span><br><span class="line">&lt;/item&gt;</span><br><span class="line">&lt;/layer-list&gt;</span><br></pre></td></tr></table></figure></p><p>layer-listå¯ä»¥æ·»åŠ å¤šä¸ªitemå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªitemå­èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªdrawableèµ„æºï¼ŒæŒ‰ç…§itemä»ä¸Šåˆ°ä¸‹çš„é¡ºåºå åŠ åœ¨ä¸€èµ·ï¼Œå†é€šè¿‡è®¾ç½®æ¯ä¸ªitemçš„åç§»é‡å°±å¯ä»¥çœ‹åˆ°é˜´å½±ç­‰æ•ˆæœäº†ã€‚layer-listçš„itemå¯ä»¥é€šè¿‡ä¸‹é¢å››ä¸ªå±æ€§è®¾ç½®åç§»é‡ï¼š<br>android:top é¡¶éƒ¨çš„åç§»é‡<br>android:bottom åº•éƒ¨çš„åç§»é‡<br>android:left å·¦è¾¹çš„åç§»é‡<br>android:right å³è¾¹çš„åç§»é‡<br>è¿™å››ä¸ªåç§»é‡å’Œæ§ä»¶çš„marginè®¾ç½®å·®ä¸å¤šï¼Œéƒ½æ˜¯å¤–é—´è·çš„æ•ˆæœã€‚</p><h1 id="ä¸¤ç§æ–¹å¼å¯¹æ¯”"><a href="#ä¸¤ç§æ–¹å¼å¯¹æ¯”" class="headerlink" title="ä¸¤ç§æ–¹å¼å¯¹æ¯”"></a>ä¸¤ç§æ–¹å¼å¯¹æ¯”</h1><table><thead><tr><th>è§†å›¾é«˜åº¦</th><th>layer-listèµ„æº</th></tr></thead><tbody><tr><td>åªå…¼å®¹Android 5.0ä»¥ä¸Šç‰ˆæœ¬</td><td>éƒ½å…¼å®¹</td></tr><tr><td>æ•ˆæœé€¼çœŸ</td><td>æ•ˆæœä¸çœŸå®</td></tr><tr><td>éœ€è¦é¢å¤–çš„ç©ºé—´å±•ç¤ºé˜´å½±</td><td>ä¸éœ€è¦é¢å¤–çš„ç©ºé—´</td></tr></tbody></table><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br>1.<a href="https://developer.android.com/training/material/shadows-clipping.html?hl=zh-cn" target="_blank" rel="noopener">å®šä¹‰é˜´å½±</a><br>2.<a href="http://blog.csdn.net/u014695188/article/details/52815444" target="_blank" rel="noopener">Androidä¸­layer-listä½¿ç”¨è¯¦è§£</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å®ç°Androidé˜´å½±å…±æœ‰ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨.9å›¾ï¼ˆç•¥ï¼‰ã€è®¾ç½®è§†å›¾çš„é«˜åº¦ã€åœ¨layer-listèµ„æºæ–‡ä»¶ä¸­æ¨¡æ‹Ÿé˜´å½±æ•ˆæœï¼Œæœ¬ç¯‡æ–‡ç« å°†å¯¹åä¸¤ç§æ–¹å¼åšä»‹ç»ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="layer-list" scheme="http://yoursite.com/tags/layer-list/"/>
    
      <category term="elevation" scheme="http://yoursite.com/tags/elevation/"/>
    
  </entry>
  
  <entry>
    <title>SurfaceViewä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://yoursite.com/2017/04/26/SurfaceView%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2017/04/26/SurfaceViewä½¿ç”¨æ•™ç¨‹/</id>
    <published>2017-04-26T14:53:28.000Z</published>
    <updated>2018-01-27T03:02:40.642Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>SurfaceViewæ˜¯è§†å›¾(View)çš„ç»§æ‰¿ç±»ï¼Œè¿™ä¸ªè§†å›¾é‡Œå†…åµŒäº†ä¸€ä¸ªä¸“é—¨ç”¨äºç»˜åˆ¶çš„Surfaceã€‚ä½ å¯ä»¥æ§åˆ¶è¿™ä¸ªSurfaceçš„æ ¼å¼å’Œå°ºå¯¸ã€‚Surfaceviewæ§åˆ¶è¿™ä¸ªSurfaceçš„ç»˜åˆ¶ä½ç½®ã€‚<a id="more"></a><br>Surfaceæ˜¯çºµæ·±æ’åº(Z-ordered)çš„ï¼Œè¿™è¡¨æ˜å®ƒæ€»åœ¨è‡ªå·±æ‰€åœ¨çª—å£çš„åé¢ã€‚Surfaceviewæä¾›äº†ä¸€ä¸ªå¯è§åŒºåŸŸï¼Œåªæœ‰åœ¨è¿™ä¸ªå¯è§åŒºåŸŸå†…Surfaceéƒ¨åˆ†å†…å®¹æ‰å¯è§ï¼Œå¯è§åŒºåŸŸå¤–çš„éƒ¨åˆ†ä¸å¯è§ã€‚<br>Surfaceçš„æ’ç‰ˆæ˜¾ç¤ºå—åˆ°è§†å›¾å±‚çº§å…³ç³»çš„å½±å“ï¼Œå®ƒçš„å…„å¼Ÿè§†å›¾ç»“ç‚¹ä¼šåœ¨é¡¶ç«¯æ˜¾ç¤ºã€‚è¿™æ„å‘³è€… surface çš„å†…å®¹ä¼šè¢«å®ƒçš„å…„å¼Ÿè§†å›¾é®æŒ¡ï¼Œè¿™ä¸€ç‰¹æ€§å¯ä»¥ç”¨æ¥æ”¾ç½®é®ç›–ç‰©(overlays)(ä¾‹å¦‚ï¼Œæ–‡æœ¬å’ŒæŒ‰é’®ç­‰æ§ä»¶)ã€‚å¦‚æœ surface ä¸Šé¢æœ‰é€æ˜æ§ä»¶ï¼Œé‚£ä¹ˆå®ƒçš„æ¯æ¬¡å˜åŒ–éƒ½ä¼šå¼•èµ·æ¡†æ¶é‡æ–°è®¡ç®—å®ƒå’Œé¡¶å±‚æ§ä»¶ä¹‹é—´çš„é€æ˜æ•ˆæœï¼Œè¿™ä¼šå½±å“æ€§èƒ½ã€‚<br>ä½ å¯ä»¥é€šè¿‡getHolder()è¿”å›çš„SurfaceHolderå®ä¾‹è®¿é—®Surfaceã€‚Surfaceviewå˜å¾—å¯è§æ—¶ï¼ŒSurfaceè¢«åˆ›å»ºï¼›Surfaceviewéšè—å‰ï¼ŒSurfaceè¢«é”€æ¯ï¼Œè¿™æ ·èƒ½èŠ‚çœèµ„æºã€‚å¦‚æœä½ è¦æŸ¥çœ‹Surfaceè¢«åˆ›å»ºå’Œé”€æ¯çš„æ—¶æœºï¼Œå¯ä»¥é‡è½½surfaceCreated(SurfaceHolder)å’Œ surfaceDestroyed(SurfaceHolder)ã€‚<br>è¿™é‡Œåº”æ³¨æ„ï¼š </p><ol><li>æ‰€æœ‰SurfaceViewå’ŒSurfaceHolder.Callbackçš„æ–¹æ³•éƒ½ä¼šåœ¨UIçº¿ç¨‹é‡Œè°ƒç”¨ï¼Œä¸€èˆ¬æ¥è¯´å°±æ˜¯åº”ç”¨ç¨‹åºä¸»çº¿ç¨‹ã€‚æ‰€ä»¥æ¸²æŸ“çº¿ç¨‹æ‰€è¦è®¿é—®çš„å„ç§å˜é‡åº”è¯¥ä½œåŒæ­¥å¤„ç†ã€‚ </li><li>ç”±äºSurfaceå¯èƒ½è¢«é”€æ¯ï¼Œå®ƒåªåœ¨SurfaceHolder.Callback.surfaceCreated()å’ŒSurfaceHolder.Callback.surfaceDestroyed()ä¹‹é—´æœ‰æ•ˆï¼Œæ‰€ä»¥è¦ç¡®ä¿æ¸²æŸ“çº¿ç¨‹è®¿é—®çš„æ˜¯åˆæ³•æœ‰æ•ˆçš„Surfaceã€‚</li></ol><blockquote><p><strong>SurfaceViewæœ€ç»ˆä¼šå’ŒUIçº¿ç¨‹æ‰“äº¤é“ï¼š</strong><br>SurfaceViewå¸¦æœ‰ç‹¬ç«‹çš„Surfaceï¼ˆç‹¬ç«‹ä¸Windowçš„Surfaceï¼‰ï¼Œè¿™å¯ä»¥è®©å­çº¿ç¨‹åœ¨ç‹¬ç«‹çš„Surfaceä¸Šé¢ç»˜åˆ¶ä¸œè¥¿ï¼Œè¿›è¡ŒSurfaceViewçš„ç•Œé¢ç»˜åˆ¶ï¼Œè¿™ä¸ªå­çº¿ç¨‹å°±å«åšæ¸²æŸ“çº¿ç¨‹ï¼Œä½†æ˜¯è¦è®©ç‹¬ç«‹çš„Surfaceä¸Šé¢çš„ä¸œè¥¿åœ¨Viewä¸Šé¢å±•ç¤ºå‡ºæ¥ï¼Œéœ€è¦postä¸€ä¸ªæ¶ˆæ¯ç»™ä¸»çº¿ç¨‹ï¼Œç›®çš„æ˜¯æŠŠè¯¥Surfaceä¸­canvas ä¸Šçš„ä¸œè¥¿ç»˜åˆ¶åˆ°Viewçš„çœŸæ­£çš„ç”»å¸ƒä¸Šé¢ï¼ˆwindowçš„Surfaceçš„canvasä¸Šï¼‰ã€‚</p></blockquote><h1 id="SurfaceViewå’ŒViewçš„ä¸åŒä¹‹å¤„"><a href="#SurfaceViewå’ŒViewçš„ä¸åŒä¹‹å¤„" class="headerlink" title="SurfaceViewå’ŒViewçš„ä¸åŒä¹‹å¤„"></a>SurfaceViewå’ŒViewçš„ä¸åŒä¹‹å¤„</h1><table><thead><tr><th>View</th><th>SurfaceView</th></tr></thead><tbody><tr><td>é€‚ç”¨äºä¸»åŠ¨æ›´æ–°</td><td>é€‚ç”¨äºè¢«åŠ¨åˆ·æ–°</td></tr><tr><td>åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œç”»é¢æ›´æ–°</td><td>é€šå¸¸é€šè¿‡ä¸€ä¸ªå­çº¿ç¨‹æ¥è¿›è¡Œç”»é¢æ›´æ–°</td></tr><tr><td>ç»˜å›¾ä¸­æ²¡æœ‰ä½¿ç”¨åŒç¼“å†²æœºåˆ¶</td><td>åœ¨åº•å±‚å®ç°ä¸­å°±å®ç°äº†åŒç¼“å†²æœºåˆ¶</td></tr></tbody></table><p>æ¯”è¾ƒäº†ä¸Šé¢çš„ä¸åŒä¹‹å¤„ï¼Œæ˜¾ç„¶å¯ä»¥å‘ç°ï¼Œå¦‚æœä¸€ä¸ªViewéœ€è¦é¢‘ç¹çš„åˆ·æ–°ï¼Œæˆ–è€…åœ¨åˆ·æ–°æ—¶æ•°æ®å¤„ç†é‡å¤§ï¼ˆå¯èƒ½å¼•èµ·å¡é¡¿ï¼‰ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨SurfaceViewæ¥æ›¿ä»£Viewã€‚</p><h4 id="SurfaceViewçš„åŒç¼“å†²æœºåˆ¶"><a href="#SurfaceViewçš„åŒç¼“å†²æœºåˆ¶" class="headerlink" title="SurfaceViewçš„åŒç¼“å†²æœºåˆ¶"></a>SurfaceViewçš„åŒç¼“å†²æœºåˆ¶</h4><p>å¯¹äºæ¯ä¸€ä¸ªSurfaceViewå¯¹è±¡è€Œè¨€ï¼Œæœ‰ä¸¤ä¸ªç‹¬ç«‹çš„graphic bufferã€‚åœ¨Android SurfaceViewçš„åŒç¼“å†²æœºåˆ¶ä¸­æ˜¯è¿™æ ·å®ç°çš„ï¼š<br>åœ¨Buffer Aä¸­ç»˜åˆ¶å†…å®¹ï¼Œç„¶åè®©å±å¹•æ˜¾ç¤ºBuffer Aï¼›åœ¨ä¸‹ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œåœ¨Buffer Bä¸­ç»˜åˆ¶å†…å®¹ï¼Œç„¶åè®©å±å¹•æ˜¾ç¤ºBuffer Bï¼Œå¦‚æ­¤å¾€å¤ã€‚è€Œç”±äºè¿™ä¸ªåŒç¼“å†²æœºåˆ¶çš„å­˜åœ¨ï¼Œå¯èƒ½ä¼šå¼•èµ·é—ªå±ç°è±¡ã€‚åœ¨ç¬¬ä¸€ä¸ªâ€lockCanvas-drawCanvas-unlockCanvasAndPost â€œå¾ªç¯ä¸­ï¼Œæ›´æ–°çš„æ˜¯buffer Açš„å†…å®¹ï¼›åˆ°ä¸‹ä¸€ä¸ªâ€lockCanvas-drawCanvas-unlockCanvasAndPostâ€å¾ªç¯ä¸­ï¼Œæ›´æ–°çš„æ˜¯buffer Bçš„å†…å®¹ã€‚ å¦‚æœbuffer Aä¸buffer Bä¸­æŸä¸ªbufferå†…å®¹ä¸ºç©ºï¼Œå½“å±å¹•è½®æµæ˜¾ç¤ºå®ƒä»¬æ—¶ï¼Œå°±ä¼šå‡ºç°ç”»é¢é»‘å±é—ªçƒç°è±¡ã€‚<br><strong>è§£å†³æ–¹æ³•:</strong><br>å½“å‡†å¤‡æ›´æ–°å†…å®¹æ—¶ï¼Œå…ˆåˆ¤æ–­å†…å®¹æ˜¯å¦ä¸ºç©ºï¼Œåªæœ‰éç©ºæ—¶æ‰å¯åŠ¨â€lockCanvas-drawCanvas-unlockCanvasAndPostâ€è¿™ä¸ªæµç¨‹ã€‚</p><h1 id="SurfaceViewä½¿ç”¨æ­¥éª¤"><a href="#SurfaceViewä½¿ç”¨æ­¥éª¤" class="headerlink" title="SurfaceViewä½¿ç”¨æ­¥éª¤"></a>SurfaceViewä½¿ç”¨æ­¥éª¤</h1><ol><li>è·å–åˆ°SurfaceViewå¯¹åº”çš„SurfaceHolderï¼Œé€šè¿‡addCallback()æ–¹æ³•è®¾ç½®SurfaceHolder.Callbackç”¨äºç›‘å¬Surfaceçš„åˆ›å»ºå’Œé”€æ¯ã€‚</li><li>åˆ›å»ºæ¸²æŸ“çº¿ç¨‹å¯¹è±¡ã€‚</li><li>åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨SurfaceHolderçš„lockCanvasè·å–Surfaceä¸Šé¢æŒ‡å®šåŒºåŸŸçš„Canvasã€‚</li><li>åœ¨è¯¥Canvasä¸Šç»˜åˆ¶å›¾å½¢ã€‚ç»˜åˆ¶ç»“æŸåï¼Œä½¿ç”¨SurfaceHolderçš„unlockCanvasAndPostï¼ˆï¼‰æ–¹æ³•è§£é”Canvasï¼Œå¹¶ä¸”è®©UIçº¿ç¨‹æŠŠSurfaceä¸Šé¢çš„ä¸œè¥¿ç»˜åˆ¶åˆ°Viewçš„Canvasä¸Šé¢ã€‚</li></ol><h4 id="ä½¿ç”¨SurfaceHolderçš„ä¾‹å­"><a href="#ä½¿ç”¨SurfaceHolderçš„ä¾‹å­" class="headerlink" title="ä½¿ç”¨SurfaceHolderçš„ä¾‹å­"></a>ä½¿ç”¨SurfaceHolderçš„ä¾‹å­</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">public class GameUI extends SurfaceView implements SurfaceHolder.Callback &#123;</span><br><span class="line">private SurfaceHolder holder;</span><br><span class="line">private RenderThread renderThread;</span><br><span class="line">private boolean isDraw = false;</span><br><span class="line"></span><br><span class="line">public GameUI(Context context) &#123;</span><br><span class="line">super(context);</span><br><span class="line">holder = getHolder();</span><br><span class="line">holder.addCallback(this);</span><br><span class="line">renderThread = new RenderThread();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public GameUI(Context context, AttributeSet attrs) &#123;</span><br><span class="line">super(context, attrs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public GameUI(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">super(context, attrs, defStyleAttr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void surfaceCreated(SurfaceHolder holder) &#123;</span><br><span class="line">isDraw = true;</span><br><span class="line">if (!renderThread.isAlive()) &#123;</span><br><span class="line">renderThread.start();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void surfaceDestroyed(SurfaceHolder holder) &#123;</span><br><span class="line">isDraw = false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private class RenderThread extends Thread &#123;</span><br><span class="line">@Override</span><br><span class="line">public void run() &#123;</span><br><span class="line">super.run();</span><br><span class="line">while (isDraw) &#123;</span><br><span class="line">drawUI();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void drawUI() &#123;</span><br><span class="line">try &#123;</span><br><span class="line">Canvas canvas = holder.lockCanvas();</span><br><span class="line">drawCanvas(canvas);</span><br><span class="line">&#125; catch (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">//ç”±äºåŒç¼“å†²æœºåˆ¶çš„å­˜åœ¨ï¼Œåˆ¤æ–­ç”»å¸ƒæ˜¯å¦ä¸ºç©ºï¼Œä»è€Œé¿å…é»‘å±æƒ…å†µã€‚</span><br><span class="line">if(canvas!=null)&#123;</span><br><span class="line">holder.unlockCanvasAndPost(canvas);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void drawCanvas(Canvas canvas) &#123;</span><br><span class="line">// åœ¨ canvas ä¸Šç»˜åˆ¶éœ€è¦çš„å›¾å½¢</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br>1.<a href="https://developer.android.com/reference/android/view/SurfaceView.html" target="_blank" rel="noopener">SurfaceView</a><br>2.<a href="https://www.cnblogs.com/zhangyingai/p/7087371.html" target="_blank" rel="noopener">SurfaceViewçš„åŸºæœ¬ä½¿ç”¨</a><br>3.<a href="http://blog.csdn.net/zhaoyw2008/article/details/45825069" target="_blank" rel="noopener">SurfaceViewåŸºç¡€ç”¨æ³•</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h1&gt;&lt;p&gt;SurfaceViewæ˜¯è§†å›¾(View)çš„ç»§æ‰¿ç±»ï¼Œè¿™ä¸ªè§†å›¾é‡Œå†…åµŒäº†ä¸€ä¸ªä¸“é—¨ç”¨äºç»˜åˆ¶çš„Surfaceã€‚ä½ å¯ä»¥æ§åˆ¶è¿™ä¸ªSurfaceçš„æ ¼å¼å’Œå°ºå¯¸ã€‚Surfaceviewæ§åˆ¶è¿™ä¸ªSurfaceçš„ç»˜åˆ¶ä½ç½®ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="SurfaceView" scheme="http://yoursite.com/tags/SurfaceView/"/>
    
  </entry>
  
  <entry>
    <title>WebViewä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://yoursite.com/2017/03/10/WebView%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>http://yoursite.com/2017/03/10/WebViewä½¿ç”¨æ•™ç¨‹/</id>
    <published>2017-03-10T13:03:15.000Z</published>
    <updated>2018-01-27T03:07:22.213Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœä½ æƒ³åœ¨å°†webé¡µé¢ä½œä¸ºAPPçš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨WebViewã€‚WebViewåœ¨Androidä¸­ç»§æ‰¿äº†viewç±»ï¼Œä½œä¸ºæ‰¿è½½ç½‘é¡µçš„æ§ä»¶ã€‚ä½†æ˜¯æˆ‘ä»¬åº”è¯¥çŸ¥é“å®ƒå¹¶æ²¡æœ‰ç»§æ‰¿webæµè§ˆå™¨çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå®ƒæ‰€å®ç°çš„ä¹Ÿåªæ˜¯å±•ç¤ºç½‘é¡µï¼Œä»¥åŠä¸€äº›åŸºæœ¬çš„äº¤äº’å’Œç›‘å¬åŠŸèƒ½ã€‚<a id="more"></a><br>WebViewç»å¸¸è¢«ä½¿ç”¨çš„åœºæ™¯æ˜¯ï¼Œå½“ä½ çš„APPéœ€è¦å‘ç”¨æˆ·å±•ç¤ºä¸€ä¸ªéšæ—¶å¯æ›´æ–°çš„å†…å®¹ï¼Œæ¯”å¦‚ç”¨æˆ·æ¡æ¬¾ã€ä½¿ç”¨å‘å¯¼ã€‚é‚£ä¹ˆè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªActivityä¸­åŒ…å«ä¸€ä¸ªWebViewæ§ä»¶ç”¨æ¥å±•ç¤ºæœåŠ¡å™¨ç»´æŠ¤çš„å†…å®¹ï¼Œè¿™äº›å†…å®¹å¯ä»¥åœ¨æœåŠ¡å™¨éšæ—¶æ›´æ”¹ã€‚<br>WeblViewå¦ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªé¡µé¢ä¸­è¯·æ±‚æ‰€æœ‰ç”¨æˆ·çš„æ•°æ®ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯å†™ä¸€ä¸ªlayoutï¼Œç„¶ååˆ©ç”¨ç½‘ç»œè¯·æ±‚æ‰€æœ‰æ‰€éœ€æ•°æ®ï¼Œæœ€åå°†è¿™äº›æ•°æ®å¡«å……åˆ°layoutä¸­ã€‚ä½†æœ€ç®€æ´çš„æ–¹å¼æ˜¯ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥ç›´æ¥åŠ è½½ä¸€ä¸ªç½‘é¡µï¼Œè¿™ä¸ªç½‘é¡µåŒ…å«äº†éœ€è¦çš„æ•°æ®ã€‚<br>è¿™ä¸ªæ•™ç¨‹å°†å¸®åŠ©ä½ å­¦ä¼šä½¿ç”¨WebViewï¼Œä»¥åŠå…³äºå®ƒé«˜çº§ä¸€ç‚¹çš„ç”¨æ³•ï¼Œæ¯”å¦‚é¡µé¢è·³è½¬ã€jsäº¤äº’ç­‰ã€‚</p><h1 id="æ·»åŠ WebViewåˆ°ä½ çš„åº”ç”¨"><a href="#æ·»åŠ WebViewåˆ°ä½ çš„åº”ç”¨" class="headerlink" title="æ·»åŠ WebViewåˆ°ä½ çš„åº”ç”¨"></a>æ·»åŠ WebViewåˆ°ä½ çš„åº”ç”¨</h1><p>æ·»åŠ WebViewåˆ°ä½ çš„åº”ç”¨æœ€ç®€å•çš„æ–¹å¼æ˜¯åœ¨Layoutä¸­æ·»åŠ &lt; WebView &gt;æ ‡ç­¾ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­è¡¨ç¤ºä¸€ä¸ªå…¨å±çš„WebViewã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;WebView  xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">android:id=&quot;@+id/webview&quot;</span><br><span class="line">android:layout_width=&quot;fill_parent&quot;</span><br><span class="line">android:layout_height=&quot;fill_parent&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></p><p>åŠ è½½ç½‘é¡µï¼Œè°ƒç”¨loadUrl()æ–¹æ³•å³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebView myWebView = (WebView) findViewById(R.id.webview);</span><br><span class="line">myWebView.loadUrl(&quot;http://www.example.com&quot;);</span><br></pre></td></tr></table></figure></p><p>è¯·æ±‚æœåŠ¡å™¨ç½‘é¡µæ—¶ï¼Œåˆ«å¿˜äº†è¦åŠ ç½‘ç»œè¯·æ±‚æƒé™ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;manifest ... &gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šå°±æ˜¯æœ€ç®€å•çš„åŠ è½½ç½‘é¡µæ–¹å¼ã€‚</p><h1 id="åœ¨WebViewä¸­ä½¿ç”¨JavaScript"><a href="#åœ¨WebViewä¸­ä½¿ç”¨JavaScript" class="headerlink" title="åœ¨WebViewä¸­ä½¿ç”¨JavaScript"></a>åœ¨WebViewä¸­ä½¿ç”¨JavaScript</h1><p>å¦‚æœä½ åœ¨APPå±•ç¤ºçš„ç½‘é¡µä¸­åŒ…å«JSï¼Œé‚£ä¹ˆè¯·ç¡®ä¿WebViewæ”¯æŒJSçš„åŠ è½½ã€‚åœ¨æ­¤ä¹‹åï¼Œä½ è¿˜å¯ä»¥æ–°å»ºæ¥å£è®©WebViewä¸Androidä»£ç äº¤äº’ã€‚</p><h2 id="æˆæƒä½¿ç”¨JavaScript"><a href="#æˆæƒä½¿ç”¨JavaScript" class="headerlink" title="æˆæƒä½¿ç”¨JavaScript"></a>æˆæƒä½¿ç”¨JavaScript</h2><p>WebViewé»˜è®¤ä¸æ”¯æŒJSçš„åŠ è½½ï¼Œå¼€å¯å®ƒéœ€è¦è°ƒç”¨WebSettingçš„setJavaScriptEnable()æ–¹æ³•ã€‚WebSettingå¯ä»¥é€šè¿‡WebViewçš„getSettings()æ–¹æ³•è·å¾—ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WebView myWebView = (WebView) findViewById(R.id.webview);</span><br><span class="line">WebSettings webSettings = myWebView.getSettings();</span><br><span class="line">webSettings.setJavaScriptEnabled(true);</span><br></pre></td></tr></table></figure></p><p>WebSettingæä¾›äº†è®¸å¤šä½¿ç”¨æ€§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ä½ æƒ³è®©ä½ å¹¸å¹¸è‹¦è‹¦å¼€å‘çš„web pageåªèƒ½åœ¨è‡ªå·±çš„androidåº”ç”¨ä¸­å±•ç¤ºï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å®¢æˆ·ç«¯é€šè¿‡setUserAgentString()è®¾ç½®ç”¨æˆ·ä»£ç†ä¹‹åï¼Œåœ¨æœåŠ¡ç«¯éå†userAgentStringå­—æ®µæ˜¯å¦æ˜¯è‡ªå·±çš„å®¢æˆ·ç«¯æ‰€è®¾å®šçš„ã€‚</p><h2 id="åœ¨Androidä»£ç ä¸­ç»‘å®šJavaScriptä»£ç "><a href="#åœ¨Androidä»£ç ä¸­ç»‘å®šJavaScriptä»£ç " class="headerlink" title="åœ¨Androidä»£ç ä¸­ç»‘å®šJavaScriptä»£ç "></a>åœ¨Androidä»£ç ä¸­ç»‘å®šJavaScriptä»£ç </h2><p>é€šè¿‡æ¥å£çš„æ–¹å¼ï¼Œä½ å¯ä»¥ä½¿ä½ çš„Androidä»£ç å’ŒJavaScriptä»£ç è¿›è¡Œäº¤äº’ã€‚ä¾‹å¦‚ï¼Œä½ çš„JavaScriptä»£ç å¯ä»¥è°ƒç”¨Androidä»£ç å¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œè€Œä¸æ˜¯ä½¿ç”¨JavaScriptçš„Alertï¼ˆï¼‰æ–¹æ³•ã€‚<br>è®©JavaScriptå’ŒAndroidä»£ç äº§ç”Ÿè”ç³»çš„å…³é”®æ˜¯addJavaScriptInterface()æ–¹æ³•ï¼Œæ­¤æ–¹æ³•åŒ…å«ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä¸€ä¸ªç±»å¯¹è±¡ï¼Œä¾›JavaScriptè°ƒç”¨ã€‚ç¬¬äºŒä¸ªæ˜¯æ¥å£åç§°ï¼Œå®ƒç”¨åœ¨JavaScriptä¸­ä½œä¸ºè°ƒç”¨Androidæ–¹æ³•çš„åˆ«åã€‚<br>ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class WebAppInterface &#123;</span><br><span class="line">Context mContext;</span><br><span class="line"></span><br><span class="line">/** Instantiate the interface and set the context */</span><br><span class="line">WebAppInterface(Context c) &#123;</span><br><span class="line">mContext = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/** Show a toast from the web page */</span><br><span class="line">@JavascriptInterface</span><br><span class="line">public void showToast(String toast) &#123;</span><br><span class="line">Toast.makeText(mContext, toast, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><blockquote><p><strong>ç‰¹åˆ«æé†’ï¼š</strong>å¦‚æœä½ çš„Androidç›®æ ‡SDKç‰ˆæœ¬åœ¨17æˆ–ä»¥ä¸Šï¼Œä½ å¿…é¡»åœ¨é‚£äº›å°†è¦åœ¨JavaScriptä¸­è°ƒç”¨çš„æ–¹æ³•ä½“å‰ä½¿ç”¨@JavascriptInterfaceæ ‡è¯†ã€‚å¦åˆ™ï¼Œè¿™äº›æ–¹æ³•å°†ä¸ä¼šè¢«è°ƒç”¨ã€‚</p></blockquote><p>åœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼ŒWebAppInterfaceå…è®¸JavaScriptè¿è¡ŒshowToastæ–¹æ³•å¼¹å‡ºä¸€ä¸ªToastã€‚<br>ä½ å¯ä»¥è¿è¡Œè¿™æ®µä»£ç é€šè¿‡WebViewçš„addJavaScriptInterface()æ–¹æ³•ï¼Œå¹¶æŒ‡å®šæ¥å£çš„åç§°ä¸ºâ€œAndroidâ€ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebView webView = (WebView) findViewById(R.id.webview);</span><br><span class="line">webView.addJavascriptInterface(new WebAppInterface(this), &quot;Android&quot;);</span><br></pre></td></tr></table></figure></p><p>è¿™æ®µä»£ç ä¸ºè¿è¡Œåœ¨WebViewä¸­çš„JavaScriptåˆ›å»ºäº†ä¸€ä¸ªæ¥å£â€œAndroidâ€ï¼Œé‚£ä¹ˆç°åœ¨ä½ çš„JavaScriptå·²ç»æœ‰èƒ½åŠ›è®¿é—®WebAppInterfaceä¸­çš„showToastæ–¹æ³•äº†ã€‚ä¸‹é¢çš„HTMLå’ŒJSä»£ç å°†è°ƒç”¨showToastæ–¹æ³•å¼¹å‡ºToastæç¤ºã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;button&quot; value=&quot;Say hello&quot; onClick=&quot;showAndroidToast(&apos;Hello Android!&apos;)&quot; /&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">function showAndroidToast(toast) &#123;</span><br><span class="line">Android.showToast(toast);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><p>å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œåœ¨JSä¸­ä½¿ç”¨â€œAndroidâ€è¿™ä¸ªæ¥å£æ—¶ï¼Œå¹¶ä¸éœ€è¦åˆå§‹åŒ–å®ƒï¼Œåœ¨æ­¤ä¹‹å‰ï¼ŒWebViewå·²ç»ä¸ºä½ å‡†å¤‡å¥½äº†ä¸€äº›ï¼Œä½ åªéœ€è¦é€šè¿‡å®ƒè°ƒç”¨é€»è¾‘å³å¯ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>1.WebAppInterfaceçš„å®ä¾‹å°†è¿è¡Œåœ¨å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸åœ¨åŸæ¥æ–°å»ºå®ƒçš„çº¿ç¨‹ã€‚<br>2.ç”±äºé€šè¿‡JSå¯ä»¥è°ƒç”¨æœ¬åœ°çš„Androidä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹äºè¿™ç‚¹è¦éå¸¸çš„è°¨æ…ã€‚å¯¹äºä¸å—ä¿¡ä»»çš„webé“¾æ¥ï¼Œä¸åº”è¯¥ä½¿ç”¨addJavascriptInterface()ï¼Œé™¤éè¿™ä¸ªé“¾æ¥æ˜¯è‡ªå·±æœ¬äººå†™çš„æˆ–è€…å…¶å®ƒåº”è¯¥å……åˆ†ä¿¡ä»»å®ƒçš„ç†ç”±ã€‚åŒæ—¶ï¼Œå¯¹äºä¸ä¿¡ä»»çš„ç½‘ç«™ï¼Œæˆ‘ä»¬åœ¨å¤„ç†å®ƒçš„è·³è½¬æ—¶åº”è¯¥éå¸¸å°å¿ƒï¼Œä¸åº”è¯¥åœ¨æˆ‘ä»¬çš„WebViewä¸­ç›´æ¥æ¥å—é“¾æ¥çš„è·³è½¬ã€‚ï¼ˆé»˜è®¤æƒ…å†µï¼ŒWebViewç½‘é¡µä¸­çš„é“¾æ¥ä¼šè·³è½¬åˆ°æ‰‹æœºçš„Webæµè§ˆå™¨ï¼Œè¿™æ˜¯ä¿è¯å®‰å…¨çš„å‰æä¸‹ä¸€ç§å¾ˆå¥½çš„å¤„ç†æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œåœ¨æ¥ä¸‹æ¥ä¼šæåˆ°çš„serWebViewClient()æ–¹æ³•ä¸­ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰é“¾æ¥çš„è¡Œä¸ºï¼Œè¿™å°±éœ€è¦å°å¿ƒäº†ã€‚ï¼‰</p></blockquote><h1 id="é¡µé¢å¯¼èˆª"><a href="#é¡µé¢å¯¼èˆª" class="headerlink" title="é¡µé¢å¯¼èˆª"></a>é¡µé¢å¯¼èˆª</h1><p>å½“ç”¨æˆ·åœ¨WebViewç‚¹å‡»ä¸€ä¸ªé“¾æ¥åï¼Œé»˜è®¤çš„è¡Œä¸ºæ˜¯åœ¨webæµè§ˆå™¨ä¸­æ‰“å¼€è¯¥é“¾æ¥æ‰€æŒ‡å‘çš„ç½‘é¡µã€‚æ­£å¦‚ä¸Šé¢æ‰€æåŠçš„ä¸€æ ·ï¼Œä½ æ˜¯å¯ä»¥é€šè¿‡WebViewçš„serWebViewClientæ–¹æ³•è‡ªå®šä¹‰è¿™ä¸ªè¡Œä¸ºçš„ã€‚ä¾‹å¦‚åœ¨è‡ªå·±çš„WebViewä¸­å±•ç¤ºè·³è½¬çš„å†…å®¹ï¼Œè€Œä¸æ˜¯è·³è½¬åˆ°webæµè§ˆå™¨ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebView myWebView = (WebView) findViewById(R.id.webview);</span><br><span class="line">myWebView.setWebClient(new WebClient());</span><br></pre></td></tr></table></figure></p><p>å½“ç„¶ä½ è¿˜å¯ä»¥åšæ›´å¤šï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">private class MyWebViewClient extends WebViewClient &#123;</span><br><span class="line">@Override</span><br><span class="line">public boolean shouldOverrideUrlLoading(WebView view,String url)&#123;</span><br><span class="line">if (Uri.parse(url).getHost().equals(&quot;www.example.com&quot;)) &#123;</span><br><span class="line">// This is my web site, so do not override; let my WebView load the page</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">// Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs</span><br><span class="line">Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));</span><br><span class="line">startActivity(intent);</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶ååˆ›å»ºMyWebViewClientçš„å®ä¾‹ä½œä¸ºsetWebClient()çš„å‚æ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WebView myWebView = (WebView) findViewById(R.id.webview);</span><br><span class="line">myWebView.setWebClient(new MyWebViewClient());</span><br></pre></td></tr></table></figure></p><h2 id="å¯¼èˆªwebçš„æµè§ˆè®°å½•"><a href="#å¯¼èˆªwebçš„æµè§ˆè®°å½•" class="headerlink" title="å¯¼èˆªwebçš„æµè§ˆè®°å½•"></a>å¯¼èˆªwebçš„æµè§ˆè®°å½•</h2><p>åœ¨WebViewä¸­æµè§ˆç½‘é¡µæ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé€šè¿‡webä¸­åŒ…å«çš„å¤–é“¾è·³è½¬åˆ°å…¶å®ƒçš„ç½‘é¡µï¼ˆåœ¨åŒä¸€Webviewé¡µé¢ä¸­ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›è·³è½¬è®°å½•æ˜¯å¯ä»¥æ¥å›åˆ‡æ¢çš„ï¼Œè¿™é‡Œä¸»è¦æ¶‰åŠåˆ°goBack()å’ŒgoForward()æ–¹æ³•çš„ä½¿ç”¨ã€‚<br>ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾å¤‡çš„è¿”å›æŒ‰é’®è®©WebViewå›é€€åˆ°ä¸Šä¸€ä¸ªé¡µé¢ï¼Œæˆ–è€…é€€å‡ºå½“å‰Activityã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean onKeyDown(int keyCode, KeyEvent event) &#123;</span><br><span class="line">Â  Â  // Check if the key event was the Back button and if there&apos;s history</span><br><span class="line">Â  Â  if ((keyCode == KeyEvent.KEYCODE_BACK) &amp;&amp; myWebView.canGoBack()) &#123;</span><br><span class="line">Â  Â  Â  Â  myWebView.goBack());</span><br><span class="line">Â  Â  Â  Â  return true;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  // If it wasn&apos;t the Back key or there&apos;s no web page history, bubble up to the default</span><br><span class="line">Â  Â  // system behavior (probably exit the activity)</span><br><span class="line">Â  Â  return super.onKeyDown(keyCode, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><p><strong>å‚è€ƒèµ„æ–™</strong><br><a href="https://developer.android.com/guide/webapps/webview.html#HandlingNavigation" target="_blank" rel="noopener">Building Web Apps in WebView</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¦‚æœä½ æƒ³åœ¨å°†webé¡µé¢ä½œä¸ºAPPçš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨WebViewã€‚WebViewåœ¨Androidä¸­ç»§æ‰¿äº†viewç±»ï¼Œä½œä¸ºæ‰¿è½½ç½‘é¡µçš„æ§ä»¶ã€‚ä½†æ˜¯æˆ‘ä»¬åº”è¯¥çŸ¥é“å®ƒå¹¶æ²¡æœ‰ç»§æ‰¿webæµè§ˆå™¨çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå®ƒæ‰€å®ç°çš„ä¹Ÿåªæ˜¯å±•ç¤ºç½‘é¡µï¼Œä»¥åŠä¸€äº›åŸºæœ¬çš„äº¤äº’å’Œç›‘å¬åŠŸèƒ½ã€‚
    
    </summary>
    
      <category term="Android View" scheme="http://yoursite.com/categories/Android-View/"/>
    
    
      <category term="WebView" scheme="http://yoursite.com/tags/WebView/"/>
    
  </entry>
  
</feed>
